<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æ•™ä½ ç”¨neo4jåšlookalikeï¼ˆä¸‹ï¼‰]]></title>
    <url>%2Fposts%2Fneo4j-lookalike-part2%2F</url>
    <content type="text"><![CDATA[åœ¨ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»åšå¥½äº†åŸºæœ¬çš„æ•°æ®é¢„å¤„ç†ï¼Œå¹¶ç”Ÿæˆäº†ä¾›Neo4Jå¯¼å…¥çš„csvæ ¼å¼æ•°æ®ã€‚åœ¨è¿™èŠ‚ä¸­ï¼Œè®©æˆ‘ä»¬æŠŠæ•°æ®å¯¼å…¥Neo4Jï¼Œå¼€å§‹æˆ‘ä»¬çš„å›¾æ•°æ®åº“ä¹‹æ—…ã€‚ Neo4Jæ•°æ®å¯¼å…¥è¿™é‡Œå‡è®¾å¤§å®¶å¯¹neo4jå·²ç»æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚ä¸æ¸…æ¥šçš„åŒå­¦å¯ä»¥å‚è€ƒä¸‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç« æ‰‹æŠŠæ‰‹æ•™ä½ å¿«é€Ÿå…¥é—¨çŸ¥è¯†å›¾è°± - Neo4Jæ•™ç¨‹ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œneo4jçš„æ•°æ®å¯¼å…¥æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š CYPHER CREATEã€‚è¿™ç§æ–¹å¼å¯ä»¥å®žæ—¶æ’å…¥ï¼Œä½†æ˜¯é€Ÿåº¦å’Œåžåé‡éƒ½å¾ˆæ…¢ï¼Œåªé€‚åˆå®žéªŒåœºæ™¯ã€‚ Javaæˆ–Python APIã€‚è¿™ç§æ–¹å¼é€‚åˆå°æ•°æ®é‡çš„å®žæ—¶æ’å…¥ï¼Œå®žçŽ°ä¸€å®šç¨‹åº¦ä¸Šçš„å¢žåˆ æ”¹æŸ¥ã€‚ CYPHER LOAD CSVã€‚è¿™ç§æ–¹å¼é€Ÿåº¦å°±å¥½å¾ˆå¤šï¼Œé€‚åˆä¸­ç­‰æ•°æ®é‡çš„æ‰¹é‡æ’å…¥ã€‚ Neo4j-importã€‚è¿™ç§æ–¹å¼é€Ÿåº¦æ˜¯æœ€å¿«çš„ï¼Œä½†ç¼ºç‚¹æ˜¯æ’å…¥çš„æ—¶å€™å¿…é¡»åœæ­¢Neo4jï¼Œä¸”åªèƒ½ç”Ÿæˆæ–°çš„æ•°æ®åº“ï¼Œå› æ­¤åªé€‚åˆå¤§æ•°æ®é‡çš„åˆå§‹åŒ–ã€‚ æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨çš„æ˜¯CYPHER LOAD CSVçš„æ–¹å¼ã€‚åœ¨ä¸Šä¸€ç« èŠ‚ä¸­ï¼Œå·²ç»ç”Ÿæˆå¥½äº†ç›¸åº”çš„CSVï¼Œä¸‹é¢å°±æ˜¯è°ƒç”¨CYPHERè¯­å¥å°†æ•°æ®å¯¼å…¥ã€‚è¿™é‡Œæœ‰2ä¸ªå°trickï¼š æˆ‘ä»¬æ˜¯å…ˆå¯¼å…¥èŠ‚ç‚¹nodeï¼Œç„¶åŽå†å¯¼å…¥å…³ç³»relationshipã€‚å¯¼å…¥å…³ç³»çš„é€»è¾‘ï¼Œæ˜¯å…ˆæŸ¥æ‰¾å‡ºç›¸åº”çš„èŠ‚ç‚¹ï¼Œå†å»ºç«‹å…³ç³»ï¼Œå› æ­¤ä¸ºäº†æŸ¥è¯¢é€Ÿåº¦çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¦ç»™èŠ‚ç‚¹çš„æŸ¥æ‰¾å­—æ®µæ·»åŠ ç´¢å¼•ï¼Œå¦‚ï¼š12CREATE INDEX ON :Person(cust_num)CREATE INDEX ON :Phone(phone_num) å¦å¤–ï¼Œç´¢å¼•å»ºç«‹å¥½åŽï¼Œè®°å¾—è¿è¡Œ:schemaç¡®ä¿ç´¢å¼•å·²ç”Ÿæ•ˆã€‚ å¦‚æžœæ­å»ºneo4jçš„æœåŠ¡å™¨æ€§èƒ½æœ‰é™ï¼Œè¦é¿å…jvmè™šæ‹Ÿæœºåœ¨æ‰¹é‡æ’å…¥æ—¶å†…å­˜ä¸è¶³ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œæ‰¹é‡çš„äº‹åŠ¡æäº¤1USING PERIODIC COMMIT 1000 èŠ‚ç‚¹å¯¼å…¥æŽ¥ä¸‹æ¥å°±æ˜¯LOADå®¢æˆ·èŠ‚ç‚¹äº†ï¼Œæ³¨æ„è¿™é‡Œæœ‰ä¸ªæ“ä½œï¼Œæ˜¯å°†CSVä¸­æ ¼å¼ä¸ºSTRINGçš„embedding listè½¬åŒ–ä¸ºFLOAT listã€‚ 1234LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/nodes.csv&quot;AS lineWITH line, split(substring(line.embedding, 1, length(line.embedding)-2), &quot;,&quot;) as emsCREATE (:Person &#123;cust_num:line.cust_num, cust_name:line.cust_name, longitude:TOFLOAT(line.longitude), latitude:TOFLOAT(line.latitude), embedding:[item in ems | TOFLOAT(item)]&#125;) å¯¼å…¥æˆåŠŸåŽï¼Œåœ¨neo4jé‡Œé¢æŸ¥çœ‹ä¸€ä¸‹ï¼ŒPersonèŠ‚ç‚¹ä¿¡æ¯å¦‚ä¸‹ï¼š ç„¶åŽæ˜¯æ‰‹æœºå·èŠ‚ç‚¹åŠåŸŽå¸‚èŠ‚ç‚¹ï¼š 123456789LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/phone_nodes.csv&quot;AS lineWITH lineCREATE (:Phone &#123;phone_num:line.phone_num&#125;)LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/city_nodes.csv&quot;AS lineWITH lineCREATE (:City &#123;city_cd:line.city&#125;) å…³ç³»å¯¼å…¥é¦–å…ˆæ˜¯ç”¨æˆ·æ‹¥æœ‰æ‰‹æœºå·çš„å…³ç³»ï¼š 123456LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/has_phone_relations.csv&quot;AS lineWITH lineMATCH (f:Person &#123;cust_num: line.cust_num&#125;), (t:Phone &#123;phone_num: line.phone_num&#125;)MERGE (f)-[r:HAS_PHONE]-&gt;(t)RETURN count(r) å…³ç³»å»ºç«‹å¥½åŽå¦‚å›¾ï¼š ç„¶åŽä»¥æ­¤ç±»æŽ¨ï¼Œåˆ†åˆ«æ˜¯ç”¨æˆ·è”ç³»äººçš„å…³ç³»å’Œç”¨æˆ·æ‰€åœ¨åŸŽå¸‚çš„å…³ç³»ï¼š 12345678910111213LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/has_contact_relations.csv&quot;AS lineWITH lineMATCH (f:Person &#123;cust_num: line.cust_num&#125;), (t:Phone &#123;phone_num: line.phone_num&#125;)MERGE (f)-[r:HAS_CONTACT]-&gt;(t)RETURN count(r)LOAD CSV WITH HEADERS FROM &quot;file:///var/lib/neo4j/import/in_city_relations.csv&quot;AS lineWITH lineMATCH (f:Person &#123;cust_num: line.cust_num&#125;), (t:City &#123;city_cd: line.city&#125;)MERGE (f)-[r:IN_CITY]-&gt;(t)RETURN count(r) lookalikeå®žçŽ°å›¾è°±å»ºç«‹å¥½ä»¥åŽï¼Œå°±å¯ä»¥å¼€å§‹åº”ç”¨äº†ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨Neo4Jä¸­æ˜¯å¦‚ä½•ä¼˜é›…çš„å®žçŽ°çš„ã€‚ è”ç³»äººæ‰©æ•£è”ç³»äººæ‰©æ•£çš„é€»è¾‘ï¼Œå°±æ˜¯æ ¹æ®ç§å­ç”¨æˆ·ï¼Œæ‰¾åˆ°è¿™äº›ç”¨æˆ·çš„è”ç³»äººï¼ˆçˆ¶æ¯ã€é…å¶ã€æœ‹å‹ç­‰ï¼‰ã€‚åœ¨å›¾æ•°æ®åº“é‡Œï¼Œå¯ä»¥éžå¸¸è‡ªç„¶çš„ç”¨ä»¥ä¸‹è¯­å¥å®žçŽ°ï¼š 123MATCH (n:Person &#123;cust_num: &quot;3814&quot;&#125;)-[r:HAS_CONTACT]-&gt;(p:Phone)&lt;-[q:HAS_PHONE]-(m:Person)WHERE n&lt;&gt;mRETURN n, r, p, q, m æŸ¥è¯¢ç»“æžœå¦‚ä¸‹ï¼š æŸ¥è¯¢ç»“æžœéžå¸¸å¿«ï¼Œå“åº”é€Ÿåº¦æ˜¯æ¯«ç§’çº§ï¼Œè€Œä¸”è¿™ä¸ªé€Ÿåº¦è·Ÿæ•°æ®é‡çº§åŸºæœ¬å…³ç³»ä¸å¤§ã€‚è¿™å°±æ˜¯å›¾æ•°æ®åº“ç›¸æ¯”ä¼ ç»Ÿçš„RDMSå…³ç³»åž‹æ•°æ®åº“çš„ä¼˜åŠ¿ã€‚æ³¨æ„è¿™é‡Œæ˜¯2çº§å…³ç³»çš„æŸ¥è¯¢ï¼Œå…³ç³»çº§æ•°è¶Šå¤§ï¼Œä¼˜åŠ¿è¶Šæ˜Žæ˜¾ã€‚è¿™æ˜¯å› ä¸ºRDMSä¸­å¯¹äºŽè¿™ç§å…³ç³»çš„æŸ¥æ‰¾ï¼Œéœ€è¦å…¨é‡æ•°æ®çš„joinï¼Œè¿™æ˜¯éžå¸¸æ¶ˆè€—è®¡ç®—èµ„æºçš„ã€‚è€Œåœ¨å›¾æ•°æ®åº“ä¸­ï¼Œå…³ç³»ä½œä¸ºâ€œç¬¬ä¸€å…¬æ°‘â€ï¼Œåªä¼šåœ¨éœ€è¦æŸ¥è¯¢çš„èŠ‚ç‚¹ä¸Šåšè®¡ç®—ï¼Œä¸æ¶‰åŠjoinï¼Œå› æ­¤é€Ÿåº¦éžå¸¸å¿«ï¼Œä¸”åŸºæœ¬è·Ÿæ•°æ®é‡æ— å…³ã€‚ åœ°ç†ä½ç½®æ‰©æ•£åœ°ç†ä½ç½®æ‰©æ•£ï¼Œéš¾åº¦ä¼šç¨å¤§ä¸€äº›äº†ã€‚ä¸šåŠ¡é€»è¾‘æ˜¯æ‰¾åˆ°è·Ÿç§å­ç”¨æˆ·åœ°ç†ä½ç½®ç›¸è¿‘çš„ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¹æ®GPSç»çº¬åº¦ï¼Œæ‰¾åˆ°æŸç”¨æˆ·ç‰©ç†è·ç¦»æœ€è¿‘çš„ä¸€ç¾¤ç”¨æˆ·ã€‚è¿™å°±æ¶‰åŠäº†æ‰€æœ‰æ•°æ®è®¡ç®—ä¸­çš„â€œå™©æ¢¦â€â€“ç¬›å¡å°”ç§¯ã€‚ é€šè¿‡å›¾æ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¢„å…ˆå‡å°‘ç¬›å¡å°”ç§¯çš„è¿ç®—é‡ã€‚è¿˜è®°å¾—æˆ‘ä»¬æœ‰ä¸ªâ€œIN_CITYâ€çš„å…³ç³»ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥é¢„å…ˆæŸ¥è¯¢å‡ºç”¨æˆ·æ‰€åœ¨åŸŽå¸‚çš„å…¶ä»–ç”¨æˆ·ï¼Œåªåœ¨è¿™äº›ç”¨æˆ·ä¹‹é—´æ¯”è¾ƒè·ç¦»å³å¯ã€‚å¦‚æžœæ•°æ®åšå¾—ç»†ï¼Œå¯ä»¥å¢žåŠ åŸŽåŒºã€è¡—é“ã€ç”šè‡³å°åŒºï¼Œè¿™æ ·è®¡ç®—é‡å°±æ›´å°äº†ã€‚ å¦å¤–ï¼Œæ ¹æ®ä¸¤ç‚¹çš„ç»çº¬åº¦ç®—ç‰©ç†è·ç¦»ï¼Œneo4jä¸­ä¹Ÿæä¾›ç›´æŽ¥çš„å‡½æ•°ï¼Œä¸ç”¨è‡ªå·±æ¥å†™äº†ã€‚ 123456match (n1:Person &#123;cust_num:&quot;200&quot;&#125;)-[r:IN_CITY]-&gt;(p:City)&lt;-[q:IN_CITY]-(n2:Person)where n1&lt;&gt;n2with n1, n2, point(&#123;longitude:n1.longitude, latitude:n1.latitude&#125;) as p1,point(&#123;longitude:n2.longitude, latitude:n2.latitude&#125;) as p2return n1.cust_num, distance(p1,p2)/1000 as dist, n2.cust_numorder by dist asc åŒæ ·æŸ¥è¯¢é€Ÿåº¦éžå¸¸å¿«ï¼Œå¹¶ä¸”è¿”å›žäº†å®¢æˆ·å·ä¸º200çš„ç”¨æˆ·ï¼Œè·Ÿä»–è·ç¦»æœ€è¿‘çš„ç”¨æˆ·å·åŠå…¬é‡Œæ•°ã€‚ ç”¨æˆ·è¡Œä¸ºæ‰©æ•£è¿™ç§æ‰©æ•£æ–¹å¼æ›´åŠ çš„â€œAIâ€ã€‚ä¹Ÿæ˜¯å„ä¸ªå¤§åŽ‚çš„lookalikeç®—æ³•ä½“çŽ°åŠŸåŠ›çš„åœ°æ–¹ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯ç”¨æˆ·embeddingå¦‚ä½•ç”Ÿæˆï¼ŒäºŒæ˜¯å¦‚ä½•æŸ¥è¯¢ã€‚ å¯¹äºŽç”¨æˆ·embeddingçš„ç”Ÿæˆï¼Œæˆ‘ä»¬åœ¨ä¸Šæ–‡ä¸­é‡‡ç”¨çš„ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ çš„æ–¹å¼ï¼Œä½¿ç”¨å·²ç»åšå¥½çš„ç”¨æˆ·æ ‡ç­¾åº“æ¥å¤„ç†ã€‚åœ¨è¿™é‡Œneo4jçš„å¸®åŠ©ä¸å¤§ï¼Œæˆ‘ä»¬ä¸å†å¤šè¯´ã€‚ åœ¨ç”Ÿæˆå¥½çš„ç”¨æˆ·embeddingä¸ŠæŸ¥è¯¢ç›¸è¿‘ä¼¼çš„ç”¨æˆ·ï¼Œè¿™æ˜¯å…¸åž‹çš„nearest neighboråœºæ™¯ï¼ŒåŒæ ·å­˜åœ¨ç€ç¬›å¡å°”ç§¯çš„å™©æ¢¦ã€‚ç”±äºŽè®¡ç®—é‡éžå¸¸çš„å¤§ï¼Œæˆ‘ä»¬ä¸æŽ¨èåœ¨æ¯æ¬¡æŸ¥è¯¢æ—¶å®žæ—¶è®¡ç®—ï¼Œè€Œæ˜¯é¢„å…ˆåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒæŠŠæ¯ä¸ªç”¨æˆ·è·ç¦»æœ€è¿‘çš„TOP20è®¡ç®—å¥½ï¼ŒåŠ¨æ€ç”Ÿæˆå›ºå®šå…³ç³»ï¼Œç„¶åŽåœ¨æœåŠ¡çš„æ—¶å€™ï¼Œåªåšä¸€æ¬¡æŸ¥è¯¢æ“ä½œå³å¯ã€‚ æ³¨æ„è¿™é‡Œä½¿ç”¨åˆ°äº†neo4jçš„å›¾ç®—æ³•åº“algoï¼Œä¸‹è½½å¥½ç›¸åº”çš„jaråŒ…å¦‚neo4j-graph-algorithms-3.5.13.0-standalone.jaræ”¾åˆ°neo4jå®‰è£…ç›®å½•ä¸­çš„pluginsæ–‡ä»¶å¤¹ï¼Œç„¶åŽåœ¨confæ–‡ä»¶ä¸­å†™å…¥ï¼š 1dbms.security.procedures.unrestricted=algo.* æŽ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥ç”¨å¦‚ä¸‹CYPHERè¯­å¥æ¥ç”Ÿæˆå…³ç³»äº†ï¼š 12345678910match (p:Person)with &#123;item:id(p), weights:p.embedding&#125; as userDatawith collect(userData) as dataCALL algo.similarity.euclidean(data, &#123; topK:20, write:true, showComputations: true, writeRelationshipType: &quot;SIMILAR20&quot;&#125;)YIELD nodes, similarityPairs, computationsRETURN nodes, apoc.number.format(similarityPairs) as similarityPairs,apoc.number.format(computations) as computations è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†æ¬§æ°è·ç¦»ï¼Œå¹¶ä¸”ä¸ºäº†æ¼”ç¤ºè®¡ç®—çš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬æŠŠè®¡ç®—é‡computationsä¹Ÿæ‰“å°å‡ºæ¥ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„å¤§è‡´æœ‰9550ä¸ªç”¨æˆ·ï¼Œneo4jå®‰è£…åœ¨ç¬”è®°æœ¬ç”µè„‘çš„dockerä¸­ï¼Œè¿™æ¡CYPHERè¯­å¥è¿è¡Œäº†33ç§’ï¼Œç”Ÿæˆäº†19ä¸‡æ¡å…³ç³»ï¼Œè®¡ç®—é‡æ˜¯æƒŠäººçš„4500ä¸‡ï¼ åˆå§‹åŒ–å®Œæˆä»¥åŽï¼Œå°±å¯ä»¥å¼€å§‹æŸ¥è¯¢äº†ï¼š 12match (from:Person &#123;cust_num:&quot;200&quot;&#125;)-[r:SIMILAR20]-&gt;(to:Person)return distinct from, r, to ä»Žç»“æžœå¯ä»¥çœ‹åˆ°ï¼Œè¿…é€Ÿè¿”å›žäº†å®¢æˆ·å·ä¸ºâ€œ200â€çš„â€œå®¢æˆ·ä½™â€è·Ÿä»–æœ€ç›¸ä¼¼çš„å®¢æˆ·èŠ‚ç‚¹ï¼Œä»¥åŠè¿™äº›å®¢æˆ·ä¹‹é—´çš„ç›¸ä¼¼åº¦åˆ†æ•°ã€‚ æ‰¹é‡æ‰©æ•£ä¸Šé¢å‡ ç§æ¼”ç¤ºï¼ŒåŸºæœ¬æ¶µç›–äº†å¸¸è§çš„æ‰©æ•£æ–¹å¼ã€‚å®žé™…æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ ¹æ®åœºæ™¯ã€éœ€æ±‚ï¼Œè®¾è®¡å¥½å›¾æ¨¡åž‹ï¼Œå°±èƒ½ä½¿ç”¨neo4jè½»æ¾å®žçŽ°lookalikeã€‚ä¸è¿‡ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ï¼Œä¸Šé¢ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œéƒ½åªæŸ¥è¯¢äº†ä¸€ä¸ªç§å­ç”¨æˆ·çš„æƒ…å†µï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯ä¸€æ‰¹ç§å­ï¼Œå¦‚ä½•å®žçŽ°å‘¢ï¼Ÿå…¶å®žï¼Œç”¨neo4jçš„unwindè¯­å¥å°±å¯ä»¥äº†ã€‚æ¯”å¦‚æˆ‘ä»¬è¦æ‰¹é‡æŸ¥è¯¢5ä¸ªç”¨æˆ·çš„è”ç³»äººæ‰©æ•£ï¼š 1234UNWIND [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;] as xMATCH (n:Person &#123;cust_num: x&#125;)-[r:HAS_CONTACT]-&gt;(p:Phone)&lt;-[q:HAS_PHONE]-(m:Person)WHERE n&lt;&gt;mRETURN m.cust_num unwindè¯­å¥å¯ä»¥ç†è§£ä¸ºç¼–ç¨‹è¯­è¨€ä¸­çš„å¾ªçŽ¯ï¼ŒæŠŠä¸€ä¸ªåˆ—è¡¨ä¸­çš„å€¼ä¾æ¬¡ä»£å…¥åˆ°åŽç»­çš„è¯­å¥ä¸­æ‰§è¡Œï¼Œå°±å¯ä»¥é«˜æ•ˆåœ°å¾—åˆ°æ‰¹é‡çš„ç»“æžœã€‚ æ€»ç»“æœ¬æ–‡ä»¥ä¸€ä¸ªå®žé™…çš„æ¡ˆä¾‹ï¼Œåˆ†åˆ«ä»Žè”ç³»äººæ‰©æ•£ã€åœ°ç†ä½ç½®æ‰©æ•£ã€ç”¨æˆ·è¡Œä¸ºæ‰©æ•£ä¸‰æ–¹é¢æ¼”ç¤ºäº†ä½¿ç”¨neo4jå›¾æ•°æ®åº“åŽ»åšlookalikeç”¨æˆ·æ‰©æ•£çš„æ–¹æ³•ã€‚å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯demoï¼Œåœ¨å®žé™…çš„ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œè¿˜éœ€è¦è€ƒè™‘å¾ˆå¤šå·¥ç¨‹åŒ–çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š ç”¨æˆ·æ•°æ®çš„æ›´æ–°å¦‚ä½•å¯¼å…¥ï¼Œæ˜¯T+1å…¨é‡ï¼Œè¿˜æ˜¯å®žæ—¶å¢žé‡ï¼Ÿå¦‚æžœæ¯æ—¥T+1ï¼Œå¦‚æžœè§£å†³neo4jæ‰¹é‡æ•°æ®åˆ é™¤ä¸Žé‡å»ºï¼Ÿ å½“ç”¨æˆ·æ•°æ®é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼Œåœ¨åœ°ç†ä½ç½®æ‰©æ•£ä¸­ï¼Œå³ä½¿é¢„å…ˆé€‰å®šäº†åŸŽå¸‚ï¼Œæ•°æ®é‡ä¹Ÿéžå¸¸å¤§ï¼Œå¦‚ä½•æå‡æŸ¥è¯¢æ•ˆçŽ‡ï¼Ÿ åŒæ ·å½“ç”¨æˆ·é‡å¾ˆå¤§æ—¶ï¼Œé¢„å…ˆè®¡ç®—ç”¨æˆ·è¡Œä¸ºå‘é‡ç›¸ä¼¼åº¦çš„ç¬›å¡å°”ç§¯ä¹Ÿéžå¸¸çš„å¤§ï¼Œè®¡ç®—é‡å‘ˆå‡ ä½•çº§æ•°å¢žé•¿ï¼Œéžå¸¸å®¹æ˜“å†…å­˜OOMå¯¼è‡´è®¡ç®—å¤±è´¥ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ è¿™äº›å…·ä½“é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨åŽç»­çš„æ–‡ç« ä¸­å†æ¥æŽ¢è®¨ã€‚]]></content>
      <categories>
        <category>Knowledge Graph</category>
      </categories>
      <tags>
        <tag>Neo4J</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•™ä½ ç”¨neo4jåšlookalikeï¼ˆä¸Šï¼‰]]></title>
    <url>%2Fposts%2Fneo4j-lookalike-part1%2F</url>
    <content type="text"><![CDATA[èµ·æºç²¾å‡†è¥é”€ä¸€ç›´æ˜¯å¤§æ•°æ®æŠ€æœ¯å•†ä¸šè½åœ°çš„é‡è¦åœºæ™¯ä¹‹ä¸€ã€‚é€šè¿‡å¯¹ç”¨æˆ·çš„æ•°æ®åˆ†æžï¼Œæ‰¾åˆ°ç²¾å‡†çš„å—ä¼—ç¾¤æ¥è¥é”€ï¼Œå¯ä»¥åœ¨èŠ‚çœè¥é”€é¢„ç®—çš„å‰æä¸‹å¤§å¹…æå‡è½¬åŒ–çŽ‡ï¼Œä½¿å¾—æ•°æ®äº§ç”Ÿä»·å€¼ã€‚ åœ¨ç²¾å‡†è¥é”€çš„å„ç§æŠ€æœ¯ä¸­ï¼Œæœ‰ä¸ªå¾ˆæ—¶é«¦çš„æŠ€æœ¯å«åšâ€œlookalikeâ€ã€‚ ä»€ä¹ˆæ˜¯â€œlookalikeâ€å‘¢ï¼Ÿ LookalikeæŠ€æœ¯åŸºäºŽç§å­ç”¨æˆ·ç”»åƒå’Œç¤¾äº¤å…³ç³»é“¾å¯»æ‰¾ç›¸ä¼¼çš„å—ä¼—ï¼Œå³åœ¨å¤§é‡ç”¨æˆ·ç¾¤ä¸­é€‰æ‹©ä¸€ç»„ç‰¹å®šçš„ç§å­ï¼ˆå³æœ‰è½¬åŒ–è¡Œä¸ºçš„ï¼‰å—ä¼—ï¼ŒåŒ…æ‹¬ä½†ä¸å±€é™äºŽç‚¹å‡»ã€ä¸‹è½½ã€å®‰è£…ã€æ¿€æ´»ï¼Œç„¶åŽæ ¹æ®å®žé™…éœ€æ±‚ï¼Œç­›é€‰ã€è¯†åˆ«ã€æ‹“å±•æ›´å¤šç›¸ä¼¼å—ä¼—ï¼Œè¿›ä¸€æ­¥å¼•å‘æ›´å¤§å®¢æˆ·é‡çº§çš„å€å¢žã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹lookalikeä¹‹å‰ï¼Œæˆ‘ä»¬æ€Žä¹ˆæ¥é€šè¿‡å¤§æ•°æ®ç²¾å‡†è¥é”€ã€‚ é¦–å…ˆï¼Œå‡å®šé€šè¿‡å‰æœŸçš„å¤§æ•°æ®å»ºè®¾ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†æ¯”è¾ƒå®Œå¤‡çš„ç”¨æˆ·ç”»åƒæ ‡ç­¾åº“ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ€§åˆ«ã€å¹´é¾„ã€åå¥½ç­‰ç­‰ã€‚æˆ‘ä»¬çš„ä¸šåŠ¡äººå‘˜æ ¹æ®ä¸šåŠ¡ç»éªŒï¼Œç›´æŽ¥å¯ä»¥æ ¹æ®æ ‡ç­¾è§„åˆ™æ¥ç­›é€‰å‡ºç”¨æˆ·ç¾¤ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºŽæŠ¤è‚¤å“æ¥è¯´ï¼Œç”¨æˆ·ç¾¤ä¸€èˆ¬å°±æ˜¯â€œ18-40å²ï¼Œå¥³æ€§ï¼Œç¾Žå¦†åå¥½â€ç­‰ã€‚ç­›é€‰å‡ºæ¥çš„æ½œåœ¨ç”¨æˆ·ç¾¤ï¼Œå¯ä»¥ç›´æŽ¥è¿›è¡Œå¹¿å‘ŠæŽ¨é€ç­‰è§¦è¾¾ï¼Œè½¬åŒ–çŽ‡è‚¯å®šæ¯”å¹¿æ’’ç½‘æ›´é«˜ï¼Œè€Œä¸”èŠ±è´¹çš„æˆæœ¬è¿˜ä½Žã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼ä»ç„¶æœ‰å±€é™æ€§ã€‚å…¶ä¸€ï¼Œå¦‚æžœä¸šåŠ¡äººå‘˜æ— æ³•å‡†ç¡®å®šä½äººç¾¤ç‰¹å¾æ€Žä¹ˆåŠžï¼Ÿå…¶äºŒï¼Œå¦‚æžœéœ€è¦å¯¹100wäººæŠ•æ”¾ï¼Œæ ‡ç­¾ç­›é€‰åªé€‰å‡ºäº†30wäººæ€Žä¹ˆåŠžï¼Ÿ 2012å¹´ï¼ŒFacebookåœ¨å¹¿å‘Šé¢†åŸŸå¼€å§‹åº”ç”¨å®šåˆ¶åŒ–å—ä¼—ï¼ˆFacebook CustomAudiencesï¼‰åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥è®©ä¼ä¸šä¸ç”¨å†é€‰æ‹©æ ‡ç­¾ï¼ŒåŒ…æ‹¬ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€å…´è¶£ç­‰ï¼Œä¼ä¸šéœ€è¦åšçš„åªæ˜¯ä¸Šä¼ ä¸€æ‰¹ç›®å‰å·²æœ‰çš„ç”¨æˆ·æˆ–è€…æ„Ÿå…´è¶£çš„ä¸€æ‰¹ç”¨æˆ·ï¼Œå‰©ä¸‹çš„å·¥ä½œï¼Œå°±ç”±å—ä¼—å‘çŽ°åŠŸèƒ½æ¥å®Œæˆã€‚ åƒFacebookè¿™æ ·é€šè¿‡ä¸€ç¾¤å·²æœ‰çš„ç”¨æˆ·å‘çŽ°å¹¶æ‰©å±•å‡ºå…¶ä»–ç”¨æˆ·çš„ç®—æ³•å°±å«Lookalikeã€‚å„ä¸ªå¤§åŽ‚çº·çº·åœ¨è¿™ä¸ªåŠŸèƒ½ä¸Šå‘åŠ›ï¼Œå…¸åž‹çš„åŒ…æ‹¬è…¾è®¯åœ¨å¾®ä¿¡ç«¯çš„å¹¿å‘ŠæŽ¨èçš„åº”ç”¨ç­‰ã€‚å…·ä½“å®žçŽ°çš„æŠ€æœ¯ä¹Ÿæœ‰å¤šç§ï¼Œæœ‰åŸºäºŽè§„åˆ™å®šä¹‰çš„ï¼Œæœ‰æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ æ¥å»ºæ¨¡çš„ï¼Œä¹Ÿæœ‰é€šè¿‡ç¤¾äº¤ç½‘ç»œçš„ã€‚å¯ä»¥çœ‹åˆ°ï¼Œlookalikeæ˜¯åŸºäºŽç”¨æˆ·ç”»åƒä¹‹ä¸Šçš„ã€æ›´ç›´æŽ¥çš„ä¸€ç§å¤§æ•°æ®åº”ç”¨ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ç§å¾ˆä¼˜é›…çš„æ–¹å¼ï¼šé€šè¿‡neo4jå›¾æ•°æ®åº“æ¥å®žçŽ°lookalikeã€‚ æ€è·¯lookalikeï¼Œå³ç›¸ä¼¼äººç¾¤æ‰©å±•ã€‚åŸºæœ¬åŽŸç†å°±æ˜¯æ ¹æ®å„ç§ç»´åº¦ï¼Œæ‰¾åˆ°è·Ÿç§å­ç”¨æˆ·ç¾¤ç›¸ä¼¼çš„äººç¾¤ã€‚æœ¬æ–‡ä»Žæœ€å¸¸è§çš„å‡ ç§åœºæ™¯å…¥æ‰‹ï¼Œå°†ç»´åº¦å¤§è‡´åˆ†ä¸ºåŸºäºŽè”ç³»äººæ‰©æ•£ã€åŸºäºŽåœ°ç†ä½ç½®æ‰©æ•£ã€åŸºäºŽè¡Œä¸ºæ‰©æ•£ã€‚å½“ç„¶ï¼Œå®žé™…ç”Ÿäº§ä¸­çš„æ‰©æ•£è§„åˆ™éœ€è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯æ¥ä»”ç»†è®¾è®¡ã€‚ ç”¨æˆ·æ•°æ®ï¼Œç‰¹åˆ«æ˜¯ç¤¾äº¤ç½‘ç»œä¸Šçš„ç”¨æˆ·æ•°æ®ï¼Œå¤©ç„¶æ˜¯å›¾ç»“æž„ã€‚èŠ‚ç‚¹æ˜¯ç”¨æˆ·ï¼Œè¾¹å°±æ˜¯å¥½å‹æˆ–è”ç³»äººã€‚ä½¿ç”¨å›¾æ•°æ®åº“ï¼Œåœ¨é€‰å®šæŸç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®ç¤¾äº¤å…³ç³»æ¥æ‰©æ•£ï¼Œå¯ä»¥å–å¾—éžå¸¸é«˜æ•ˆçš„æŸ¥è¯¢æ•ˆæžœã€‚åŒæ ·ï¼Œæˆ‘ä»¬æŠŠç”¨æˆ·ä¸Žç”¨æˆ·ä¹‹é—´çš„åœ°ç†è·ç¦»åšæˆè¾¹ã€ç”¨æˆ·ä¸Žç”¨æˆ·ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦åšæˆè¾¹ï¼Œé‚£ä¹ˆç›¸ä¼¼çš„æŸ¥è¯¢æŽ¥å£ï¼Œå¯ä»¥æŠŠè¿™ä¸‰ç§æ‰©æ•£å…³ç³»å¿«é€Ÿå¾—åˆ°ã€‚ æˆ‘ä»¬çš„å›¾æ•°æ®schemaå¯ä»¥è§ä¸‹å›¾ï¼š Personè¡¨ç¤ºç”¨æˆ·å®žä½“ï¼ŒPhoneè¡¨ç¤ºæ‰‹æœºå·ç å®žä½“ï¼ŒCityè¡¨ç¤ºåŸŽå¸‚å®žä½“ã€‚ ç”¨æˆ·å’Œæ‰‹æœºå·ä¹‹é—´æœ‰HAS_PHONEå’ŒHAS_CONTACTå…³ç³»ï¼Œåˆ†åˆ«è¡¨ç¤ºæ‹¥æœ‰æ‰‹æœºå·å’Œè”ç³»äººå·ç ã€‚ ç”¨æˆ·å’ŒåŸŽå¸‚ä¹‹é—´æœ‰IN_CITYå…³ç³»ï¼Œè¡¨ç¤ºæ‰€åœ¨åŸŽå¸‚ã€‚ ç”¨æˆ·å’Œç”¨æˆ·ä¹‹é—´æœ‰SIMILARå…³ç³»ï¼Œè¡¨ç¤ºä½™å¼¦ç›¸ä¼¼ã€‚ æ•°æ®æˆ‘ä»¬çš„æ•°æ®ç›´æŽ¥æ¥æºäºŽç”¨æˆ·ç”»åƒï¼Œä¸€èˆ¬æ˜¯å­˜å‚¨åœ¨ElasticSearchæˆ–è€…HBaseä¹‹ä¸Šï¼Œä»¥ç”¨æˆ·idä¸ºrowkeyï¼Œæ¯ä¸ªæ ‡ç­¾ä¸ºä¸€ä¸ªç‰¹å¾ï¼Œæ ‡ç­¾å€¼ä¸ºç‰¹å¾å€¼ã€‚æ ‡ç­¾åŒ…æ‹¬é™æ€å±žæ€§å¦‚å¹´é¾„ã€æ€§åˆ«ã€æ‰‹æœºå·ã€è”ç³»äººç­‰ï¼ŒåŠ¨æ€å±žæ€§å¦‚gpsä½ç½®ã€æœ€è¿‘çš„ç‚¹å‡»è¡Œä¸ºã€ä¸‹è½½è¡Œä¸ºã€è´­ä¹°è¡Œä¸ºç­‰ç­‰ã€‚ æˆ‘ä»¬å°†åŽŸå§‹æ•°æ®å¯¼å…¥Pandasï¼Œå¾—åˆ°ä¸€ä¸ªshapeä¸ºï¼ˆ9550, 428ï¼‰çš„DataFrameï¼Œå³å…±æœ‰9550ä¸ªç”¨æˆ·ï¼Œ428ä¸ªç‰¹å¾ã€‚ æŽ¥ä¸‹æ¥æ˜¯æ•°æ®å¤„ç†ã€‚å¤„ç†çš„ç›®çš„ï¼Œæ˜¯ç”Ÿæˆå®žä½“å’Œå…³ç³»çš„csvæ–‡ä»¶ï¼Œç”¨äºŽneo4jçš„æ•°æ®å¯¼å…¥ã€‚ åŸŽå¸‚å®žä½“åŸŽå¸‚å®žä½“å¾ˆç®€å•ï¼Œå–å‡ºDataFrameä¸­çš„æ‰€æœ‰åŸŽå¸‚å­—æ®µï¼ŒåŽ»é‡å³å¯ã€‚ 1234567all_city = set(df['City_Cd'].values)with open('city_nodes.csv', 'w', newline='', encoding='utf-8') as f: headers = ['city'] f_csv = csv.writer(f) f_csv.writerow(headers) for item in all_city: f_csv.writerow([item]) æ‰‹æœºå·å®žä½“æ‰‹æœºå·ç åˆ†åˆ«å­˜å‚¨åœ¨ç”¨æˆ·æ‰‹æœºå·åŠè”ç³»äººæ‰‹æœºå·å­—æ®µé‡Œï¼Œä¹Ÿæ˜¯å…¨éƒ¨å–å‡ºå†åŽ»é‡ï¼š 12all_phone_num = set(np.concatenate((df['Mobile_Num'].values, df['Contact_Tel'].values))) ç”¨æˆ·å®žä½“ç”¨æˆ·å®žä½“æ¯”è¾ƒå¤æ‚ã€‚é¦–å…ˆç”¨æˆ·idï¼Œç”¨æˆ·å§“åï¼Œgpsç»çº¬åº¦éƒ½å¯ä»¥ç›´æŽ¥å¾—åˆ°ã€‚è¦åšç”¨æˆ·ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œå¾—æŠŠç”¨æˆ·è¡Œä¸ºè¡¨ç¤ºæˆä¸€å®šç»´åº¦çš„å‘é‡æ‰è¡Œã€‚è¿™é‡Œå°±ç‰µæ¶‰äº†åŸºæœ¬çš„æœºå™¨å­¦ä¹ æ•°æ®é¢„å¤„ç†æ“ä½œã€‚ é¦–å…ˆæˆ‘ä»¬å°†æ‰€éœ€è¦çš„ç”¨æˆ·è¡Œä¸ºç›¸å…³çš„ç‰¹å¾å­—æ®µåˆ†ä¸ºè¿žç»­æ•°å€¼åž‹(numerical)å’Œç±»åˆ«åž‹(categorical)ã€‚ 12data_action_categorical = df[action_columns_string]data_action_numerical = df[action_columns_float] é’ˆå¯¹categoricalç±»åž‹ï¼Œéœ€è¦åšOneHotå¤„ç†ï¼Œæˆ‘ä»¬ç›´æŽ¥ç”¨sklearnçš„apiã€‚ 12action_oh_enc = OneHotEncoder(handle_unknown='ignore')data_action_categorical_onehot = action_oh_enc.fit_transform(data_action_categorical) é’ˆå¯¹numericalç±»åž‹ï¼Œéœ€è¦åšå½’ä¸€åŒ–ï¼Œè¿™æ ·æ‰èƒ½æŠŠæ¯ä¸ªç»´åº¦çš„ç‰¹å¾æ”¾åœ¨ç»Ÿä¸€å°ºåº¦æ¥è¿›è¡Œç›¸ä¼¼åº¦è¿ç®—ã€‚ 12mms_action = MinMaxScaler()data_action_numerical = mms_action.fit_transform(data_action_numerical) ç„¶åŽå°±å¯ä»¥æŠŠå®ƒä»¬æ‹¼æŽ¥åœ¨ä¸€èµ·ã€‚ç”±äºŽsklearnçš„OneHotç”Ÿæˆçš„æ˜¯sparseçŸ©é˜µï¼Œéœ€è¦ç”¨åˆ°scipy.sparseçš„hstackã€‚ 12df_action = hstack([data_action_numerical, data_action_categorical_onehot])# df_action.shape (9550, 99) è¿™æ ·ï¼Œæ¯ä¸ªç”¨æˆ·çš„è¡Œä¸ºæ•°æ®è¢«å¤„ç†æˆä¸€ä¸ª99ç»´çš„å‘é‡ï¼Œå¯ä»¥è¿›è¡Œä½™å¼¦ç›¸ä¼¼åº¦è¿ç®—äº†ã€‚åœ¨å®žé™…å·¥ä½œä¸­ï¼Œè€ƒè™‘åˆ°è®¡ç®—èµ„æºå’Œæ•ˆçŽ‡çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨PCAç­‰ç®—æ³•å°†è¿™ä¸ªå‘é‡ç»§ç»­é™ç»´ï¼Œå…·ä½“å¯å‚è€ƒä½¿ç”¨numpyæ¥ç†è§£PCAå’ŒSVDã€‚ ç„¶åŽå°±æ˜¯ç”¨æˆ·å®žä½“csvçš„åˆ›å»ºäº†ã€‚é™¤äº†å¸¸è§„çš„å±žæ€§ï¼Œæˆ‘ä»¬æŠŠç”¨æˆ·è¡Œä¸ºå‘é‡ä½œä¸ºembeddingå±žæ€§å­˜å‚¨ã€‚ 12345678with open('nodes.csv', 'w', newline='', encoding='utf-8') as f: headers = ['tree_id', 'cust_num', 'cust_name', 'longitude', 'latitude', 'embedding'] f_csv = csv.writer(f) f_csv.writerow(headers) index = 0 for item in df.itertuples(): f_csv.writerow([item[0], item[1], item[2], item[3], item[4], list(df_action[index])]) index += 1 å¯ä»¥å¤§è‡´çœ‹ä¸€ä¸‹ç”Ÿæˆçš„csvçš„æƒ…å†µï¼š HAS_PHONEå…³ç³»è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å°†csvåˆ†ä¸ºä¸¤åˆ—ï¼Œç¬¬ä¸€åˆ—ä¸ºç”¨æˆ·idï¼Œç¬¬äºŒåˆ—ä¸ºæ‰‹æœºå· 123456with open('has_phone_relations.csv', 'w', newline='', encoding='utf-8') as f: headers = ['cust_num', 'phone_num'] f_csv = csv.writer(f) f_csv.writerow(headers) for item in df.itertuples(): f_csv.writerow([item[1], item[3]]) åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°HAS_CONTACTå…³ç³»ã€IN_CITYå…³ç³»ï¼Œåˆ†åˆ«å¾—åˆ°ç›¸åº”çš„CSVã€‚ è‡³æ­¤ï¼Œæ•°æ®å¤„ç†å·²åŸºæœ¬å®Œæ¯•ï¼Œå‰©ä¸‹çš„ä»»åŠ¡å°±æ˜¯æŠŠcsvæ•°æ®å¯¼å…¥neo4jï¼Œå¼€å§‹æˆ‘ä»¬çš„å›¾æ•°æ®ä¹‹æ—…ï¼Œä¸”å¬ä¸‹å›žåˆ†è§£ã€‚]]></content>
      <categories>
        <category>Knowledge Graph</category>
      </categories>
      <tags>
        <tag>Neo4J</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸”çœ‹ä»–æ·±åº¦å­¦ä¹ å…µåˆ†ä¸‰è·¯ï¼Œç›´æŒ‡æŽ¨èç³»ç»Ÿ]]></title>
    <url>%2Fposts%2Fdeep-learning-in-recommendation-system%2F</url>
    <content type="text"><![CDATA[èµ·æºè‡ªäº’è”ç½‘å…´èµ·ä»¥æ¥ï¼Œäººä»¬é€æ¸ä»Žä¿¡æ¯åŒ®ä¹èµ°å‘äº†ä¿¡æ¯è¿‡è½½çš„æ—¶ä»£ã€‚ä»Žæˆåƒä¸Šä¸‡çš„ç½‘é¡µã€æ–°é—»ï¼Œåˆ°å„ç§éŸ³ä¹ã€è§†é¢‘ï¼Œå¦‚ä½•æ ·ä»Žå¦‚æ­¤ç¹å¤šçš„ä¿¡æ¯ä¸­æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ï¼Œå°±æˆäº†äº’è”ç½‘æ—¶ä»£çš„ä¸€ä¸ªéžå¸¸é‡è¦çš„è¯¾é¢˜ã€‚ ä»¥Yahooä¸ºä»£è¡¨çš„åˆ†ç±»ç›®å½•ç½‘ç«™ï¼Œé¦–å…ˆç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚ä»–ä»¬å°†ç½‘ç«™ä¿¡æ¯ç³»ç»Ÿåœ°åˆ†ç±»æ•´ç†ï¼Œäººä»¬å¯ä»¥æ ¹æ®éœ€æ±‚é€çº§æµè§ˆã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆåªèƒ½è¦†ç›–å°‘é‡çš„çƒ­é—¨ç½‘ç«™ã€‚ ç´§æŽ¥ç€ï¼Œä»¥Googleä¸ºä»£è¡¨æœç´¢å¼•æ“Žï¼Œåœ¨å¯¹ä¿¡æ¯è¿›è¡Œç»„ç»‡å’Œå¤„ç†åŽï¼Œä¸ºç”¨æˆ·æä¾›äº†æ£€ç´¢æœåŠ¡ï¼Œè§£å†³äº†é•¿å°¾éœ€æ±‚çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æžœç”¨æˆ·æ— æ³•æ‰¾åˆ°å‡†ç¡®éœ€æ±‚çš„æè¿°å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œæˆ‘ä»Šå¤©æƒ³çœ‹ä¸€éƒ¨ç”µå½±ï¼Œå“ªä¸ªç”µå½±å¥½çœ‹ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œæœç´¢å¼•æ“Žä¹Ÿè§£å†³ä¸äº†ã€‚ è¿™æ—¶ï¼Œä»¥Amazonä¸ºä»£è¡¨çš„å…¬å¸å¼€å§‹äº†æŽ¨èç³»ç»Ÿçš„ç ”ç©¶ã€‚ä»Žç”¨æˆ·è¡Œä¸ºä¸­æ‰¾åˆ°ç”¨æˆ·çš„ä¸ªæ€§åŒ–éœ€æ±‚ï¼Œå†å°†ä¿¡æ¯å‡†ç¡®çš„æŽ¨èç»™éœ€è¦å®ƒçš„ç”¨æˆ·ã€‚ä½œä¸ºä¸€ä¸ªæ¡¥æ¢ï¼Œå¸®åŠ©ç”¨æˆ·å‘çŽ°å¯¹è‡ªå·±æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œè®©ä¿¡æ¯èƒ½å¤Ÿå±•çŽ°åœ¨å¯¹å®ƒæ„Ÿå…´è¶£çš„ç”¨æˆ·é¢å‰ï¼Œè¿™å°±æ˜¯æŽ¨èç³»ç»Ÿçš„ä½¿å‘½ã€‚ æŽ¨èç³»ç»Ÿæ˜¯ä¸€ä¸ªéžå¸¸åºžå¤§çš„è¯é¢˜ã€‚ä»Šå¤©æˆ‘ä»¬ä¸å±•å¼€æ¥è®²ã€‚æˆ‘ä»¬ä»Šå¤©çš„è¯é¢˜æ˜¯åœ¨å½“å‰å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œï¼Œä¼´éšç€æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå’Œè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„æ”»åŸŽæ‹”å¯¨ï¼Œä»–å¦‚ä½•åŽ»æ”»å ä¸‹ä¸€ä¸ªç›®æ ‡ â€“ æŽ¨èç³»ç»Ÿï¼ˆæ›´å‡†ç¡®çš„è¯´ â€“ æŽ¨èç®—æ³•ï¼‰ï¼Ÿ ä¸»æµå¤§æ•°æ®æŠ€æœ¯å’ŒAIç®—æ³•æ˜¯å½“ä»ŠæŽ¨èç³»ç»Ÿçš„åŸºç¡€ã€‚é€šè¿‡å¤§æ•°æ®å¹³å°ï¼Œå¯ä»¥å®žçŽ°å¯¹æµ·é‡ç”¨æˆ·è¡Œä¸ºçš„å‡†ç¡®é‡‡é›†å’Œå­˜å‚¨ï¼›é€šè¿‡æ•°æ®æŒ–æŽ˜ç®—æ³•ï¼Œå¯ä»¥é€šè¿‡ç”¨æˆ·è¡Œä¸ºæŒ–æŽ˜åˆ†æžç”¨æˆ·çš„ä¸ªæ€§ä¸Žåå¥½ï¼Œå½¢æˆçŽ°å®žä¸–ç•Œç”¨æˆ·çš„æ•°å­¦å»ºæ¨¡ â€“ ç”¨æˆ·ç”»åƒï¼›é€šè¿‡NLPåŠéŸ³é¢‘/è§†é¢‘ç†è§£ç®—æ³•ï¼Œå¯ä»¥å½¢æˆå‡†ç¡®æè¿°ç‰©å“çš„ç‰©å“ç”»åƒã€‚åœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šï¼Œå½¢æˆäº†å½“å‰å·¥ä¸šç•Œä¸»æµçš„æŽ¨èç³»ç»Ÿæž¶æž„ã€‚ä»¥è§†é¢‘æŽ¨èçš„åœºæ™¯ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾ ï¼š æŠ›å¼€å·¥ç¨‹æ–¹é¢çš„ç³»ç»Ÿæž¶æž„ï¼Œå•ç‹¬æ¥çœ‹æŽ¨èç®—æ³•ç›¸å…³ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå¬å›žç®—æ³•å’ŒæŽ’åºç®—æ³•ã€‚ å¬å›žç®—æ³•çš„ä½œç”¨ï¼Œæ˜¯ä»Žç™¾ä¸‡çº§çš„è§†é¢‘åº“é‡Œï¼Œé€šè¿‡ä¸€äº›ç›¸å¯¹ç®€å•ç²—æš´çš„ç®—æ³•ï¼Œå¿«é€Ÿç­›é€‰ç”¨æˆ·å¯èƒ½æ„Ÿå…´è¶£çš„è§†é¢‘ï¼ŒæŠŠç‰©å“é‡çº§é™åˆ°æ•°ç™¾ä¸ªï¼Œè¿™ä¹ˆåšçš„ç›®çš„ä¸»è¦æ˜¯ä»ŽèŠ‚çœè®¡ç®—æˆæœ¬çš„è§’åº¦è€ƒè™‘ã€‚å¸¸ç”¨çš„å¬å›žç®—æ³•ä¸¾ä¾‹ï¼š åŸºäºŽç”¨æˆ·ç”»åƒçš„ç®—æ³• åŸºäºŽå†…å®¹ç›¸ä¼¼åº¦çš„ç®—æ³• ååŒè¿‡æ»¤ç®—æ³• å½“ç„¶ï¼Œè¿˜å¯ä»¥åœ¨å¬å›žé˜¶æ®µï¼Œæ ¹æ®è¿è¥äººå‘˜çš„äººå·¥ç»éªŒï¼Œè¿›è¡Œäººä¸ºçš„è§†é¢‘å¬å›žã€‚ ç”±äºŽåœ¨å¬å›žé˜¶æ®µæŠŠç‰©å“çš„é‡çº§é™åˆ°äº†ç™¾çº§ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡æŽ’åºç®—æ³•æ¥åšç²¾ç»†åŒ–å¤„ç†äº†ã€‚æŽ’åºç®—æ³•çš„ç›®çš„ï¼Œå°±æ˜¯åœ¨è¿™å¬å›žçš„å‡ ç™¾ä¸ªè§†é¢‘é‡Œï¼Œæ ¹æ®ç”¨æˆ·çš„ç‚¹å‡»çŽ‡é¢„ä¼°ã€è§‚çœ‹æ—¶é•¿é¢„ä¼°ç­‰ç›®æ ‡ï¼ŒæŠŠè¿™äº›è§†é¢‘æŒ‰ç…§å¾—åˆ†æ¥æŽ’åºã€‚æŽ’åœ¨æœ€å‰é¢çš„ï¼Œå°±æ˜¯ç”¨æˆ·æœ€å–œæ¬¢æˆ–è€…æœ€æœ‰å¯èƒ½åŽ»çœ‹çš„ï¼Œåœ¨æŽ¨èçš„æ—¶å€™ï¼Œå°±ä¼˜å…ˆå±•ç¤ºå‡ºæ¥ã€‚è¿™ä¸€å—ç”±äºŽè®¡ç®—åŽ‹åŠ›ç›¸å¯¹è¾ƒå°ï¼Œæ˜¯å„ç§ç®—æ³•å¤§æ”¾å¼‚å½©çš„æ—¶å€™ã€‚ä»Žç»å…¸çš„é€»è¾‘å›žå½’LRã€åˆ°Facebookçš„Xgboost+LRã€å†åˆ°Googleä¸€é¸£æƒŠäººçš„Wide &amp; Deepã€ä¹ƒè‡³åŽé¢çš„DeepFMã€DCNç­‰ç­‰ï¼Œä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ é¢„å…ˆæ”»å çš„é¢†åœ°ã€‚ å†æ­¤ä»¥åŽï¼Œæ·±åº¦å­¦ä¹ å¦‚ä½•ç»§ç»­æ·±å…¥æŽ¨èç³»ç»Ÿé¢†åŸŸï¼ŒåŽ»å–å¾—åœ¨è®¡ç®—æœºè§†è§‰ã€NLPç±»ä¼¼çš„â€œåŠæ‰“ä¼ ç»Ÿâ€çš„æˆå°±å‘¢ï¼Ÿ å…µåˆ†ä¸‰è·¯æ³¨æ„åŠ›æœºåˆ¶Attentionï¼Œä¸­æ–‡ç¿»è¯‘ä¸ºæ³¨æ„åŠ›æœºåˆ¶ï¼Œæºè‡ªäºŽNLPçš„æœºå™¨ç¿»è¯‘é¢†åŸŸã€‚ ä¸Šå›¾ä¸ºæœºå™¨ç¿»è¯‘ä¸­çš„å…¸åž‹åœºæ™¯ â€“ Sequence to Sequenceï¼Œä¸»æµåšæ³•æ˜¯ç”¨Encoder â€“ Decoderçš„æž¶æž„æ¥åšã€‚å½“äººç±»éœ€è¦æŠŠâ€How are youâ€è¿™å¥è‹±è¯­ç¿»è¯‘æˆä¸­æ–‡æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ä¸€ä¸ªå•è¯ä¸€ä¸ªå•è¯çš„ç¿»è¯‘ï¼Œè€Œæ˜¯ç¿»è¯‘çš„è¿‡ç¨‹ä¸­ä¸æ–­å‚è€ƒä¸Šä¸‹æ–‡ï¼Œä¸åŒçš„ä¸Šä¸‹æ–‡ï¼Œå¯¹äºŽå½“å‰ç¿»è¯‘çš„æ–‡å­—ä½œç”¨ä¸åŒï¼Œåœ¨æ•°å­¦é‡Œé¢ï¼Œå°±æ˜¯æƒé‡ä¸åŒã€‚ 2017å¹´ï¼ŒGoogleçš„è®ºæ–‡ã€ŠAttention is All You Needã€‹æ¨ªç©ºå‡ºä¸–ï¼Œä»¥Attentionä¸ºä¸»è¦ç»“æž„çš„Transformerï¼Œç»“æŸäº†NLPé¢†åŸŸä¸­RNNçš„ç»Ÿæ²»ï¼Œå†æ¬¡åŸºç¡€ä¸Šå„ç§NLPæ¨¡åž‹å¦‚Bertç­‰ï¼Œä¹Ÿä¸æ–­åˆ·æ–°ç€NLPé¢†åŸŸçš„è®°å½•ã€‚åŒæ ·ï¼Œåœ¨è¯­éŸ³å’Œè§†é¢‘ç­‰æœ‰è¿žç»­åºåˆ—çš„åœºæ™¯ä¸­ï¼ŒAttentionä¹Ÿæ˜¯å„ç§å¹¿æ³›åº”ç”¨ï¼Œäººä»¬çº·çº·è¯´ï¼šçœŸé¦™ã€‚ é‚£ä¹ˆæŽ¨èç³»ç»Ÿå‘¢ï¼Ÿå…¶å®žæŽ¨èç³»ç»Ÿä¹Ÿæ˜¯å…¸åž‹çš„åºåˆ—åœºæ™¯ã€‚ä»¥ç½‘ç»œè´­ç‰©ä¸ºä¾‹ï¼Œä¸€ä¸ªç”¨æˆ·åœ¨åŠå¹´ä¹‹å†…è´­ä¹°çš„å•†å“ï¼Œå°±æ˜¯ä¸€ä¸ªåºåˆ—ã€‚æ ¹æ®ä¹‹å‰çš„åºåˆ—ï¼Œé¢„æµ‹ä»–ä¹‹åŽä¼šä¹°çš„å•†å“ï¼Œå°±æ˜¯æŽ¨èã€‚å› æ­¤ï¼Œåœ¨æŽ¨èç³»ç»Ÿä¸­åº”ç”¨Attentionï¼Œå†è‡ªç„¶ä¸è¿‡ã€‚ æ¥è‡ªé˜¿é‡Œå¦ˆå¦ˆçš„ç›–å¤å›¢é˜Ÿï¼Œå°±æ˜¯è¿™ä¹ˆåšçš„ã€‚ä»–ä»¬æå‡ºäº†DIN â€“ Deep Interest Networkã€‚ ä»–ä»¬è®¤ä¸ºï¼Œç”¨æˆ·çš„å…´è¶£æ˜¯éžå¸¸å¤šæ ·çš„ï¼Œè€Œå½“å‰çš„å€™é€‰å•†å“ï¼Œä»…ä»…åªæ˜¯è·Ÿç”¨æˆ·çš„ä¸€éƒ¨åˆ†å…´è¶£æœ‰å…³ã€‚åœ¨è€ƒè™‘æŽ’åºçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªå€™é€‰å•†å“ï¼Œåˆ†åˆ«è®¡ç®—ç”¨æˆ·ä»¥å¾€è´­ä¹°ç‰©å“çš„Attentionæƒé‡ï¼Œç„¶åŽæŠŠåŽ†å²è®°å½•é€šè¿‡Attentionæƒé‡è®¡ç®—embeddingã€‚ æ¯”å¦‚ä¸Šå›¾ä¸­ï¼Œä¸€ä½å¥³å£«è´­ä¹°è¿‡éž‹ã€åŒ…ã€å¤–å¥—ã€æ¯å­ç­‰ï¼Œä¸”å¤–å¥—ä¹°äº†å¾ˆå¤šï¼Œå½“å¥¹è´­ä¹°æ–°çš„å†¬å­£å¤–å¥—æ—¶ï¼Œè¿™ä¸ªå…´è¶£åªè·Ÿå¥¹ä¹‹å‰ä¹°è¿‡çš„å†¬å­£å¤–å¥—ç›¸å…³ï¼Œè·Ÿå¥¹ä¹°è¿‡çš„éž‹ã€åŒ…ã€æ¯å­ç­‰è¡Œä¸ºæ— å…³ã€‚é€šè¿‡Attentionæ¥ä½¿å¾—å½“å‰å€™é€‰ç‰©å“å±€éƒ¨æ¿€æ´»åŽ†å²å…´è¶£ï¼Œå®žçŽ°Local Activationï¼ŒåŒæ—¶ï¼Œæƒé‡çš„å¤šæ ·æ€§ä¹Ÿèƒ½å®žçŽ°ç”¨æˆ·å…´è¶£å¤šæ ·æ€§çš„è¡¨è¾¾ã€‚ å›¾ç¥žç»ç½‘ç»œå¦‚æžœè¯´æ³¨æ„åŠ›æœºåˆ¶æ˜¯æ·±åº¦å­¦ä¹ åœ¨æŽ¨èç³»ç»Ÿä¸­çš„æ­£å¸¸å‘å±•çš„è¯ï¼ŒåŸºäºŽçŸ¥è¯†å›¾è°±çš„å›¾ç¥žç»ç½‘ç»œï¼Œå°±æ˜¯ä¸€è·¯å¥‡å…µäº†ã€‚ çŸ¥è¯†è°±å›¾ï¼ŒKnowledge Graphï¼Œå³å¤§è§„æ¨¡è¯­ä¹‰ç½‘ç»œã€‚å®ƒæŠŠçŽ°å®žä¸–ç•ŒæŠ½è±¡æˆä¸€å¼ ç½‘ç»œï¼Œå…¶ä¸­å¯Œå«å®žä½“ï¼ˆentityï¼‰ã€æ¦‚å¿µï¼ˆconceptï¼‰ã€åŠå…¶ä¹‹é—´çš„å„ç§è¯­ä¹‰å…³ç³»ï¼ˆrelationshipï¼‰ã€‚ çŸ¥è¯†å›¾è°±æ—©åœ¨20ä¸–çºª60å¹´ä»£å°±å¼€å§‹æœ‰äººç ”ç©¶ï¼Œå½“æ—¶ç§°ä¸ºçŸ¥è¯†å·¥ç¨‹ï¼Œæ˜¯ç¬¦å·ä¸»ä¹‰çš„ä¸»è¦è§‚ç‚¹ï¼ˆæ·±åº¦å­¦ä¹ ä»£è¡¨ç€è¿žæŽ¥ä¸»ä¹‰ï¼‰ã€‚2012å¹´ï¼ŒGoogleæ”¶è´­äº†Metawebå…¬å¸ï¼Œæ­£å¼å‘å¸ƒäº†çŸ¥è¯†å›¾è°±ï¼Œä¸»è¦åº”ç”¨äºŽæœç´¢é¢†åŸŸã€‚å…¸åž‹çš„åº”ç”¨åœºæ™¯ï¼Œä½ åœ¨æœç´¢æ¡†é‡Œæœâ€œå§šæ˜Žçš„èº«é«˜â€ï¼Œå›žå¤çš„ç­”æ¡ˆç›´æŽ¥æ˜¯229cmï¼Œè€Œä¸æ˜¯ä»¥å¾€çš„æ–‡æœ¬å­—ç¬¦ä¸²åŒ¹é…ã€‚ çŸ¥è¯†å›¾è°±ä»£è¡¨ç€è®¤çŸ¥æ™ºèƒ½ï¼Œå®ƒä½¿å¾—AIå¯ä»¥ç†è§£åˆ°å…·ä½“æ–‡æœ¬èƒŒåŽä»£è¡¨çš„çŸ¥è¯†ã€‚æ¯”å¦‚ç”¨æˆ·å–œæ¬¢Cç½—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŽ¨ç†å‡ºç”¨æˆ·å–œæ¬¢è¶³çƒï¼Œé‚£ä¹ˆç»™ç”¨æˆ·æŽ¨èçš‡é©¬çš„æ¯”èµ›ã€ä¸–ç•Œæ¯è‘¡è„ç‰™é˜Ÿçš„æ¯”èµ›å°±æœ€è‡ªç„¶ä¸è¿‡äº†ã€‚ æ·±åº¦å­¦ä¹ æ”»å çŸ¥è¯†è°±å›¾é¢†åŸŸçš„å§¿åŠ¿ï¼Œæ˜¯â€œå›¾è¡¨ç¤ºå­¦ä¹ â€ï¼ˆGraph Representation Learningï¼‰ï¼Œå³å›¾ç¥žç»ç½‘ç»œã€‚é€šè¿‡å›¾è¡¨ç¤ºå­¦ä¹ ï¼Œå°†çŸ¥è¯†å›¾è°±ä¸­çš„èŠ‚ç‚¹ã€è¾¹ç­‰éƒ½è¡¨ç¤ºä¸ºç‰¹å¾å‘é‡ï¼Œè¿™äº›å‘é‡éƒ½è•´å«ç€èŠ‚ç‚¹é—´çš„çŸ¥è¯†ä¿¡æ¯ï¼Œç„¶åŽå„ç§çŸ¥è¯†çš„æŽ¨ç†è¿‡ç¨‹ï¼Œå°±å¯ä»¥é€šè¿‡æ•°å­¦çš„çŸ©é˜µè¿ç®—æ¥å¾—åˆ°ã€‚ é‚£ä¹ˆï¼Œæ·±åº¦å­¦ä¹ é€šè¿‡å›¾ç¥žç»ç½‘ç»œæ¥åšæŽ¨èç³»ç»Ÿï¼ŒåŒæ ·æ°´åˆ°æ¸ æˆã€‚ æˆ‘ä»¬ä»¥æ–°é—»æŽ¨èä¸ºä¾‹ã€‚å½“ç”¨æˆ·çœ‹è¿‡ä¸€å †æ–°é—»åŽï¼Œé¦–å…ˆé€šè¿‡NLPæŠ€æœ¯è¯†åˆ«å‡ºæ–°é—»ä¸­çš„å®žä½“ï¼Œå¦‚Trumpã€Tim Cookç­‰ï¼Œç„¶åŽæ ¹æ®å·²æœ‰çš„çŸ¥è¯†å›¾è°±ï¼Œå¯ä»¥å¾—åˆ°è¿™äº›å®žä½“é™„è¿‘â€œä¸€è·³â€ï¼ˆç”šè‡³å¤šè·³ï¼‰çš„å®žä½“ï¼Œé€šè¿‡å›¾åµŒå…¥ï¼ˆGraph Embeddingï¼‰å¾—åˆ°è¿™äº›è¿™äº›å®žä½“çš„ç‰¹å¾å‘é‡ã€‚æœ‰äº†è¿™äº›å‘é‡ï¼Œä¸ç®¡æ˜¯é€šè¿‡ä¼ ç»Ÿçš„å‘é‡ç›¸ä¼¼åº¦ã€è¿˜æ˜¯ä½œä¸ºä¸€ä¸ªç‰¹å¾æ”¾åˆ°æŽ’åºç®—æ³•ä¸­ï¼Œå°±æœ‰å¾ˆå¤šæ–¹å¼æ¥åšæŽ¨èäº†ã€‚ çŸ¥è¯†å›¾è°±æ˜¯æˆ‘è®¤ä¸ºç›®å‰éžå¸¸æœ‰æ½œåŠ›çš„ä¸€ä¸ªæ–¹å‘ï¼Œå®ƒä»£è¡¨ç€AIä»Žæ„ŸçŸ¥æ™ºèƒ½å‘è®¤çŸ¥æ™ºèƒ½çš„å‘å±•ï¼ŒåŒæ—¶ï¼Œå®ƒéžå¸¸å¥½çš„è§£å†³äº†å½“å‰æœºå™¨å­¦ä¹ è§£é‡Šæ€§å¼±çš„é—®é¢˜ã€‚ å¼ºåŒ–å­¦ä¹ æŽ¨èç³»ç»Ÿä¸€ç›´å­˜åœ¨ä¸€ä¸ªç—›ç‚¹ï¼Œå³EEé—®é¢˜ï¼ˆExplore &amp; Exploitï¼‰ã€‚Exploreå³æŽ¢ç´¢ï¼ŒæŒ‡åœ¨æœªçŸ¥çš„ç‰¹å¾ç©ºé—´çš„é‡‡æ ·ï¼›Exploitå³åˆ©ç”¨ï¼ŒæŒ‡åˆ©ç”¨æŽ¢ç´¢çš„ç»“æžœæ›´æœ‰æ•ˆçš„é¢„æµ‹ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œé€šå¸¸çš„æŽ¨èç®—æ³•æ˜¯åŸºäºŽç”¨æˆ·çš„åŽ†å²è¡Œä¸ºçš„ã€‚ä½ ç»å¸¸å¬å‘¨æ°ä¼¦çš„æ­Œï¼Œæˆ‘å°±ç»™ä½ æŽ¨å‘¨æ°ä¼¦ï¼Œæˆ–è€…ç±»ä¼¼æ¸¯å°çš„æµè¡Œæ­Œæ›²ã€‚ä¹…è€Œä¹…ä¹‹ï¼Œç”¨æˆ·ä¼šè¿›å…¥åˆ°â€œä¿¡æ¯èŒ§æˆ¿â€ä¹‹ä¸­ï¼Œæ°¸è¿œéƒ½æ˜¯å¬ç±»ä¼¼çš„ï¼Œæ²¡æœ‰â€œæƒŠå–œâ€ï¼Œè¿™å°±æ˜¯Exploitï¼›è€Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡ŒExploreä»¥æå‡æŽ¨èç³»ç»Ÿçš„å¤šæ ·æ€§ï¼ŒåŽ»å°è¯•æŽ¨èä¸€äº›ç”¨æˆ·æ²¡æœ‰å¬è¿‡çš„æ­Œï¼Œè™½ç„¶è¿™äº›æ­Œç”¨æˆ·å¯èƒ½ä¼šä¸å–œæ¬¢ã€‚ åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¿™æ˜¯åšä¸åˆ°çš„ã€‚æœºå™¨å­¦ä¹ çš„æ ¹åŸºæ˜¯åŸºäºŽå·²æœ‰æ ·æœ¬çš„å½’çº³å’Œæ‹Ÿåˆï¼Œè€Œå¯¹äºŽæœªçŸ¥ç‰¹å¾ç©ºé—´ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•é‡‡æ ·å¹¶æž„é€ è®­ç»ƒé›†çš„ã€‚ ä¼ ç»ŸæŽ¨èç³»ç»Ÿä¸­ï¼Œæœ‰äººåœ¨å°è¯•Banditç®—æ³•ï¼Œå³å¤šè‡‚è€è™Žæœºé—®é¢˜ï¼ˆMABï¼ŒMulti-armed bandit problemï¼‰ã€‚è€Œè¿™ä¸ªç®—æ³•ï¼Œå°±æ˜¯å½“å‰å¤§çƒ­çš„å¼ºåŒ–å­¦ä¹ çš„ç®€åŒ–ç‰ˆã€‚ å¼ºåŒ–å­¦ä¹ ï¼Œå³Reinforcement Learningï¼Œåˆç§°ä¸ºå¢žå¼ºå­¦ä¹ ã€‚è¿™æ˜¯åŒºåˆ«äºŽå¸¸è§çš„ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ ä¹‹å¤–çš„ï¼Œå¦ä¸€æ¡å¼ºåŠ²çš„AIåˆ†æ”¯ã€‚å¤§å®¶åº”è¯¥éƒ½çŸ¥é“Googleçš„AlphaGoå¤§æˆ˜æŽä¸–çŸ³ã€æŸ¯æ´ï¼Œè¿™èƒŒåŽå¼ºåŒ–å­¦ä¹ åŠŸä¸å¯æ²¡ã€‚ å¼ºåŒ–å­¦ä¹ çš„ä¸­å¿ƒæ€æƒ³ï¼Œå°±æ˜¯è®©æ™ºèƒ½ä½“ï¼ˆAgentï¼‰åœ¨çŽ¯å¢ƒï¼ˆEnvironmentï¼‰é‡Œé¢å­¦ä¹ ã€‚æ¯ä¸ªè¡ŒåŠ¨ï¼ˆActionï¼‰éƒ½ä¼šå¯¹åº”å„è‡ªçš„å¥–åŠ±ï¼ˆrewardï¼‰ï¼Œæ™ºèƒ½ä½“é€šè¿‡åˆ†æžæ•°æ®æ¥å­¦ä¹ ï¼Œæ€Žæ ·çš„æƒ…å†µä¸‹åº”è¯¥åšæ€Žæ ·çš„äº‹æƒ…ã€‚è¿™ç§æ–¹å¼æ˜¯éžå¸¸è‡ªç„¶çš„ï¼Œæ¯”å¦‚æœ‰ä¸ªå°å­©å­ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°äº†ç«ï¼Œèµ°åˆ°ç«è¾¹æ„Ÿå—åˆ°äº†ç«çš„æ¸©æš–ï¼Œä»–çŸ¥é“ç«æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼ˆreward+1ï¼‰ï¼Œå½“ä»–å°è¯•åŽ»æ‘¸ç«æ—¶ï¼Œåˆè¢«ç«çƒ«åˆ°ï¼ˆreward-1ï¼‰ã€‚æœ€åŽä»–å¾—å‡ºäº†ç»“è®ºï¼Œç¦»ç«ç¨è¿œä¸€ç‚¹å°±è¡Œï¼Œä¸èƒ½æŽ¥è¿‘ã€‚AIé€šè¿‡å¼ºåŒ–å­¦ä¹ ï¼Œè·Ÿäººç±»è‡ªèº«åŽ»å­¦ä¹ å¤§è‡ªç„¶æ˜¯åŠå…¶ç›¸ä¼¼çš„ã€‚ ä¼ ç»Ÿçš„å¼ºåŒ–å­¦ä¹ ä»£è¡¨ç®—æ³•åŒ…æ‹¬Q-Learningç­‰ï¼Œåœ¨æ·±åº¦å­¦ä¹ æ—¶ä»£ï¼Œé€šè¿‡æ·±åº¦ç¥žç»ç½‘ç»œæ¥è¿‘ä¼¼Qå€¼ï¼Œæå‡ºäº†Deep Q-Learningç­‰ã€‚ åŒæ ·ä»¥æ–°é—»æŽ¨èçš„åœºæ™¯ä¸¾ä¾‹ï¼š ç”¨æˆ·å’Œæ–°é—»æž„æˆäº†çŽ¯å¢ƒï¼Œ æŽ¨èç®—æ³•æ˜¯æ™ºèƒ½ä½“ã€‚å½“æ™ºèƒ½ä½“æ”¶åˆ°ä¸€ä¸ªæ–°é—»è¯·æ±‚åŽï¼Œå…ˆæ ¹æ®ç”¨æˆ·ç‰¹å¾å’Œæ–°é—»ç‰¹å¾ï¼ŒéšæœºæŽ¨èKä¸ªæ–°é—»ã€‚ç”¨æˆ·é€šè¿‡ç‚¹å‡»æˆ–ä¸ç‚¹å‡»æ¥ä½œä¸ºåé¦ˆï¼Œè€ŒæŽ¨èç®—æ³•å¯ä»¥å®žæ—¶æˆ–è€…å®šæ—¶ï¼Œæ ¹æ®æ¯ä¸ªæŽ¨èåŠåé¦ˆï¼Œæ¥æ›´æ–°ç­–ç•¥ï¼Œæœ€ç»ˆä½¿å¾—ç®—æ³•ç‚¹å‡»çŽ‡è¾¾åˆ°æœ€ä¼˜ã€‚ é€šè¿‡æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼Œå¯ä»¥ä¸æ–­çš„è¿›è¡ŒExploreæŽ¢ç´¢ï¼Œå¹¶é‡‡ç”¨ä¸æ–­ä¼˜åŒ–çš„æ–¹å¼æ¥Exploitï¼Œå®žçŽ°å‡†ç¡®æ€§å’Œå¤šæ ·æ€§çš„å¹³è¡¡ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†EEé—®é¢˜ï¼›å¦å¤–ï¼Œå®ƒè¿˜èƒ½è§£å†³æŽ¨èç³»ç»Ÿå†·å¯åŠ¨çš„é—®é¢˜ï¼Œå³å½“ç³»ç»Ÿåˆšä¸Šçº¿ï¼Œæˆ–è€…æ–°ç”¨æˆ·åˆ°æ¥ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šçš„æ•°æ®æ¥è¿›è¡Œä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆé€šè¿‡å¼ºåŒ–å­¦ä¹ æ¥å®žçŽ°è¿‡ç¨‹ä¸­çš„é€æ­¥ä¼˜åŒ–ï¼Œå°±æ˜¯å¾ˆå¥½çš„æ–¹å¼äº†ã€‚ æ€»ç»“æœ¬æ–‡å¯¹æŽ¨èç³»ç»Ÿçš„èµ·æºã€æ¦‚å¿µã€ä»¥åŠä¸»æµçš„æŽ¨èæž¶æž„è¿›è¡Œäº†ä»‹ç»ï¼Œé‡ç‚¹åˆ†äº«äº†åœ¨æ·±åº¦å­¦ä¹ æ—¶ä»£ï¼Œå­¦æœ¯ç•ŒåŠå·¥ä¸šç•ŒåŽ»åšæŽ¨èç®—æ³•çš„æ–°æ€è·¯ã€‚æ­£å¦‚æœ€è¿‘åŠ å…¥é˜¿é‡Œçš„è´¾æ‰¬æ¸…å¤§ç¥žæ‰€è¯´ï¼Œå¦‚æžœæ·±åº¦å­¦ä¹ æ”»ç ´äº†å½“å‰å æ®äº†å½“å‰äº’è”ç½‘å¤§å¤šæ•°èµ„æºå’Œç®—åŠ›çš„æŽ¨èç³»ç»Ÿã€å¹¿å‘Šé¢†åŸŸï¼Œå°±åƒå®ƒåœ¨è®¡ç®—æœºè§†è§‰å–å¾—çš„æˆå°±ä¸€æ ·ï¼Œé‚£ä¹ˆå¸¦æ¥çš„ä»·å€¼å°†ä¼šæ˜¯éžå¸¸å·¨å¤§çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œè¿™åªæ˜¯æ—¶é—´é—®é¢˜ã€‚]]></content>
      <categories>
        <category>Recommendation System</category>
      </categories>
      <tags>
        <tag>Attention</tag>
        <tag>DIN</tag>
        <tag>DQN</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ç†è§£CNNä¸­çš„å¹³ç§»ä¸å˜æ€§ï¼Ÿ]]></title>
    <url>%2Fposts%2Fcnn-shift-invariant%2F</url>
    <content type="text"><![CDATA[å‰è¨€æ·±åº¦å­¦ä¹ åœ¨è¿‘ä¸¤å¹´å¤§çº¢å¤§ç´«ï¼Œä¸»è¦åŠŸè‡£èŽ«è¿‡äºŽåœ¨è®¡ç®—æœºè§†è§‰computer visioné¢†åŸŸçš„çªç ´ã€‚è€Œè¿™é‡Œé¢ï¼Œæ·±åº¦å­¦ä¹ ç›¸å¯¹ä¼ ç»Ÿæ–¹å¼çš„æœ€å¤§ä¼˜åŠ¿ï¼Œæ˜¯é€šè¿‡ç¥žç»ç½‘ç»œç»“æž„å®žçŽ°ç‰¹å¾çš„è‡ªåŠ¨æå–ï¼šç›´æŽ¥æŠŠåŽŸå§‹å›¾åƒåƒç´ ç‚¹è¾“å…¥ï¼Œç½‘ç»œå¯ä»¥è‡ªåŠ¨æå–å‡ºæœ‰åˆ©äºŽåˆ¤æ–­çš„ç‰¹å¾ã€‚ å®žçŽ°è¿™ä¸€åˆ‡çš„å…³é”®ï¼Œå°±æ˜¯CNNï¼ˆConvolutional Neural Networksï¼‰å·ç§¯ç¥žç»ç½‘ç»œã€‚ä»Šå¤©æˆ‘ä»¬ä¸å±•å¼€æ¥è®²CNNï¼Œè€Œæ˜¯åŽ»ç†è§£CNNé‡Œé¢çš„ä¸€ä¸ªé‡è¦æ€§è´¨ - å¹³ç§»ä¸å˜æ€§ã€‚ è®¤è¯†å¤§ç¥žæ­£æ–‡ä¹‹å‰è¿˜æ˜¯è¦å…ˆæ‹œä¸€æ‹œCNNä¹‹çˆ¶ - Yann LeCunï¼Œæ·±åº¦å­¦ä¹ ä¸‰å·¨å¤´ä¹‹ä¸€ã€ç¬‘å‚²AIç•Œçš„ç”·äººã€æ‹¥æœ‰ä¸­æ–‡è¯‘åæœ€å¤šçš„æ³•å›½äººðŸ˜„ CNNåŽŸç†ç®€ä»‹ å·ç§¯ç¥žç»ç½‘ç»œï¼ˆConvolutional Neural Networks, CNNï¼‰æ˜¯ä¸€ç±»åŒ…å« å·ç§¯ è®¡ç®—ä¸”å…·æœ‰æ·±åº¦ç»“æž„çš„ å‰é¦ˆç¥žç»ç½‘ç»œ ï¼ˆFeedforward Neural Networksï¼‰ï¼Œæ˜¯ æ·±åº¦å­¦ä¹  ï¼ˆdeep learningï¼‰çš„ä»£è¡¨ç®—æ³•ä¹‹ä¸€ [1-2] ã€‚å·ç§¯ç¥žç»ç½‘ç»œå…·æœ‰ è¡¨å¾å­¦ä¹  ï¼ˆrepresentation learningï¼‰èƒ½åŠ›ï¼Œèƒ½å¤ŸæŒ‰å…¶é˜¶å±‚ç»“æž„å¯¹è¾“å…¥ä¿¡æ¯è¿›è¡Œå¹³ç§»ä¸å˜åˆ†ç±»ï¼ˆshift-invariant classificationï¼‰ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºâ€å¹³ç§»ä¸å˜äººå·¥ç¥žç»ç½‘ç»œï¼ˆShift-Invariant Artificial Neural Networks, SIANNï¼‰â€œ å·ç§¯é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä»€ä¹ˆæ˜¯å·ç§¯ã€‚æˆ‘ä»¬å°†é—®é¢˜ç®€åŒ–ï¼Œå‡è®¾åŽŸå§‹å›¾åƒåƒç´ çŸ©é˜µå¦‚ä¸‹ï¼š å³é«˜åº¦ä¸º4ï¼Œå®½åº¦ä¸º4ï¼Œé€šé“æ•°æ˜¯1ã€‚ å‡è®¾filteræ˜¯è¿™æ ·ï¼š å³shape=(2, 2, 1) æˆ‘ä»¬å°†filteræ”¾åœ¨åŽŸå§‹å›¾åƒçš„å·¦ä¸Šè§’ï¼Œåšå·ç§¯æ“ä½œï¼ˆçŸ©é˜µå„ä¸ªå…ƒç´ ç›¸ä¹˜ï¼Œæœ€åŽç›¸åŠ ï¼‰ï¼Œç»“æžœä¸º1x0+1x0+1x0+1x1=1ã€‚ ä»¥æ­¤ç±»æŽ¨ï¼Œå¦‚æžœæˆ‘ä»¬å°†filteræ²¿ç€åŽŸå§‹å›¾åƒä»Žå·¦åˆ°å³ï¼Œä»Žä¸Šåˆ°ä¸‹ï¼Œä¾æ¬¡æ‰«æï¼Œæ¯ä¸€æ¬¡æ‰«æéƒ½åšä¸€æ¬¡å·ç§¯æ“ä½œï¼Œåˆ™å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„çŸ©é˜µã€‚ è¿˜æ˜¯å»¶ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°†æ‰«ææ“ä½œç®€åŒ–ï¼Œno padding, no stridesï¼Œå¯ä»¥å¾—åˆ°ï¼š å­¦è¿‡ã€Šä¿¡å·ä¸Žç³»ç»Ÿã€‹çš„åŒå­¦è‚¯å®šèƒ½è®°å¾—è€å¸ˆåœ¨è¯¾ä¸Šç»å¸¸è®²çš„ä¸€å¥è¯ï¼š æ—¶åŸŸå·ç§¯ç­‰äºŽé¢‘åŸŸç›¸ä¹˜æ—¶åŸŸå·ç§¯ç­‰äºŽé¢‘åŸŸç›¸ä¹˜æ—¶åŸŸå·ç§¯ç­‰äºŽé¢‘åŸŸç›¸ä¹˜ ç®€å•æ¥è¯´ï¼ŒCNNä¸­çš„å·ç§¯æ“ä½œï¼Œå¯ä»¥ç†è§£ä¸ºå¤šä¸ªä¸åŒç±»åž‹çš„æ»¤æ³¢å™¨çš„æ»‘åŠ¨çª—å£åœ¨å›¾åƒå…¨å›¾æ»‘åŠ¨ï¼Œæœ€åŽå¾—åˆ°æ»¤æ³¢åŽçš„ç»“æžœã€‚è€Œè¿™å¤šä¸ªæ»¤æ³¢å™¨ä¸æ˜¯é¢„å…ˆå®šä¹‰çš„ï¼Œæ˜¯ç½‘ç»œé€šè¿‡ä¸æ–­çš„è®­ç»ƒå­¦ä¹ åˆ°çš„ã€‚ MaxPoolingCNNä¸­è¿˜æœ‰ä¸€ä¸ªéžå¸¸é‡è¦çš„æ“ä½œï¼Œå«MaxPoolingï¼Œä¸­æ–‡ç¿»è¯‘ä¸ºæœ€å¤§æ± åŒ–ï¼Œå³å–å±€éƒ¨æŽ¥å—åŸŸä¸­å€¼æœ€å¤§çš„ç‚¹ã€‚ è¿™ä¸ªæ“ä½œå¾ˆç®€å•ï¼Œè¿˜æ˜¯ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æŠŠå¾—åˆ°çš„ç»“æžœåšä¸€æ¬¡3x3çš„MaxPoolingï¼Œå³æ‰¾å‡º3x3æ ¼å­é‡Œçš„æœ€å¤§å€¼ï¼Œå³ä¸º3ã€‚å½“ç„¶é€šå¸¸æƒ…å†µä¸‹ä¹Ÿæ˜¯éœ€è¦åšæ»‘åŠ¨æ“ä½œçš„ã€‚ å¹³ç§»ä¸å˜æ€§å¥½äº†ï¼Œäº†è§£äº†CNNçš„åŸºæœ¬æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥æ¥çœ‹å¹³ç§»ä¸å˜æ€§äº†ã€‚ é¦–å…ˆè§£é‡Šä¸‹å¹³ç§»ä¸å˜æ€§ : å‡è®¾æˆ‘ä»¬éœ€è¦åšå›¾åƒè¯†åˆ«ï¼Œåˆ¤æ–­ä¸€å¼ å›¾ç‰‡é‡Œé¢æ˜¯çŒ«è¿˜æ˜¯ç‹—ï¼š é‚£ä¹ˆä¸è®ºè¿™å¼ å›¾ç‰‡é‡Œçš„çŒ«æˆ–ç‹—ä½äºŽå›¾åƒçš„å“ªä¸ªä½ç½®ï¼ˆä¸Šé¢è¿˜æ˜¯ä¸‹é¢ï¼Œå·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼‰ï¼Œæˆ‘ä»¬è®­ç»ƒå¥½çš„ç¥žç»ç½‘ç»œéƒ½èƒ½å¤ŸæŠŠå®ƒè¯†åˆ«å‡ºæ¥ã€‚è€ŒCNNæ°å¥½å°±å…·æœ‰è¿™æ ·çš„æ€§è´¨ã€‚ å¦‚ä½•ç†è§£å‘¢ï¼Ÿ æˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­æ‰©å±•ä¸€ä¸‹ï¼Œè¿™é‡Œæœ‰ä¸‰å¹…å›¾ç‰‡ è¿™é‡Œçš„ä¸‰è§’å½¢åˆ†åˆ«ä½äºŽä¸­é—´ï¼Œå·¦è¾¹å’Œä¸Šè¾¹ã€‚ æˆ‘ä»¬è¿˜æ˜¯ä»¥ç›¸åŒçš„2x2 filteråšå·ç§¯ å¯ä»¥å¾—åˆ°æ»¤æ³¢åŽçš„ç»“æžœ ç„¶åŽï¼Œå†åŒæ—¶åš3x3çš„MaxPoolingï¼Œç»“æžœå¦‚ä½•ï¼Ÿ å¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡ä¸‰è§’å½¢ä½äºŽä½•å¤„ï¼Œæœ€åŽéƒ½èƒ½å¾—åˆ°ç›¸åŒçš„ç»“æžœï¼Œè€Œè¿™ä¸ªç»“æžœå°±æ˜¯ç¥žç»ç½‘ç»œæœ€åŽåšå›¾åƒè¯†åˆ«çš„åˆ¤æ–­ä¾æ®ã€‚ æˆ‘ä»¬å¯ä»¥è¯´ï¼ŒCNNçš„å¹³ç§»ä¸å˜æ€§ï¼Œå¾ˆå¤§ç¨‹åº¦éœ€è¦å½’åŠŸäºŽMaxPoolingï¼Œå› ä¸ºå®ƒæ˜¯å–çš„æŸä¸ªåŒºåŸŸå†…çš„æžå¤§å€¼ã€‚ æœ€åŽå¹³ç§»ã€æ—‹è½¬ã€scalingä½œä¸ºå›¾åƒè¯†åˆ«çš„ä¸‰å¤§ç»å…¸é—®é¢˜ï¼Œä¸€ç›´éƒ½æ˜¯äººä»¬ç ”ç©¶çš„çƒ­ç‚¹ã€‚å¤§ç¥žYann LeCuné™ªä¼´Hintonä¸‰åå¹´ç£¨ä¸€å‰‘ï¼Œæœ€ç»ˆä½¿ç”¨æ·±åº¦å­¦ä¹ CNNå¾ˆå¥½çš„è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œä½¿å¾—è·Œå®•äº†å‡ åå¹´çš„æ·±åº¦ç¥žç»ç½‘ç»œé‡ç”Ÿï¼Œæœ€ç»ˆé—®é¼Žä¸–ç•Œã€‚ â€œæ·±åº¦ç¥žç»ç½‘ç»œæ—¢æ¼‚äº®ï¼Œåˆå…‰äº®é€æ˜Žâ€ï¼ŒLeCunè¯´ã€‚]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
      <tags>
        <tag>CNN</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¡ç®—æœºçœ¼ä¸­çš„æ•°å­¦ï¼Œè·Ÿä½ æ‰€å­¦çš„ä¸ä¸€æ ·]]></title>
    <url>%2Fposts%2Fmath-in-computer%2F</url>
    <content type="text"><![CDATA[Photo by Helloquence on Unsplash å¼•å­å…ˆæ¥ä¸€é“ç®€å•çš„å°å­¦æ•°å­¦é¢˜ï¼šå·²çŸ¥å‡½æ•°f(x)å®šä¹‰å¦‚ä¸‹ è‹¥x=0.1ï¼Œå°†f(x)çš„ç»“æžœä¸€ç›´ä»£å…¥f(x)ï¼Œè¿­ä»£næ¬¡ï¼Œç»“æžœæ˜¯æ€Žæ ·ï¼Ÿ æˆ‘ç›¸ä¿¡ï¼Œä»»ä½•å…·æœ‰å°å­¦æ•°å­¦æ°´å¹³çš„åŒå­¦éƒ½èƒ½è§£å‡ºè¿™é“æ•°å­¦é¢˜ï¼š0.2, 0.4, 0.8, 0.6, 0.2, 0.4, 0.8, 0.6, 0.2, 0.4, 0.8, 0.6, æ— é™å¾ªçŽ¯ ä½†æ˜¯æˆ‘è¦å‘Šè¯‰ä½ ï¼Œç›®å‰äººå·¥æ™ºèƒ½AIçš„åŸºç¡€-è®¡ç®—æœºï¼Œå´æ— æ³•è§£å‡ºè¿™é“é¢˜ã€‚ä½ ä¿¡ä¸ï¼Ÿ å®žéªŒä½ è‚¯å®šè¦è¯´äº†ï¼Œä¸å¯èƒ½ï¼è®¡ç®—æœºä¸å°±æ˜¯åšå„ç§è®¡ç®—çš„ä¹ˆï¼Œå„ç§é«˜ç­‰æ•°å­¦å¾®åˆ†ç§¯åˆ†éƒ½ä¸åœ¨è¯ä¸‹ï¼Œæ€Žä¹ˆå¯èƒ½è¿™é“é¢˜éƒ½è§£ä¸å‡ºï¼Ÿ OK, talk is cheap, show me the code. ä½ ç†Ÿç»ƒçš„æ‹¿å‡ºMacBook Proï¼Œå•ªå•ªå•ªå†™ä¸‹å¦‚ä¸‹ä»£ç , ä¸€æ°”å‘µæˆï¼š 12345678910def f(x): if x &lt;= 0.5: return 2 * x if x &gt; 0.5: return 2*x - 1x = 0.1for i in range(80): print(x) x = f(x) ä¼´éšç€ä½ å˜´è§’ä¸Šæ‰¬çš„å¾®ç¬‘ï¼Œè¿è¡Œäº†è¿™æ®µpythonä»£ç ï¼Œç»“æžœæ˜¯ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879800.10.20.40.80.60000000000000010.200000000000000180.400000000000000360.80000000000000070.60000000000000140.200000000000002840.40000000000000570.80000000000001140.60000000000002270.200000000000045470.400000000000090950.80000000000018190.60000000000036380.20000000000072760.40000000000145520.80000000000291040.60000000000582080.200000000011641530.400000000023283060.80000000004656610.60000000009313230.200000000186264510.400000000372529030.80000000074505810.60000000149011610.200000002980232240.40000000596046450.8000000119209290.60000002384185790.200000047683715820.400000095367431640.80000019073486330.60000038146972660.200000762939453120.400001525878906250.80000305175781250.6000061035156250.200012207031250.40002441406250.8000488281250.600097656250.20019531250.4003906250.800781250.60156250.2031250.406250.81250.6250.250.51.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.01.0 å‚»çœ¼äº†æ²¡ï¼Ÿ ä¸ºä»€ä¹ˆä½ è‚¯å®šä¸æ•¢ç›¸ä¿¡è‡ªå·±çš„çœ¼ç›ã€‚è¿™åœ¨æ•°å­¦ä¸Šæ˜¯æ— æ³•è§£é‡Šï¼Œè¯´ä¸é€šçš„å•Šï¼Ÿ å…¶å®žï¼ŒçŽ°å®žå°±æ˜¯è¿™ä¹ˆæ®‹é…·ï¼Œè¿™æ˜¯çŽ°ä»£è®¡ç®—æœºçš„èƒ½åŠ›å’Œé™åˆ¶ã€‚æœ€æ ¹æœ¬çš„åŽŸå› ï¼šè®¡ç®—æœºçœ¼ä¸­çš„æ•°å­¦ï¼Œè·Ÿæˆ‘ä»¬å­¦çš„æ•°å­¦ä¸ä¸€æ ·ã€‚ æˆ‘ä»¬å­¦ä¹ çš„æ•°å­¦ä¸­çš„æ•°ï¼Œæ˜¯æ— é™çš„ã€æ˜¯è¿žç»­çš„ï¼›è€Œè®¡ç®—æœºèƒ½å¤Ÿå­˜å‚¨å’Œè¡¨ç¤ºçš„æ•°ï¼Œæ˜¯æœ‰é™çš„ã€ç¦»æ•£çš„ã€‚ ä¸Šå›¾å°±æ˜¯è®¡ç®—æœºä¸­å­˜å‚¨æµ®ç‚¹æ•°çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°åŒ…æ‹¬äº†ç¬¦å·ï¼ˆsignï¼‰ã€æ•°å€¼ï¼ˆmantissaï¼‰å’ŒæŒ‡æ•°ï¼ˆexponentï¼‰ä¸‰éƒ¨åˆ†ã€‚å¤§å®¶éƒ½çŸ¥é“ï¼Œè®¡ç®—æœºä¸­çš„å°æ•°å¸¸ç”¨floatæ¥è¡¨ç¤ºï¼Œè€Œfloat32ã€float64åˆ†åˆ«ä»£è¡¨è¿™è¿™ä¸ªå°æ•°çš„ç²¾åº¦ã€‚å› æ­¤ï¼Œ1.2-1åœ¨è®¡ç®—æœºä¸­å¹¶éžç²¾ç¡®çš„0.2ã€‚ä¸ä¿¡ä½ å†è¯•è¯•: 121.2 - 10.19999999999999996 ä»¥æœ‰é™è¡¨ç¤ºæ— é™ã€ä»¥ç¦»æ•£è¡¨ç¤ºè¿žç»­ï¼Œéš¾å…ä¼šé€ æˆè¯¯å·®ã€‚å½“æˆ‘ä»¬è®¡ç®—çš„æ¬¡æ•°éžå¸¸å¤šæ—¶ï¼Œè¯¯å·®ä¸æ–­ç´¯ç§¯ï¼Œç»“æžœå°±ä¼šå—è¾•åŒ—è¾™ã€‚ æ€Žä¹ˆåŠžåœ¨æ™®é€šçš„è®¡ç®—æœºç¨‹åºé‡Œé¢ï¼Œè¿™ç§æƒ…å†µè¿˜å¥½ï¼Œå› ä¸ºå¾ˆå¤šéƒ½æ˜¯æ•´æ•°è®¡ç®—ï¼Œå³ä½¿æ˜¯å°æ•°è®¡ç®—ï¼Œåªè¦è®¡ç®—æ¬¡æ•°ä¸å¤šï¼Œå››èˆäº”å…¥ä»¥åŽä¹Ÿçœ‹ä¸å‡ºé—®é¢˜ã€‚ ä½†æ˜¯ï¼Œåœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­ï¼Œå°±ä¸æ˜¯è¿™æ ·äº†ã€‚æ¯”å¦‚æ·±åº¦å­¦ä¹ çš„åŸºç¡€ - éšæœºæ¢¯åº¦ä¸‹é™ï¼Œå°±æ˜¯å„ç§å°æ•°ã€å¾®åˆ†ã€ä¸æ–­è¿­ä»£ã€‚ å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæœ‰ä¸ªä¸“é—¨çš„å­¦ç§‘ - æ•°å€¼æ–¹æ³•ã€‚ æ•°å€¼æ–¹æ³•ï¼ˆnumerical methodï¼Œä¹Ÿç§°è®¡ç®—æ–¹æ³•ã€æ•°å€¼åˆ†æžç­‰ï¼‰æ˜¯åˆ©ç”¨è®¡ç®—æœºè¿›è¡Œæ•°å€¼è®¡ç®—æ¥è§£å†³æ•°å­¦é—®é¢˜çš„æ–¹æ³•ï¼Œå…¶ç ”ç©¶å†…å®¹åŒ…æ‹¬æ•°å€¼æ–¹æ³•çš„ç†è®ºã€åˆ†æžã€æž„é€ åŠç®—æ³•ç­‰ã€‚å¾ˆå¤šç§‘å­¦ä¸Žå·¥ç¨‹é—®é¢˜éƒ½å¯å½’ç»“ä¸ºæ•°å­¦é—®é¢˜ï¼Œè€Œæ•°å€¼æ–¹æ³•å¯¹å¾ˆå¤šåŸºæœ¬æ•°å­¦é—®é¢˜å»ºç«‹äº†æ•°å€¼è®¡ç®—çš„è§£å†³ åŠžæ³•ï¼Œä¾‹å¦‚çº¿æ€§ä»£æ•°æ–¹ç¨‹ç»„çš„æ±‚è§£ã€å¤šé¡¹å¼æ’å€¼ã€å¾®ç§¯åˆ†å’Œå¸¸å¾®åˆ†æ–¹ç¨‹çš„æ•°å€¼è§£æ³•ç­‰ç­‰ã€‚ é€šè¿‡æ•°å€¼æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šçš„â€œæ•°å€¼ç¨³å®šæ€§ (Numerical Stability)â€ï¼Œå³å°†è¯¯å·®æŽ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ã€‚å…·ä½“æ“ä½œåŒ…æ‹¬é¿å…é™¤ä»¥è¶‹è¿‘äºŽé›¶çš„æ•°ï¼Œæˆ–è€…é¿å…éžå¸¸å¤šçš„å°æ•°è¿žç»­ç›¸ä¹˜ã€‚ åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¸ºä»€ä¹ˆéžå¸¸å¤šçš„é«˜æ‰‹å–œæ¬¢ç”¨logï¼Œå°±æœ‰å› ä¸ºlogæ“ä½œèƒ½å¤Ÿæœ‰è¿™æ–¹é¢çš„åŠŸæ•ˆã€‚ æˆ‘ä»¬éƒ½çŸ¥é“åœ¨æ•°å­¦ä¸Šlogæœ‰ä¸ªéžå¸¸é‡è¦çš„æ€§è´¨: å³å¯ä»¥æŠŠä¹˜æ³•å˜æˆåŠ æ³•ã€‚è¯•æƒ³ä¸‹ï¼Œå¦‚æžœxå’Œyéƒ½æ˜¯æ¯”è¾ƒå°çš„å°æ•°ï¼Œè¿žç»­ç›¸ä¹˜åŠ¿å¿…ä¼šéžå¸¸å½±å“è®¡ç®—ç²¾åº¦ï¼Œè€Œè½¬åŒ–æˆåŠ æ³•åŽï¼Œå°±å¯ä»¥æŠŠè¯¯å·®æŽ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ã€‚ æ‰€ä»¥è¯´ï¼Œè¦æžå¥½AIï¼Œä¸å…‰æ•°å­¦åŠŸåº•è¦è¿‡ç¡¬ï¼Œè®¡ç®—æœºå·¥ç¨‹ä¹ŸåŒç­‰é‡è¦ã€‚ æ€»ç»“æˆ‘ä»¬å¹³æ—¶åšç®—æ³•å·¥ä½œæ—¶ï¼Œåœ¨æ•°å­¦ä¸ŠæŽ¨å¯¼å‡ºäº†å…¬å¼ï¼ŒæŠŠå…¬å¼è½¬åŒ–æˆè®¡ç®—æœºç¨‹åºï¼Œåˆ‡è®°è¦æœ‰æ•°å€¼æ–¹æ³•çš„æ€ç»´ï¼Œé‡‡ç”¨å„ç§æ“ä½œæ¥å‡å°‘è¯¯å·®ï¼Œå› ä¸ºï¼Œè®¡ç®—æœºçœ¼ä¸­çš„æ•°å­¦è·Ÿä½ çœ¼ä¸­çš„ä¸ä¸€æ ·ã€‚]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨numpyæ¥ç†è§£PCAå’ŒSVD]]></title>
    <url>%2Fposts%2Fnumpy-pca-svd%2F</url>
    <content type="text"><![CDATA[å‰è¨€çº¿æ€§ä»£æ•°æ˜¯é«˜ç­‰æ•°å­¦é‡Œé¢éžå¸¸é‡è¦çš„ä¸€é—¨è¯¾ç¨‹ï¼Œå¯æƒœåœ¨å­¦æ ¡çš„æ—¶å€™æ˜¯ä¸€ç§è‡ªåº•å‘ä¸Šçš„å­¦ä¹ æ–¹å¼ï¼Œå¹¶ä¸çŸ¥é“å­¦å‡ºæ¥æœ‰ä»€ä¹ˆç”¨ï¼Œä»¥è‡´å½»åº•æ²¦ä¸ºåº”è¯•æ•™è‚²ã€‚åŽæ¥åœ¨å·¥ä½œä¸­æŽ¥è§¦äº†æœºå™¨å­¦ä¹ ï¼Œæ‰çœŸæ­£çœ‹åˆ°äº†â€œæ•°å­¦ä¹‹ç¾Žâ€ï¼Œæ‰å‘çŽ°çº¿æ€§ä»£æ•°æ˜¯å¤šä¹ˆçš„ä¼˜é›…å¤šä¹ˆçš„æœ‰ç”¨ã€‚ ä»Šå¤©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹çº¿æ€§ä»£æ•°ä¸­éžå¸¸é‡è¦çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹å¥‡å¼‚å€¼åˆ†è§£SVD Singular value decompositionã€‚SVDåœ¨æ•°æ®ç§‘å­¦å½“ä¸­éžå¸¸æœ‰ç”¨ï¼Œå…¶å¸¸è§çš„åº”ç”¨åŒ…æ‹¬ï¼š è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Latent Semantic Analysis æŽ¨èç³»ç»Ÿä¸­çš„Collaborative Filtering é™ç»´å¸¸ç”¨å¥—è·¯Principal Component Analysis LSAå·²ç»åœ¨å‰æ–‡ä¸­æœ‰æ‰€è®²è§£ï¼ŒCFçš„è¯åŽé¢åœ¨æŽ¨èç³»ç»Ÿçš„ä¸“é¢˜ä¸­æ¥å†™ï¼Œä»Šå¤©ä¸»è¦èŠèŠPCAï¼Œä»¥åŠSVDåœ¨PCAä¸­çš„é‡è¦ä½œç”¨ã€‚åŒæ ·å»¶ç»­æˆ‘ä»¬â€œæ‰‹æ’•â€çš„ä¼ ç»Ÿï¼Œä½¿ç”¨numpyæ¥ç†è§£å…¶ä¸­çš„åŽŸç†ã€‚ PCAPrincipal component analysiså³ä¸»æˆåˆ†åˆ†æžï¼Œæ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ç§éžå¸¸å¸¸ç”¨çš„é™ç»´æ–¹å¼ã€‚å…¶å‘æºä¹Ÿæ˜¯æºè‡ªäºŽæ—©æœŸçš„è®¡ç®—æœºå¤„ç†èƒ½åŠ›æœ‰é™ï¼Œå½“æ•°æ®æ ·æœ¬çš„ç»´åº¦å¾ˆé«˜æ—¶ï¼Œé¢„å…ˆåŽ»é™¤æŽ‰æ•°æ®ä¸­çš„ä¸€äº›å†—ä½™ä¿¡æ¯å’Œå™ªå£°ï¼ˆé™ç»´ï¼‰ï¼Œä½¿å¾—æ•°æ®å˜å¾—æ›´åŠ ç®€å•é«˜æ•ˆï¼ŒèŠ‚çœæ—¶é—´å’Œæˆæœ¬ã€‚ åœ¨æ·±åº¦å­¦ä¹ æ—¶ä»£ï¼Œæ›´å¼ºè°ƒçš„æ˜¯åŽŸå§‹æ•°æ®çš„ç›´æŽ¥è¾“å…¥ï¼Œå†é€šè¿‡ç¥žç»ç½‘ç»œæ¥åšé™ç»´å·¥ä½œï¼Œæœ€å…¸åž‹æ˜¯åœºæ™¯å°±æ˜¯è®¡ç®—æœºè§†è§‰ï¼Œç›´æŽ¥è¾“å…¥åŽŸå§‹å›¾ç‰‡åƒç´ ä¿¡æ¯ï¼Œé€šè¿‡CNNå·ç§¯å±‚ã€MaxPoolingå±‚æ¥è¿›è¡Œé™ç»´ã€‚å› æ­¤PCAé€æ¸å¼€å§‹æ·¡å‡ºäººä»¬çš„è§†çº¿ï¼Œé€šå¸¸æ˜¯ä½œä¸ºä¸€ç§æ•°æ®å¯è§†åŒ–çš„æ‰‹æ®µï¼ˆäºŒç»´å›¾è¡¨æ— æ³•å±•ç¤ºå¤šç»´çš„æ•°æ®æ ·æœ¬ï¼‰ã€‚ å…¶å®žï¼Œåœ¨æ·±åº¦å­¦ä¹ ç›®å‰å°šæœªå…¨é¢æ”»å…‹çš„ç»“æž„åŒ–æ•°æ®é¢†åŸŸï¼ŒPCAä»ç„¶æœ‰è¾ƒå¤šçš„ç”¨ï¼Œå…¶æ•°æ®å¤„ç†çš„æ€è·¯ä¾ç„¶å€¼å¾—æˆ‘ä»¬åŽ»å­¦ä¹ æ£æ‘©ã€‚ PCAæ­£å¸¸è§£æ³•PCAç®—æ³•çš„æœ¬è´¨ï¼Œå…¶å®žå°±æ˜¯æ‰¾åˆ°ä¸€äº›æŠ•å½±æ–¹å‘ï¼Œä½¿å¾—æ•°æ®åœ¨è¿™äº›æŠ•å½±æ–¹å‘ä¸Šçš„æ–¹å·®æœ€å¤§ï¼Œä¸”è¿™äº›æŠ•å½±æ–¹å‘æ˜¯ç›¸äº’æ­£äº¤çš„ã€‚æ‰¾åˆ°æ–°çš„æ­£äº¤åŸºåŽï¼Œè®¡ç®—åŽŸå§‹æ•°æ®åœ¨è¿™äº›æ­£äº¤åŸºä¸ŠæŠ•å½±çš„æ–¹å·®ï¼Œæ–¹å·®è¶Šå¤§ï¼Œå°±è¯´æ˜Žå¯¹åº”æ­£äº¤åŸºä¸ŠåŒ…å«äº†æ›´å¤šçš„ä¿¡æ¯é‡ã€‚ å…³äºŽåŽŸå§‹æ•°æ®çš„æ–¹å·®ï¼Œæœ€å¥½çš„ä¸€ä¸ªå·¥å…·å°±æ˜¯åæ–¹å·®çŸ©é˜µäº†ã€‚åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼è¶Šå¤§ï¼Œå¯¹åº”çš„æ–¹å·®ä¹Ÿå°±è¶Šå¤§ï¼Œåœ¨å¯¹åº”çš„ç‰¹å¾å‘é‡ä¸ŠæŠ•å½±çš„ä¿¡æ¯é‡å°±è¶Šå¤§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¦‚æžœå°†å°ç‰¹å¾å€¼å¯¹åº”æ–¹å‘çš„æ•°æ®åˆ é™¤ï¼Œå°±å¯ä»¥è¾¾åˆ°é™ç»´çš„ç›®çš„ã€‚å› æ­¤ï¼Œåœ¨æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé—®é¢˜è½¬åŒ–ä¸ºæ±‚åŽŸå§‹æ•°æ®çš„åæ–¹å·®çŸ©é˜µï¼Œç„¶åŽè®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼ä¸Žç‰¹å¾å‘é‡ã€‚ å¯¹äºŽå¹¿å¤§ç¨‹åºå‘˜æ¥è¯´ï¼Œå­¦ä¹ æœºå™¨å­¦ä¹ æœ€é‡è¦çš„ä¸€ä¸ªåŽè¿˜æ˜¯æ•°å­¦ã€‚å¾ˆå¤šå®žé™…çš„ä»£ç å…¶å®žæ˜¯å…¬å¼æŽ¨å¯¼åŽçš„ç»“æžœçš„ä»£ç å®žçŽ°ï¼Œå¦‚æžœæ²¡æœ‰ç†æ¸…å…¬å¼æŽ¨å¯¼çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆæœ€åŽè‚¯å®šæ˜¯ä¸€å¤´é›¾æ°´ã€‚æ‰€ä»¥ï¼Œå…‹æœå¿ƒä¸­çš„ææƒ§ï¼Œç¿»å‡ºåŽ‹åœ¨ç®±åº•çš„ã€Šçº¿æ€§ä»£æ•°ã€‹ï¼Œæˆ‘ä»¬ä¸Šã€‚ é¦–å…ˆï¼Œæ±‚åŽŸå§‹æ•°æ®Xçš„åæ–¹å·®çŸ©é˜µCï¼Œå°†åŽŸå§‹çŸ©é˜µä¸­å¿ƒåŒ–åŽï¼Œåšå¦‚ä¸‹æ“ä½œ æŽ¥ç€ï¼Œç”±äºŽåæ–¹å·®çŸ©é˜µCæ˜¯æ–¹é˜µï¼Œå°±å¯ä»¥é€šè¿‡ç‰¹å¾åˆ†è§£çš„æ–¹å¼æ¥æ±‚Cçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€‚ æœ€åŽï¼Œé€‰æ‹©æœ€å¤§çš„kä¸ªç‰¹å¾å€¼è¿›è¡Œä¿ç•™ï¼Œæ±‚Xçš„ké˜¶PCAï¼ˆXå³ä¹˜ké˜¶ç‰¹å¾å‘é‡ï¼‰ ç”¨SVDæ¥è§£PCAæ ¹æ®ä¸Šé¢çš„æŽ¨å¯¼ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å¯¹çŸ©é˜µXåšPCAäº†ã€‚åŒå­¦ä»¬å¯èƒ½è¦é—®äº†ï¼Œè¿™è·ŸSVDæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ å·¥ç¨‹åŒ–æ€ç»´å¼ºçš„åŒå­¦åº”è¯¥å·²ç»æƒ³åˆ°äº†ï¼Œè¿™ç§çº¯æ•°å­¦çš„è§£æ³•ï¼Œåœ¨å®žé™…å·¥ç¨‹å®žè·µä¸­æœ‰ä»¥ä¸‹é—®é¢˜ï¼š åœ¨æ•°æ®é‡å¾ˆå¤§æ—¶ï¼ŒæŠŠåŽŸå§‹çŸ©é˜µè¿›è¡Œè½¬ç½®æ±‚åæ–¹å·®çŸ©é˜µï¼Œç„¶åŽå†è¿›è¡Œç‰¹å¾å€¼åˆ†è§£æ˜¯ä¸€ä¸ªéžå¸¸æ…¢çš„è¿‡ç¨‹ã€‚ ç¨³å®šæ€§é—®é¢˜ã€‚å¯ä»¥çœ‹åˆ°Xè½¬ç½®ä¹˜ä»¥Xï¼Œå¦‚æžœçŸ©é˜µæœ‰éžå¸¸å°çš„æ•°ï¼Œå¾ˆå®¹æ˜“åœ¨å¹³æ–¹ä¸­ä¸¢å¤±ã€‚ å·¥ä¸šç•Œä¸­ï¼Œè¿˜æ˜¯â€œå”¯å¿«ä¸ç ´ï¼Œå”¯ç¨³ä¸ç ´â€ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¥‡å¼‚å€¼åˆ†è§£ç›¸å¯¹ç‰¹å¾åˆ†è§£ï¼Œæœ‰ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿å°±æ˜¯ä¸è¦æ±‚åŽŸå§‹çŸ©é˜µæ˜¯æ–¹é˜µã€‚è¿™éžå¸¸ç¬¦åˆçŽ°å®žç”Ÿæ´»ä¸­çš„æ•°æ®ã€‚å› æ­¤ï¼Œæœ‰å¤§ç¥žæƒ³åˆ°ï¼Œæ˜¯å¦å¯ä»¥ç”¨svdæ¥è§£PCAï¼ŸæŽ¨å¯¼å¦‚ä¸‹ï¼š æˆ‘ä»¬æ ¹æ®åæ–¹å·®çŸ©é˜µçš„å…¬å¼ï¼ŒæŠŠXæŒ‰ç…§å¥‡å¼‚å€¼åˆ†è§£å±•å¼€ï¼Œæ³¨æ„åŽé¢åº”ç”¨åˆ°äº†ä¸€ä¸ªé…‹çŸ©é˜µ(unitary)çš„ç‰¹æ€§ï¼š çœ‹åˆ°æœ€åŽçš„ç»“æžœï¼Œæ˜¯å¦è·Ÿä¸Šé¢çš„ å¾ˆåƒï¼Ÿæ²¡é”™ã€‚åæ–¹å·®çŸ©é˜µCçš„ç‰¹å¾å€¼å’ŒXçš„å¥‡å¼‚å€¼æœ‰ä»¥ä¸‹å…³ç³» è€ŒCçš„ç‰¹å¾å‘é‡å³ä¸ºXçš„SVDåˆ†è§£åŽçš„Vå‘é‡, åˆ™å‚è€ƒPCAæ­£å¸¸è§£æ³•ï¼ŒXçš„ké˜¶PCAå³ä¸º_Xå³ä¹˜ké˜¶Vå‘é‡_ã€‚å› æ­¤è¿™ç§æ–¹å¼æ±‚PCAï¼Œåªéœ€è¦æŠŠåŽŸå§‹çŸ©é˜µåšä¸€æ¬¡SVDåˆ†è§£å³å¯ï¼Œä¸ç”¨è½¬ç½®ï¼Œä¸ç”¨æ±‚åæ–¹å·®çŸ©é˜µã€‚äº‹å®žä¸Šï¼Œåœ¨Scikit Learnç­‰æœºå™¨å­¦ä¹ æ¡†æž¶ä¸­ï¼Œå°±æ˜¯ç”¨çš„SVDæ¥åšPCAã€‚ ç”¨numpyæ¥éªŒè¯numpyåŽŸå§‹è§£æ³•æ±‚PCAæŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨numpyæ¥éªŒè¯è¿™ç§æ€è·¯ã€‚é¦–å…ˆæ˜¯PCAçš„æ ‡å‡†è§£æ³•ï¼š éšæœºæ¨¡æ‹Ÿä¸€ä¸ªåŽŸå§‹æ•°æ®çŸ©é˜µï¼Œ5ä¸ªæ ·æœ¬ï¼Œ3ä¸ªç‰¹å¾ï¼š 123456789import numpy as npX = np.random.rand(5,3)'''array([[0.86568791, 0.73022945, 0.17982869], [0.07201287, 0.99358411, 0.84389196], [0.61267696, 0.08867997, 0.11770573], [0.16898969, 0.3093472 , 0.9010064 ], [0.43840269, 0.97250927, 0.64897872]])''' å°†çŸ©é˜µä¸­å¿ƒåŒ–ï¼Œå³å‡åŽ»å‡å€¼ï¼š 12345678910X_new = X - np.mean(X, axis=0)'''array([[ 0.43413389, 0.11135945, -0.35845361], [-0.35954115, 0.37471411, 0.30560966], [ 0.18112294, -0.53019003, -0.42057657], [-0.26256433, -0.3095228 , 0.3627241 ], [ 0.00684866, 0.35363927, 0.11069642]])'''# ç¡®ä¿ç»“æžœæ­£ç¡®ï¼Œå³è½¬æ¢åŽå‡å€¼ä¸º0np.allclose(X_new.mean(axis=0), np.zeros(X_new.shape[1])) æ±‚X_newçš„åæ–¹å·®çŸ©é˜µC 1234567C = np.dot(X_new.T, X_new) / (X_new.shape[0] - 1)'''Carray([[ 0.10488363, -0.02467955, -0.10903811], [-0.02467955, 0.16369454, 0.05611495], [-0.10903811, 0.05611495, 0.13564834]])''' æ±‚Cçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œè¿™é‡Œç”¨çš„æ˜¯numpyçš„ç‰¹å¾åˆ†è§£å‡½æ•° 123456789eig_vals, eig_vecs = np.linalg.eig(C)'''eig_valsarray([0.26474535, 0.00779743, 0.13168373])eig_vecsarray([[-0.53801107, 0.72610049, -0.42816139], [ 0.50584138, -0.12820944, -0.85304562], [ 0.67429117, 0.67552974, 0.29831358]])''' æ±‚Xçš„PCAç»“æžœï¼Œå°±æ˜¯Xå³ä¹˜ké˜¶ç‰¹å¾å‘é‡ã€‚è¿™é‡Œkè¿˜æ˜¯å–çš„3ã€‚ 12345678X_pca = np.dot(X_new, eig_vecs)'''array([[-0.41894072, 0.05880142, -0.38780564], [ 0.58905292, -0.10265648, -0.07453908], [-0.64922927, -0.08462316, 0.24926273], [ 0.22927473, 0.09406657, 0.4846625 ], [ 0.24984234, 0.03441165, -0.27158052]])''' numpyçš„SVDæ±‚PCAé¦–å…ˆï¼Œç›´æŽ¥æ±‚X_newçš„SVDï¼ŒåŒæ ·ä½¿ç”¨numpyçš„å‡½æ•° 12345678910111213141516# æ³¨æ„è¿™é‡Œçš„Vhå…¶å®žæ˜¯å…¬å¼ä¸­çš„VTU, Sigma, Vh = np.linalg.svd(X_new, full_matrices=False, compute_uv=True)'''Uarray([[-0.40710685, 0.53434046, 0.33295236, 0.59843699, -0.28241844], [ 0.57241386, 0.10270414, -0.58127362, 0.5471169 , -0.15677466], [-0.63089041, -0.34344824, -0.47916326, 0.32579597, 0.38507162], [ 0.22279838, -0.66779531, 0.53263483, 0.46842625, 0.03587876], [ 0.24278501, 0.37419895, 0.19484969, 0.13026931, 0.86376738]])Sigmaarray([1.02906823, 0.72576506, 0.17660612])Vharray([[-0.53801107, 0.50584138, 0.67429117], [ 0.42816139, 0.85304562, -0.29831358], [ 0.72610049, -0.12820944, 0.67552974]])''' æˆ‘ä»¬æ¥æ ¹æ®ä¸Šé¢çš„å…¬å¼ï¼Œç¡®è®¤ä¸‹eig_valså’ŒSçš„å…³ç³»ï¼Œæ³¨æ„åœ¨numpyçš„å®žçŽ°ä¸­ï¼Œç‰¹å¾å€¼å’Œå¥‡å¼‚å€¼çš„æŽ’åºæ˜¯ä¸åŒçš„ 1234567np.allclose(eig_vals, np.square(S) / (X_new.shape[0] - 1))'''eig_valsarray([0.26474535, 0.00779743, 0.13168373])np.square(S) / (X_new.shape[0] - 1)array([0.26474535, 0.13168373, 0.00779743])''' ä»Žç»“æžœçœ‹å‡ºï¼Œç¡®å®žè·Ÿå…¬å¼æ˜¯ä¸€è‡´çš„ã€‚ æŽ¥ä¸‹æ¥ç”¨SVDæ±‚PCAå°±ç®€å•äº†ï¼Œç›´æŽ¥å³ä¹˜Vå³å¯ã€‚ 1234567891011# æ³¨æ„Vhæ˜¯å…¬å¼ä¸­çš„VTï¼Œå› æ­¤V=Vh.TX_pca_svd = np.dot(X_new, Vh.T)# X_pca_svd = np.dot(U, np.diag(Sigma))'''X_pca_svdarray([[-0.41894072, 0.38780564, 0.05880142], [ 0.58905292, 0.07453908, -0.10265648], [-0.64922927, -0.24926273, -0.08462316], [ 0.22927473, -0.4846625 , 0.09406657], [ 0.24984234, 0.27158052, 0.03441165]])''' æ±‚å‡ºç»“æžœåŽï¼Œæ­£å½“æˆ‘ä»¬ä¿¡å¿ƒæ»¡æ»¡çš„å¯¹æ¯”ä¸€ä¸‹X_pcaå’ŒX_pca_svd,ä»¥ä¸ºå¤§åŠŸå‘Šæˆæ‰“å®Œæ”¶å·¥æ—¶ï¼Œå´å‘çŽ°äºŒè€…æ˜¯ä¸ä¸€è‡´çš„ã€‚WTFï¼Ÿ ç»“æžœåˆ†æžä»”ç»†ç ”ç©¶ä¸‹X_pcaå’ŒX_pca_svdçš„ç»“æžœï¼Œå¯ä»¥çœ‹å‡ºï¼ŒæŽ’é™¤ç‰¹å¾å€¼å’Œå¥‡å¼‚å€¼çš„æŽ’åºå¯¼è‡´çš„åˆ—å‘é‡é¡ºåºä¸åŒå¤–ï¼Œéƒ¨åˆ†åˆ—å‘é‡çš„ç»å¯¹å€¼ç›¸åŒä½†æ­£è´Ÿä¸åŒã€‚ é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿæˆ‘ä»¬æ¬å‡ºScikit Learnï¼Œå†æ¥ç®—ä¸€æ¬¡PCAï¼š 1234567891011from sklearn.decomposition import PCApca = PCA(3)pca.fit_transform(X) # sklearnè‡ªåŠ¨å¤„ç†åŽ»å‡å€¼åŒ–'''array([[ 0.41894072, -0.38780564, -0.05880142], [-0.58905292, -0.07453908, 0.10265648], [ 0.64922927, 0.24926273, 0.08462316], [-0.22927473, 0.4846625 , -0.09406657], [-0.24984234, -0.27158052, -0.03441165]])''' å—¯ï¼Œä¹Ÿæ˜¯ç»å¯¹å€¼ç›¸åŒä½†æ­£è´Ÿä¸åŒã€‚éƒ½è¯´Scikit Learnçš„PCAå°±æ˜¯SVDåšçš„ï¼Œéš¾é“æ˜¯éª—äººçš„ï¼Ÿ å¥½åœ¨ä»£ç ä¸ä¼šéª—äººï¼Œæˆ‘ä»¬ç›´æŽ¥ç¿»å‡ºæºç ã€‚ é€šè¿‡ç ”ç©¶Scikit Learnçš„æºç svd_flip@scikit-learn/extmath.pyæ‰¾åˆ°äº†ç­”æ¡ˆï¼š SVDå¥‡å¼‚å€¼åˆ†è§£çš„ç»“æžœæ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯åˆ†è§£å‡ºæ¥çš„UçŸ©é˜µå’ŒVçŸ©é˜µçš„æ­£è´Ÿå¯ä»¥ä¸æ˜¯å”¯ä¸€ï¼Œåªè¦ä¿è¯å®ƒä»¬ä¹˜èµ·æ¥æ˜¯ä¸€è‡´çš„å°±è¡Œã€‚å› æ­¤ï¼Œsklearnä¸ºäº†ä¿è¯svdåˆ†è§£ç»“æžœçš„ä¸€è‡´æ€§ï¼Œå®ƒä»¬çš„æ–¹æ¡ˆæ˜¯ï¼šä¿è¯UçŸ©é˜µçš„æ¯ä¸€è¡Œ(u_i)ä¸­ï¼Œç»å¯¹å€¼æœ€å¤§çš„å…ƒç´ ä¸€å®šæ˜¯æ­£æ•°ï¼Œå¦åˆ™å°†u_iè½¬æˆ-u_i,å¹¶å°†ç›¸åº”çš„v_iè½¬æˆ-v_iå·²ä¿è¯ç»“æžœçš„ä¸€è‡´ã€‚ è¿™åˆæ˜¯æ•°å­¦ä¸Žå·¥ç¨‹çš„é—®é¢˜äº†ã€‚åœ¨æ•°å­¦ä¸Šï¼Œå‡ ç§ç»“æžœéƒ½æ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯åœ¨å·¥ç¨‹ä¸Šï¼Œæœ‰ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§å«å¹‚ç­‰æ€§(Idempotence)ã€‚ Methods can also have the property of â€œidempotenceâ€ in that (aside from error or expiration issues) the side-effects of N &gt; 0 identical requests is the same as for a single request. è¿™æ˜¯æºè‡ªäºŽHTTPè§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå¯ä»¥å¼•ç”³è‡³å„ç§åˆ†å¸ƒå¼æœåŠ¡çš„è®¾è®¡å½“ä¸­ï¼Œå³ï¼šé«˜è´¨é‡çš„æœåŠ¡ï¼Œä¸€æ¬¡è¯·æ±‚å’Œå¤šæ¬¡è¯·æ±‚ï¼Œå…¶å‰¯ä½œç”¨ï¼ˆç»“æžœï¼‰åº”å½“æ˜¯ä¸€è‡´çš„ã€‚Scikit Learnæ­£æ˜¯é€šè¿‡svd_flipè¿™ä¸ªå‡½æ•°ï¼ŒæŠŠä¸€ä¸ªæ•°å­¦ä¸Šå¹¶ä¸å¹‚ç­‰çš„æ“ä½œï¼Œè½¬åŒ–æˆäº†å¹‚ç­‰çš„æœåŠ¡ï¼Œå…¶è®¾è®¡ä¹‹è®²ç©¶å¯è§ä¸€æ–‘ã€‚ æ€»ç»“æœ¬æ–‡é€šè¿‡å…¬å¼æŽ¨å¯¼å’Œnumpyä»£ç å®žæˆ˜ï¼Œå±•ç¤ºäº†PCAçš„æ­£å¸¸è§£æ³•ï¼Œä»¥åŠå·¥ä¸šç•Œå¸¸ç”¨çš„SVDè§£æ³•ï¼Œå¹¶æœ€åŽå¼•ç”³è‡³æ•°å­¦å’Œå®žçŽ°çš„ä¸€äº›æŽ¢è®¨ã€‚â€œpart-science, part-artâ€ï¼Œè¿™å°±æ˜¯æˆ‘æœ€å–œçˆ±çš„æœºå™¨å­¦ä¹ ä¹‹é“]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>SVD</tag>
        <tag>PCA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kerasä¸­return_sequenceså’Œreturn_stateæœ‰ä»€ä¹ˆç”¨ï¼Ÿ]]></title>
    <url>%2Fposts%2Fkeras-return-sequences-return-state%2F</url>
    <content type="text"><![CDATA[Photo by Jon Tyson on Unsplash å‰è¨€CNNå’ŒRNNï¼Œä½œä¸ºæ·±åº¦å­¦ä¹ çš„ä¸¤å¤§æŠ¤æ³•ï¼Œä¿ƒè¿›äº†æ·±åº¦å­¦ä¹ è¿‘å‡ å¹´åœ¨Computer Visionã€NLPç­‰é¢†åŸŸå¸­å·å…¨ä¸–ç•Œã€‚ç›¸æ¯”CNNï¼ŒRNNå…¶å®žæ›´ä¸ºâ€œéª¨éª¼ç²¾å¥‡â€ï¼Œå®ƒå¼€åˆ›æ€§çš„é€’å½’ç½‘ç»œç»“æž„ï¼Œè®©æ¨¡åž‹å…·æœ‰äº†â€œè®°å¿†â€ï¼Œä½¿å¾—æˆ‘ä»¬å‘ç€â€œAIâ€æ›´è¿‘äº†ä¸€æ­¥ã€‚è™½ç„¶æœ€è¿‘å„ç§Transformerç»“æž„æœ‰äº†è¶…è¶ŠRNNä¹‹åŠ¿ï¼Œä½†æ˜¯æˆ‘ä¾ç„¶è§‰å¾—RNNæ˜¯éžå¸¸å€¼å¾—å­¦ä¹ å’Œå‘å±•çš„ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬ä»¥LSTMä¸ºä¾‹ï¼Œæ¥è°ˆä¸€ä¸ªRNNä¸­çš„ä¸€ä¸ªå…·ä½“çš„é—®é¢˜ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Kerasçš„LSTMå®žçŽ°ä¸­ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°return_sequenceså’Œreturn_stateã€‚è¿™ä¸¤ä¸ªå‚æ•°çš„å®žé™…æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šç”¨åˆ°å‘¢ï¼Ÿ PSï¼šKerasæ˜¯æˆ‘æœ€å–œçˆ±çš„æ·±åº¦å­¦ä¹ æ¡†æž¶äº†ï¼Œå…¶APIçš„è®¾è®¡éžå¸¸ç²¾å¦™å’Œä¼˜é›…ï¼ŒFranÃ§ois Cholletæ˜¯ä¸æ„§æ˜¯å¤§å¸ˆä¸­çš„å¤§å¸ˆã€‚ç›¸æ¯”ä¼ ç»Ÿçš„Tensorflowå’ŒPyTorchï¼ŒKerasçš„APIæ‰æ˜¯çœŸæ­£çš„â€œDeep Learning for Humanâ€ã€‚å¦å¤–ï¼Œçœ‹åˆ°Tensorflow 2.0ä¹Ÿå¼€å§‹ä»¥tf.kerasä½œä¸ºç¬¬ä¸€å…¬æ°‘ï¼Œæˆ‘éžå¸¸æ¬£æ…°ã€‚å…³äºŽæˆ‘å¯¹è¿™å‡ ä¸ªæ¡†æž¶çš„ç†è§£ï¼ŒåŽé¢å†ä»¥ä¸“é¢˜æ–‡ç« å’Œå¤§å®¶åˆ†äº«ã€‚ LSTMä»‹ç» Long Short Term Memory networks â€“ usually just called â€œLSTMsâ€ â€“ are a special kind of RNN, capable of learning long-term dependencies. They were introduced by Hochreiter &amp; Schmidhuber (1997) , and were refined and popularized by many people in following work.They work tremendously well on a large variety of problems, and are now widely used. LSTMæ˜¯ä¸ºäº†è§£å†³æ™®é€šRNNç½‘ç»œåœ¨å®žé™…å®žè·µä¸­å‡ºçŽ°çš„â€œæ¢¯åº¦æ¶ˆå¤±â€ç­‰é—®é¢˜è€Œå‡ºçŽ°çš„ã€‚è¿™é‡Œæˆ‘ä»¬ç•¥è¿‡é‡Œé¢çš„ç»†èŠ‚ï¼Œé‡ç‚¹çœ‹çœ‹å•ä¸ªLSTM cellçš„è¾“å…¥è¾“å‡ºæƒ…å†µã€‚ä»Žä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå•ä¸ªLSTM cellå…¶å®žæœ‰2ä¸ªè¾“å‡ºçš„ï¼Œä¸€ä¸ªæ˜¯h(t)ï¼Œä¸€ä¸ªæ˜¯c(t)ã€‚è¿™é‡Œçš„h(t)ç§°ä¸ºhidden stateï¼Œc(t)ç§°ä¸ºcell stateã€‚è¿™ä¸ªå‘½åå…¶å®žæˆ‘è®¤ä¸ºæ˜¯ä¸å¤ªå¥½çš„ã€‚ç†Ÿæ‚‰å…¨è¿žæŽ¥ç¥žç»ç½‘ç»œçš„åŒå­¦ï¼Œä¸€å®šä¼šæŠŠh(t)è·Ÿhidden layerç›¸æ··æ·†ã€‚å…¶å®žï¼Œè¿™ä¸ªh(t)æ‰æ˜¯LSTMçš„çœŸæ­£outputï¼Œc(t)æ‰æ˜¯LSTMçš„å†…éƒ¨â€éšè—â€çŠ¶æ€ã€‚ æˆ‘ä»¬è¿›ä¸€æ­¥æŠŠLSTMç½‘ç»œå±•å¼€æ¥çœ‹ã€‚æ¯ä¸€ä¸ªæ—¶é—´èŠ‚ç‚¹timestepï¼Œè¾“å…¥ä¸€ä¸ªx(t)ï¼Œcellé‡Œé¢çš„c(t)åšä¸€æ¬¡æ›´æ–°ï¼Œè¾“å‡ºh(t)ã€‚ç´§æŽ¥ç€ä¸‹ä¸€ä¸ªtimestepï¼Œx(t+1)ã€h(t)å’Œc(t)ç»§ç»­è¾“å…¥åˆ°cellï¼Œè¾“å‡ºä¸ºh(t+1)å’Œc(t+1)ï¼Œå¦‚ä¸‹å›¾ã€‚å› æ­¤ï¼ŒKerasä¸­çš„return_sequenceså’Œreturn_stateï¼Œå°±æ˜¯è·Ÿh(t)å’Œc(t)ç›¸å…³ã€‚ Return SequencesæŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥ç‚¹hands-onçš„ä»£ç ï¼Œæ¥å…·ä½“çœ‹çœ‹è¿™ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨ã€‚ å®žéªŒä¸€è¯•éªŒä»£ç ä¸­ï¼Œreturn_sequenceså’Œreturn_stateé»˜è®¤éƒ½æ˜¯falseï¼Œè¾“å…¥shapeä¸º(1,3,1)ï¼Œè¡¨ç¤º1ä¸ªbatchï¼Œ3ä¸ªtimestepï¼Œ1ä¸ªfeature 123456789101112from keras.models import Modelfrom keras.layers import Inputfrom keras.layers import LSTMfrom numpy import array# define modelinputs1 = Input(shape=(3, 1))lstm1 = LSTM(1)(inputs1)model = Model(inputs=inputs1, outputs=lstm1)# define input datadata = array([0.1, 0.2, 0.3]).reshape((1,3,1))# make and show predictionprint(model.predict(data)) è¾“å‡ºç»“æžœä¸º 1[[-0.0953151]] è¡¨ç¤ºåœ¨ç»åŽ†äº†3ä¸ªtime stepçš„è¾“å…¥åŽï¼ŒLSTMè¿”å›žçš„hidden stateï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­çš„h(t)ã€‚ç”±äºŽè¾“å‡ºçš„æ˜¯ç½‘ç»œæœ€åŽä¸€ä¸ªtimestepçš„å€¼ï¼Œå› æ­¤ç»“æžœæ˜¯ä¸€ä¸ªæ ‡é‡ã€‚ å®žéªŒäºŒæˆ‘ä»¬åŠ ä¸Šå‚æ•°return_sequences=True 1lstm1 = LSTM(1, return_sequences=True)(inputs1) è¾“å‡ºç»“æžœä¸º 123[[[-0.02243521][-0.06210149][-0.11457888]]] æˆ‘ä»¬çœ‹åˆ°ï¼Œè¾“å‡ºäº†ä¸€ä¸ªarrayï¼Œé•¿åº¦ç­‰äºŽtimestepï¼Œè¡¨ç¤ºç½‘ç»œè¾“å‡ºäº†æ¯ä¸ªtimestepçš„h(t)ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œreturn_sequenceså³è¡¨ç¤ºï¼ŒLSTMçš„è¾“å‡ºh(t)ï¼Œæ˜¯è¾“å‡ºæœ€åŽä¸€ä¸ªtimestepçš„h(t)ï¼Œè¿˜æ˜¯æŠŠæ‰€æœ‰timestepçš„h(t)éƒ½è¾“å‡ºå‡ºæ¥ã€‚åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œå…³ç³»åˆ°ç½‘ç»œçš„åº”ç”¨åœºæ™¯æ˜¯many-to-oneè¿˜æ˜¯many-to-manyï¼Œéžå¸¸é‡è¦ã€‚ Return Stateå®žéªŒä¸‰æŽ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å®žéªŒreturn_state 1lstm1, state_h, state_c = LSTM(1, return_state=True)(inputs1) è¾“å‡ºç»“æžœä¸º 123[array([[ 0.10951342]], dtype=float32), array([[ 0.10951342]], dtype=float32), array([[ 0.24143776]], dtype=float32)] æ³¨æ„ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªåˆ—è¡¨listï¼Œåˆ†åˆ«è¡¨ç¤º æœ€åŽä¸€ä¸ªtime stepçš„hidden state æœ€åŽä¸€ä¸ªtime stepçš„hidden stateï¼ˆè·Ÿä¸Šé¢ä¸€æ ·) æœ€åŽä¸€ä¸ªtime stepçš„cell stateï¼ˆæ³¨æ„å°±æ˜¯ä¸Šæ–‡ä¸­çš„c(t)ï¼‰ å¯ä»¥çœ‹å‡ºï¼Œreturn_stateå°±æ˜¯æŽ§åˆ¶LSTMä¸­çš„c(t)è¾“å‡ºä¸Žå¦ã€‚ å®žéªŒå››æˆ‘ä»¬æœ€åŽçœ‹çœ‹return_sequenceså’Œreturn_stateå…¨å¼€çš„æƒ…å†µã€‚ 1lstm1, state_h, state_c = LSTM(1, return_sequences=True, return_state=True) è¾“å‡ºç»“æžœä¸º 12345[array([[[-0.02145359], [-0.0540871 ], [-0.09228823]]], dtype=float32), array([[-0.09228823]], dtype=float32), array([[-0.19803026]], dtype=float32)] è¾“å‡ºåˆ—è¡¨çš„æ„ä¹‰å…¶å®žè·Ÿä¸Šé¢å®žéªŒä¸‰ä¸€è‡´ï¼Œåªæ˜¯ç¬¬ä¸€ä¸ªhidden state h(t)å˜æˆäº†æ‰€æœ‰timestepçš„ï¼Œå› æ­¤ä¹Ÿæ˜¯é•¿åº¦ç­‰äºŽtimestepçš„arrayã€‚ Time Distributedæœ€åŽå†è®²ä¸€è®²Kerasä¸­çš„TimeDistributedã€‚è¿™ä¸ªä¹Ÿæ˜¯åœ¨RNNä¸­éžå¸¸å¸¸ç”¨ä½†æ¯”è¾ƒéš¾ç†è§£çš„æ¦‚å¿µï¼ŒåŽŸä½œè€…è§£é‡Šè¯´ TimeDistributedDense applies a same Dense (fully-connected) operation to every timestep of a 3D tensor. å…¶å®žå®ƒçš„ä¸»è¦ç”¨é€”åœ¨äºŽMany-to-Manyï¼š æ¯”å¦‚è¾“å…¥shapeä¸º(1, 5, 1)ï¼Œè¾“å‡ºshapeä¸º(1, 5, 1) 123model = Sequential()model.add(LSTM(3, input_shape=(length, 1), return_sequences=True))model.add(TimeDistributed(Dense(1))) æ ¹æ®ä¸Šé¢è§£è¯»ï¼Œreturn_sequences=Trueï¼Œä½¿å¾—LSTMçš„è¾“å‡ºä¸ºæ¯ä¸ªtimestepçš„hidden stateï¼Œshapeä¸º(1, 5, 3) çŽ°åœ¨éœ€è¦å°†è¿™ä¸ª(1 ,5, 3)çš„3D tensorå˜æ¢ä¸º(1, 5, 1)çš„ç»“æžœï¼Œéœ€è¦3ä¸ªDense layerï¼Œåˆ†åˆ«ä½œç”¨äºŽæ¯ä¸ªtime stepçš„è¾“å‡ºã€‚è€Œä½¿ç”¨äº†TimeDistributedåŽï¼Œåˆ™æŠŠä¸€ä¸ªç›¸åŒçš„Dense layeråŽ»åˆ†åˆ«ä½œç”¨ï¼Œå¯ä»¥ä½¿å¾—ç½‘ç»œæ›´ä¸ºç´§å‡‘ï¼Œå‚æ•°æ›´å°‘çš„ä½œç”¨ã€‚ å¦‚æžœæ˜¯åœ¨many-to-oneçš„æƒ…å†µï¼Œreturn_sequence=Falseï¼Œåˆ™LSTMçš„è¾“å‡ºä¸ºæœ€åŽä¸€ä¸ªtime stepçš„hidden stateï¼Œshapeä¸º(1, 3)ã€‚æ­¤æ—¶åŠ ä¸Šä¸€ä¸ªDense layer, ä¸ç”¨ä½¿ç”¨TimeDistributedï¼Œå°±å¯ä»¥å°†(1, 3)å˜æ¢ä¸º(1, 1)ã€‚ æ€»ç»“æœ¬æ–‡ä¸»è¦é€šè¿‡ä¸€äº›å®žé™…çš„ä»£ç æ¡ˆä¾‹ï¼Œè§£é‡Šäº†Kerasçš„LSTM APIä¸­å¸¸è§çš„ä¸¤ä¸ªå‚æ•°return_sequenceå’Œreturn_stateçš„åŽŸç†åŠä½œç”¨ï¼Œåœ¨TensorflowåŠPyTorchï¼Œä¹Ÿæœ‰ç›¸é€šçš„ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¤§å®¶åŠ æ·±å¯¹RNNçš„ç†è§£ã€‚]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
      <tags>
        <tag>Keras</tag>
        <tag>LSTM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ç”¨forå¾ªçŽ¯ï¼æ•™ä½ ç”¨numpyâ€œæ‰‹æ’•â€æœ´ç´ è´å¶æ–¯]]></title>
    <url>%2Fposts%2Fnumpy-naive-bayes%2F</url>
    <content type="text"><![CDATA[å¸¸è§çš„pythonæœ´ç´ è´å¶æ–¯ç®—æ³•çš„æ–¹å¼ï¼Œéƒ½æ˜¯ä½¿ç”¨forå¾ªçŽ¯æ¥ç»Ÿè®¡å„ä¸ªp(ç‰¹å¾|ç±»åž‹)çš„å€¼ã€‚å…¶å®žæœºå™¨å­¦ä¹ é™¤äº†å¸¸è§„ç®—æ³•æ€è·¯å¤–ï¼Œå¾ˆå…³é”®ä¸”å¾ˆä¼˜é›…çš„åœ°æ–¹åœ¨äºŽçŸ©é˜µåŒ–ï¼ˆå‘é‡åŒ–ï¼‰ï¼Œå³vectorizationã€‚é€šè¿‡å„ç§çŸ©é˜µè¿ç®—æ¥åŽ»é™¤forå¾ªçŽ¯ï¼Œæ˜¯ç›®å‰æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ä¸­éžå¸¸å…³é”®çš„æŠ€å·§ã€‚æ–‡æœ¬ä¸ä½¿ç”¨å„ç§é«˜é˜¶æœºå™¨å­¦ä¹ åº“ï¼Œå•çº¯ä½¿ç”¨numpyæ¥æ‰‹æ’•æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œå¸¦ä½ é¢†ç•¥æœºå™¨å­¦ä¹ ä¸­çš„çŸ©é˜µè¿ç®—ä¹‹é“ã€‚ æ•°æ®å‡†å¤‡ä¸ºäº†demoæ–¹ä¾¿ï¼Œæˆ‘ä»¬å…ˆä¼ªé€ ä¸€äº›æ•°æ®ã€‚è¿™é‡Œä¼ªé€ çš„æ˜¯NLPæƒ…æ„Ÿåˆ†ç±»çš„æ•°æ®ã€‚åˆ†ä¸ºä¸¤éƒ¨é—¨trainå’Œvalidï¼Œæ ‡ç­¾åˆ†ä¸º1å’Œ0ï¼Œ1ä»£è¡¨ä¾®è¾±æ€§æ–‡å­—ï¼Œ0ä»£è¡¨æ­£å¸¸è¨€è®ºã€‚ 12345678train = ['my dog had flea problems help help please', 'mybe not take him to dog park stupid dog', 'my dalmation is so cute I love him', 'stop posting stupid worthless garbage', 'mr licks ate my steak how to stop him',]valid = ['my stupid stupid worthless dog']label = [0,1,0,1,0]valid_y = [1] æ•°æ®é¢„å¤„ç†NLPçš„æ•°æ®é¢„å¤„ç†ä¸»è¦å°±æ˜¯è¯å…¸çš„åˆ›å»ºå’Œæ–‡æœ¬çš„å‘é‡åŒ–ã€‚è¿™é‡Œç”±äºŽæ˜¯è‹±è¯­æ–‡æ¡£ï¼Œä¸å­˜åœ¨åˆ†è¯çš„é—®é¢˜ã€‚ è¿™é‡Œç”±äºŽæ˜¯æ‰‹æ’•æ•™ç¨‹ï¼Œä¸ä½¿ç”¨spacyç­‰é«˜é˜¶NLPåº“ï¼Œè¯å…¸åˆ›å»ºçš„ä¹Ÿå³ä½¿ç”¨Pythonçš„set 123456vocab = set([])for doc in train: vocab = vocab | set(doc.split())vocabList = list(vocab)# æ ¹æ®è¯åæŸ¥indexvocabList.index('please') æ–‡æ¡£å‘é‡åŒ–å‘é‡è¯çš„åŽŸç†ï¼Œé¦–å…ˆå°†æ–‡æ¡£ä¸­å¥å­çš„æ¯ä¸€ä¸ªå•è¯æŒ‰ç…§å­—å…¸è½¬æ¢ä¸ºindex 123456train_vec = []valid_vec = []for doc in train: train_vec.append([vocabList.index(x) for x in doc.split()])for doc in valid: valid_vec.append([vocabList.index(x) for x in doc.split()]) å¯ä»¥çœ‹çœ‹å‘é‡åŒ–åŽçš„ç»“æžœ 123456789train_vec, valid_vec'''[[28, 11, 16, 7, 26, 19, 19, 8], [20, 24, 21, 14, 6, 11, 12, 22, 11], [28, 5, 9, 25, 0, 3, 2, 14], [1, 17, 22, 15, 13], [18, 4, 27, 28, 10, 23, 6, 1, 14]], [[28, 22, 22, 15, 11]]''' æŽ¥ç€æ˜¯å°†è¯å…¸çš„æ¯ä¸€ä¸ªå•è¯ä½œä¸ºä¸€ä¸ªfeatureç»´åº¦å¤„ç†ï¼Œå°†æ‰€æœ‰æ–‡æ¡£å¤„ç†æˆç›¸åŒç»´åº¦çš„çŸ©é˜µï¼Œç»´åº¦å¤§å°å³ä¸ºè¯å…¸çš„é•¿åº¦ï¼Œè€Œæ¯ä¸ªç»´åº¦çš„å€¼æœ‰å¤šç§å¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚æŒ‰ç…§å¥å­ä¸­æ¯ä¸ªå•è¯çš„Countè®¡æ•°ï¼Œæˆ–è€…æ˜¯æ¯ä¸ªå•è¯çš„TFIDFå€¼ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†Countï¼Œä¸ºäº†ä½“çŽ°æ‰‹æ’•ï¼Œä½¿ç”¨äº†Pythonçš„Counterï¼Œä¸ºäº†ä½“çŽ°numpyçŸ©é˜µè¿ç®—çš„æ€è·¯ï¼Œä½¿ç”¨äº†scipyçš„ç¨€ç–çŸ©é˜µsparse.csr_matrixã€‚ 1234567891011121314151617from collections import Counterfrom scipy.sparse import csr_matrixdef get_term_doc_matrix(label_list, vocab_len): j_indices = [] indptr = [] values = [] indptr.append(0) for i, doc in enumerate(label_list): feature_counter = Counter(doc) j_indices.extend(feature_counter.keys()) values.extend(feature_counter.values()) indptr.append(len(j_indices)) return csr_matrix((values, j_indices, indptr), shape=(len(indptr) - 1, vocab_len), dtype=int)train_matrix = get_term_doc_matrix(train_vec, len(vocabList)valid_matrix = get_term_doc_matrix(valid_vec, len(vocabList) å¯ä»¥çœ‹çœ‹çŸ©é˜µåŒ–åŽçš„trainå’Œvalidï¼Œåˆ†åˆ«è½¬æ¢æˆäº†samples*featureï¼Œ29å³ä¸ºå­—å…¸çš„ç»´åº¦ã€‚ 1234567train_matrix, valid_matrix'''&lt;5x29 sparse matrix of type '' with 37 stored elements in Compressed Sparse Row format&gt;, &lt;1x29 sparse matrix of type '' with 4 stored elements in Compressed Sparse Row format&gt;''' æˆ‘ä»¬å°†ç”Ÿæˆçš„train_matrixä½œå›¾å¦‚ä¸‹ï¼ˆä¸ºæ–¹ä¾¿è§‚çœ‹çœåŽ»äº†éƒ¨åˆ†ç»´åº¦ï¼‰ æœ´ç´ è´å¶æ–¯ç®—æ³•åŽŸç†è°ˆåˆ°æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œé¦–å…ˆæƒ³åˆ°çš„å¿…å®šæ˜¯è‘—åçš„è´å¶æ–¯å…¬å¼ ä¸è¿‡è¿™ä¸ªå®šç†å¦‚ä½•ä½“çŽ°åˆ°æˆ‘ä»¬æœºå™¨å­¦ä¹ çš„åœºæ™¯å‘¢ï¼Ÿæˆ‘ä»¬æŠŠå…¶ä¸­çš„Aå’ŒBæ¢æˆå®žé™…çš„ç‰©ç†æ„ä¹‰å¦‚ä¸‹ï¼š åœ¨æˆ‘ä»¬çš„åˆ†ç±»ç›‘ç£å­¦ä¹ ä¸­ï¼Œå…¶å®žå°±æ˜¯æ±‚åœ¨ä¸€å®šç‰¹å¾çš„æ ·æœ¬æƒ…å†µä¸‹ï¼ŒæŸä¸ªå…·ä½“ç±»åˆ«çš„æ¦‚çŽ‡ã€‚æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œå¯ä»¥è½¬æ¢æˆåˆ†åˆ«æ±‚æŸä¸ªç±»åˆ«ä¸‹è¿™äº›ç‰¹å¾çš„æ¦‚çŽ‡ã€æŸç±»åˆ«çš„æ¦‚çŽ‡ã€ç‰¹å¾çš„æ¦‚çŽ‡ã€‚ å®žé™…åœºæ™¯ä¸­ï¼Œç‰¹å¾ä¸€èˆ¬æ˜¯å¤šç»´çš„ï¼Œè€Œå¤šç»´ç‰¹å¾çš„è”åˆæ¦‚çŽ‡æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚è¿™æ—¶å€™ï¼Œå°±ä½“çŽ°å‡ºæœ´ç´ çš„æ¦‚å¿µäº†ã€‚æˆ‘ä»¬å¯¹æ ·æœ¬ä½œå‡ºå‡è®¾ï¼šæ ·æœ¬ä¸­çš„å„ä¸ªç‰¹å¾æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚è¿™æ ·ï¼Œå¯ä»¥å°†è”åˆæ¦‚çŽ‡è½¬æ¢æˆä»¥ä¸‹çš„ç‹¬ç«‹æ¦‚çŽ‡ä¹˜ç§¯ï¼š å½“ç„¶ï¼Œè¿™ç§å‡è®¾è‚¯å®šæ˜¯ç²—æš´çš„ã€‚ä½†æ˜¯å®žè·µè¿‡ç¨‹ä¸­ï¼Œè®¡ç®—é‡å‡å°‘å¸¦æ¥çš„ç›Šå¤„æ˜¯è¿œå¤§äºŽç²—æš´å‡è®¾å¸¦æ¥çš„å¤±çœŸã€‚è¿™ä¹Ÿæ˜¯æœ€è€ƒéªŒç®—æ³•å·¥ç¨‹å¸ˆçš„åœ°æ–¹ï¼Œæ—¢è¦è€ƒè™‘æ•°å­¦çš„ä¸¥è°¨ï¼ŒåŒæ—¶ä¹Ÿè¦è€ƒè™‘å·¥ç¨‹å®žçŽ°ã€‚â€œpart-science, part-artâ€ï¼Œè¿™æˆ–è®¸ä¹Ÿæ˜¯æœºå™¨å­¦ä¹ ä¹‹é“ã€‚ å½“ç„¶ï¼Œå¯¹äºŽæ¨¡åž‹æœ€ç»ˆçš„åº”ç”¨æ¥è¯´ï¼Œæ±‚å‡ºå…·ä½“çš„æ¦‚çŽ‡ç»å¯¹å€¼æ˜¯æ„ä¹‰ä¸å¤§çš„ã€‚æˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸åŒç‰¹å¾ä¹‹é—´æ¦‚çŽ‡çš„æ¯”å€¼å°±è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºŽäºŒåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼š å°±å¯ä»¥åˆ¤æ–­å‡ºè¯¥æ ·æœ¬æ˜¯å±žäºŽç±»åˆ«1ã€‚äºŽæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŽ¥ç€è¿›è¡Œå…¬å¼å˜æ¢ï¼Œå°†P(ç±»åˆ«2|ç‰¹å¾)ç§»åˆ°ç­‰å¼å·¦è¾¹ï¼Œå¹¶å–logï¼š åŒæ ·ï¼Œæ ¹æ®æœ´ç´ çš„å‡è®¾ï¼Œå¯ä»¥å¾—åˆ°ï¼š å³ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºæ¯ä¸ªç‰¹å¾å¯¹åº”çš„ ä»¥åŠæ¯ä¸ªç±»åˆ«å¯¹åº”çš„ ç„¶åŽå…¨éƒ¨ç›¸åŠ ï¼Œçœ‹ç»“æžœæ˜¯å¦å¤§äºŽ0å³å¯åˆ¤æ–­å‡ºæ ·æœ¬çš„ç±»åˆ«ã€‚è€Œè¿™ä¸¤å—ï¼Œæˆ‘ä»¬éƒ½æ˜¯å¯ä»¥ä»Žè®­ç»ƒæ ·æœ¬ä¸­æ±‚å‡ºï¼ˆå…ˆéªŒæ¦‚çŽ‡ï¼‰ï¼Œè¿™ä¹Ÿå°±æ˜¯æœ´ç´ è´å¶æ–¯ç®—æ³•è®­ç»ƒçš„éƒ¨åˆ†ã€‚ ##æœ´ç´ è´å¶æ–¯çŸ©é˜µè¿ç®— å‰è¨€ä¸­è¯´åˆ°ï¼Œä¸€èˆ¬çš„æ•™ç¨‹ï¼Œç›´æŽ¥ä½¿ç”¨forå¾ªçŽ¯æ•°æ•°ä¸€èˆ¬å°±å¯ä»¥æ±‚å‡ºä¸Šè¿°çš„ä¸¤ä¸ªlogå€¼ï¼Œå®Œæˆâ€œè®­ç»ƒâ€ã€‚æˆ‘ä»¬è¿™æ ·ï¼Œè¦å……åˆ†åº”ç”¨numpyçš„çŸ©é˜µè¿ç®—ç‰¹æ€§ï¼Œä¸ä½¿ç”¨forå¾ªçŽ¯ 123456import numpy as npp1 = np.squeeze(np.asarray(train_matrix[np.asarray(label==1].sum(0)))p0 = np.squeeze(np.asarray(train_matrix[np.asarray(label==0].sum(0)))pr1 = (p1+1) / ((np.asarray(label)==1).sum() + 1)pr0 = (p0+1) / ((np.asarray(label)==0).sum() + 1)r = np.log(pr1/pr0) è¿˜æ˜¯ä»¥è¿™ä¸ªå›¾ä¸ºä¾‹ï¼Œpr1å³ä¸ºç±»åˆ«ä¸º1çš„æ ·æœ¬ä¸­ç‰¹å¾xçš„æ¦‚çŽ‡ã€‚åœ¨NLPä¸­ï¼Œæ¯ä¸ªç‰¹å¾éƒ½æ˜¯ä¸€ä¸ªè¯ï¼Œå…¶ç‰©ç†æ„ä¹‰å°±æ˜¯æŸä¸ªè¯åœ¨æŸä¸ªç±»åˆ«ä¸­å‡ºçŽ°çš„æ¦‚çŽ‡ï¼Œè€Œæœ€åŽæ±‚å‡ºçš„rå³ä¸ºæ‰€æœ‰ç‰¹å¾çš„æ¦‚çŽ‡åœ¨2ä¸ªç±»åˆ«çš„æ¯”å€¼ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„ræ˜¯ä¸ªå‘é‡ï¼Œæ˜¯é€šè¿‡æ ·æœ¬ä¹‹é—´çš„çŸ©é˜µè¿ç®—ä¸€æ¬¡æ€§æ±‚å‡ºã€‚ 123456789r'''array([-0.40546511, 0.28768207, -0.40546511, -0.40546511,-0.40546511, -0.40546511, 0.28768207, -0.40546511, -0.40546511, -0.40546511, -0.40546511, 0.69314718, 0.98082925, 0.98082925, -0.11778304, 0.98082925, -0.40546511, 0.98082925, -0.40546511, -0.81093022, 0.98082925, 0.98082925, 1.38629436, -0.40546511, 0.98082925, -0.40546511, -0.40546511, -0.40546511, -1.09861229])''' æŽ¥ä¸‹æ¥æ±‚ç¬¬äºŒä¸ªlogï¼Œè¿™ä¸ªç›´æŽ¥å°±æ˜¯ä¸åŒç±»åˆ«çš„æ¯”ä¾‹ã€‚ 1234b = np.log((np.asarray(label)==1).mean() / (np.asarra(label)==0).mean())'''-0.4054651081081643''' è¿™é‡Œçš„rå’Œbå³ä¸ºæˆ‘ä»¬è®­ç»ƒå‡ºçš„æ¨¡åž‹çš„å‚æ•°ã€‚å¯ä»¥å°†å…¶åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œä¾›åŽç»­é¢„æµ‹çš„æ—¶å€™ä½¿ç”¨ï¼ˆä¹Ÿå°±æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„inferenceï¼‰ã€‚ æœ´ç´ è´å¶æ–¯æŽ¨ç†ç”±äºŽrä»£è¡¨äº†è®­ç»ƒæ ·æœ¬ä¸­æ¯ä¸€ä¸ªç‰¹å¾è¯çš„åœ¨ä¸åŒç±»åˆ«çš„æ¦‚çŽ‡æ¯”å€¼ï¼Œæ¯”å¦‚â€™stupidâ€™ç­‰è¯å°±å¾ˆé«˜ï¼Œè€Œâ€™loveâ€™ç­‰è¯å°±è¾ƒä½Žã€‚åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åŒæ ·å–å‡ºé¢„æµ‹æ ·æœ¬ä¸­çš„æ‰€æœ‰è¯ï¼Œç„¶åŽè€ƒè™‘è¿™äº›è¯çš„æ¦‚çŽ‡æ¯”å€¼ï¼Œæœ€åŽå…¨éƒ¨ç›¸åŠ ï¼Œå³å¯åˆ¤æ–­æœ€ç»ˆæ ·æœ¬çš„ç±»åˆ«ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨numpyçš„çŸ©é˜µè¿ç®—ã€‚ 1234train_matrix@r + b &gt; 0# array([False, True, False, True, False])valid_matrix@r + b &gt; 0# array([ True]) è¿™é‡Œ@æ˜¯numpyçš„çŸ©é˜µä¹˜æ“ä½œï¼Œä¸¾ä¾‹å¦‚å›¾è€Œbä½œä¸ºä¸€ä¸ªæ ‡é‡ï¼Œä¼šç›´æŽ¥è§¦å‘numpyä¸­çš„broadcastæ“ä½œï¼Œç›´æŽ¥æŠŠ+åº”ç”¨åˆ°æ‰€æœ‰æ ·æœ¬ï¼ŒåŒæ ·&gt;ä¹Ÿä¼šbroadcastï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªarrayï¼Œè¡¨ç¤ºæ¯ä¸€ä¸ªæµ‹è¯•æ ·æœ¬æ˜¯å¦é¢„æµ‹ä¸ºç±»åˆ«1ã€‚ æ‰©å±•ç”±äºŽä¸Šé¢æŽ¨ç†è¿‡ç¨‹ä¸­ï¼Œtrain_matrixå’Œvalid_matrixéƒ½æ˜¯ç”±è¯é¢‘ç»„æˆï¼Œç›¸å½“äºŽåœ¨æ±‚å…·ä½“æ¦‚çŽ‡æ¯”å€¼çš„æ—¶å€™åº”ç”¨è¯é¢‘åšäº†åŠ æƒã€‚åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œä¹Ÿå¯è€ƒè™‘ä¸ä½¿ç”¨è¯é¢‘ï¼Œç›´æŽ¥ä½¿ç”¨æ˜¯å¦å«æœ‰æŸä¸ªç‰¹å¾è¯ï¼Œå¦‚ä¸‹ï¼š 12train_matrix.sign()@r + b &gt; 0valid_matrix.sign()@r + b &gt; 0 å…·ä½“å“ªç§æ–¹å¼å¥½ï¼Œè¿˜æ˜¯è¦æ ¹æ®å®žé™…çš„æ•°æ®æ ·æœ¬æƒ…å†µæ¥å…·ä½“æµ‹è¯•ã€‚ æ€»ç»“æœ¬æ–‡ä»¥NLPä¸­çš„å¥å­æƒ…æ„Ÿåˆ†æžä¸ºä¾‹ï¼Œä½¿ç”¨numpyçš„çŸ©é˜µè¿ç®—æ¥æ‰‹æ’•æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œå¯ä»¥åŠ æ·±å¯¹ä¸Žæœ´ç´ è´å¶æ–¯ç®—æ³•çš„ç†è§£ï¼Œå¹¶ä½“ä¼šæœºå™¨å­¦ä¹ ä¸­çŸ©é˜µè¿ç®—ä¹‹é“ã€‚ æœ´ç´ è´å¶æ–¯ç®€å•å¿«æ·ï¼Œç‰¹åˆ«é€‚åˆè¾ƒå¤§è§„æ¨¡çš„ç¨€ç–çŸ©é˜µï¼Œåœ¨æƒ…æ„Ÿåˆ†æžã€åžƒåœ¾é‚®ä»¶åˆ†ç±»ç­‰åœºæ™¯ä¸­æœ‰å¾ˆæ™®éçš„åº”ç”¨ã€‚åœ¨æ·±åº¦å­¦ä¹ å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡è¿™ä¸ªç®€å•çš„ç®—æ³•æ¥å¿«é€Ÿæ­å»ºæ•´ä¸ªæµç¨‹çš„pipelineã€‚åœ¨æˆ‘çœ¼é‡Œï¼Œåœ¨æœºå™¨å­¦ä¹ é¡¹ç›®çš„åˆæœŸï¼Œæµç¨‹pipelineçš„é‡è¦æ€§å¤§äºŽä»»ä½•ç®—æ³•ã€‚]]></content>
      <categories>
        <category>Machine Learning</category>
      </categories>
      <tags>
        <tag>æœ´ç´ è´å¶æ–¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦å¼€å§‹å†™ä½œï¼Ÿ]]></title>
    <url>%2Fposts%2Fwhy-start-writting%2F</url>
    <content type="text"><![CDATA[æºèµ·â€“ è¯´èµ·åšå®¢ï¼Œåœ¨å¤§å­¦é˜¶æ®µæ›¾ç»çŽ©è¿‡ï¼Œå½“æ—¶çŽ©çš„è¿˜æ˜¯MSN Spacesã€‚ä¸è¿‡ä¸Šé¢æ›´å¤šæ˜¯ä¸€äº›ç»åŽ†ã€æ„Ÿæ‚Ÿï¼Œä¸ºèµ‹æ–°è¯å¼ºè¯´æ„ç½¢äº†ã€‚åŽæ¥è¯»äº†ç ”ç©¶ç”Ÿã€æœ‰äº†å®¶åº­ã€æœ‰äº†äº‹ä¸šï¼Œä¸ªäººåšå®¢ä¹Ÿå°±é€æ¸è’åºŸäº†ã€‚çŽ°åœ¨MSN Spacesæ—©å·²å…³é—­ï¼Œä¹‹å‰çš„æ–‡ç« ä¹Ÿå°±æ— ä»Žå¯»è§…äº†ã€‚å·¥ä½œä»¥åŽï¼Œå†™ä½œæ–¹é¢æ›´å¤šçš„æ˜¯å·¥ä½œè®°å½•ï¼Œä»¥é›¶æ•£ç¬”è®°ä¸ºä¸»ï¼Œä¸»è¦æ˜¯ç”¨çš„Evernoteä»¥åŠçŽ°åœ¨çš„Bearï¼Œä½†æ˜¯å¤ªè¿‡é›¶æ•£ä¸æˆä½“ç³»ã€‚ æ— æ„ä¹‹ä¸­çœ‹åˆ°äº†Andrew Chençš„ä¸€ç¯‡æŽ¨æ–‡ï¼Œâ€œå…³äºŽå†™ä½œçš„15æ¡æŽ¨ç‰¹â€ï¼Œæ·±å¾—æˆ‘å¿ƒï¼Œä¹Ÿæ˜¯æˆ‘ä¸ºä»€ä¹ˆæƒ³åœ¨2019å¹´å¼€å§‹å†™ä½œçš„æœ€å¥½è¯ é‡Šã€‚ Andrew Chenæ˜¯åœ¨ç”¨æˆ·å¢žé•¿(User Growth)æ–¹é¢çš„ä¸“å®¶ï¼Œä¹Ÿæ›¾ä»»Uberçš„å¢žé•¿VPã€‚ä»¥ä¸‹æ˜¯ä»–çš„æŽ¨æ–‡åŽŸæ–‡ï¼Œå¹¶é™„ä¸Šæˆ‘çš„æ€è€ƒã€‚ Andrew Chenâ€™s TweetstormTweet #1 1/ After 10+ years of publishing professional writing at http://andrewchen.co , I have a couple opinions on how to get your stuff read. åœ¨è¿‡åŽ»åå¹´çš„å·¥ä½œç”Ÿæ¶¯ä¸­ï¼Œæˆ‘æœ‰ç€éžå¸¸å¤šçš„ç»åŽ†ï¼Œä»Žè½¯ä»¶å·¥ç¨‹å¸ˆåˆ°Scrum Masterï¼Œä»Žæ•°æ®åˆ†æžåˆ°å¤§æ•°æ®æŒ–æŽ˜ï¼Œä»Žæœºå™¨å­¦ä¹ åˆ°æ·±åº¦å­¦ä¹ ã€‚è€Œè¿™äº›ç»åŽ†æ›´å¤šçš„æ˜¯æ•£è½åœ¨å„å¤„ï¼Œæ²¡æœ‰ä¸€ä¸ªåœ°æ–¹å¯ä»¥æ²‰æ·€ä¸‹æ¥ã€‚å½“æˆ‘æ„è¯†åˆ°è¿™æ˜¯ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä¹Ÿå¼€å¯äº†æˆ‘è‡ªå·±çš„ä¸ªäººç½‘ç«™machinelearningzen.comçš„å»ºè®¾ï¼Œå¸Œæœ›èƒ½å¤Ÿæ±‡èšæˆ‘çš„ç»åŽ†å’Œæ„Ÿæ‚Ÿï¼Œå¹¶æŠŠå®ƒä»¬åˆ†äº«å‡ºæ¥ã€‚ Tweet #2 2/ Titles are 80% of the work, but you write it as the very last thing. It has to be an compelling opinion or important learning çŽ°åœ¨äººçš„ç”Ÿæ´»èŠ‚å¥éƒ½éžå¸¸çš„å¿«ï¼Œè¿™ä¹Ÿæ˜¯â€œæ ‡é¢˜å…šâ€æ¨ªè¡Œçš„å®¢è§‚åŽŸå› ã€‚ä½†æ˜¯æˆ‘è§‰å¾—é™¤äº†æœ‰ä¸€ä¸ªå¼•äººå…¥èƒœçš„æ ‡é¢˜å¤–ï¼Œè¿˜æ˜¯è¦æœ‰èƒ½å¤Ÿæ’‘å¾—èµ·è¿™ä¸ªæ ‡é¢˜çš„å¹²è´§å†…å®¹æ‰è¡Œã€‚ Tweet #3 3/ Thereâ€™s always room for high-quality thoughts/opinions. Venn diagram of people w/ knowledge and those we can communicate is tiny è¿™ä¸ªä¹Ÿåº”è¯äº†â€œå†…å®¹ä¸ºçŽ‹â€ã€‚çŽ°åœ¨è™½æ˜¯è‡ªåª’ä½“æ—¶ä»£ï¼Œä½†æ˜¯å„ç§æŠ„è¢­ã€ä¼ªåŽŸåˆ›ä»ç„¶éåœ°éƒ½æ˜¯ã€‚æˆ‘å¸Œæœ›æˆ‘è‡ªå·±çš„å†…å®¹éƒ½æ˜¯è‡ªå·±ç»è¿‡æ·±åº¦æ€è€ƒåŽçš„è¾“å‡ºï¼Œè€Œä¸æ˜¯ä¸œæ‹¼è¥¿å‡‘ã€‚ Tweet #4 4/ Writing is the most scalable professional networking activity - stay home, donâ€™t go to events/conferences, and just put ideas down éžå¸¸èµžåŒï¼Œæ„Ÿè°¢äº’è”ç½‘å’Œç§»åŠ¨äº’è”ç½‘ï¼Œæˆ‘ä»¬å¯ä»¥å‘†åœ¨å®¶é‡Œæˆ–è€…æ˜Ÿå·´å…‹ï¼Œä¸€æ¯å’–å•¡ï¼Œå°±èƒ½è·Ÿå…¨ä¸–ç•Œå¿—åŒé“åˆçš„æœ‹å‹äº¤æµã€‚ Tweet #5 5/ Think of your writing on the same timescale as your career. Write on a multi-decade timeframe. This means, donâ€™t just pub on Quora/Medium å†™ä½œæ˜¯ä¸€ä¸ªéžå¸¸å¥½çš„æŠŠè‡ªå·±çš„ç¢Žç‰‡çŸ¥è¯†ä½“ç³»åŒ–ã€èžä¼šè´¯é€šçš„æ–¹å¼ã€‚ä»¥åå¹´ä¸ºå•ä½æ—¥ç§¯æœˆç´¯ï¼Œä½ çš„çŸ¥è¯†ä½“ç³»ä¼šåƒå‚å¤©å¤§æ ‘ä¸€æ ·ã€‚ Tweet #6 6/ Focus on writing freq over anything else. Schedule it. Donâ€™t worry about building an immediate audience. Focus on the intrinsic. ä¸“æ³¨äºŽå†…å®¹æœ¬èº«ï¼Œä¸ç”¨æ‹…å¿ƒæ²¡æœ‰è¯»è€…ã€‚å¦å¤–ï¼Œä¿æŒå†™ä½œçš„é¢‘çŽ‡ï¼Œäººéƒ½ä¼šæœ‰â€œæ‹–å»¶ç—‡â€ï¼Œæœ‰äº›äº‹æƒ…ï¼Œä¸€æ—¦å¼€å§‹æ‹–å°±ç­‰äºŽç»“æŸäº†ã€‚ Tweet #7 7/ To develop the habit, put a calendar reminder each Sunday for 2 hours. Forced myself to stare at a blank text box and put something down å…»æˆä¹ æƒ¯ï¼Œå¿…é¡»è¦æœ‰å¾ˆå¼ºçš„è®¡åˆ’åŠ›å’Œæ‰§è¡ŒåŠ›ã€‚è¿™äº›èƒ½åŠ›åœ¨å·¥ä½œå½“ä¸­åŒæ ·é‡è¦ï¼Œéœ€è¦ä¸€è¾ˆå­çš„ä¿®è¡Œã€‚ Tweet #8 8/ Most of my writing comes from talking/reading deciding I strongly agree or disagree. These opinions become titles. Titles become essays. ä¿æŒé˜…è¯»å’Œäº¤æµéžå¸¸é‡è¦ã€‚æˆ‘çš„å·¥ä½œç”Ÿæ¶¯çš„å‰å‡ å¹´ï¼Œç”±äºŽåœˆå­å¤ªçª„ï¼ŒæŽ¥è§¦çš„ä¿¡æ¯ä¹Ÿå¾ˆå°‘ï¼Œå¯¼è‡´æˆé•¿éžå¸¸ç¼“æ…¢ã€‚åŽæ¥æ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜åŽï¼Œå¼€å§‹å¤§é‡çš„é˜…è¯»å’Œäº¤æµï¼Œè‡ªå·±ä¹Ÿå¼€å§‹äº†çªé£žçŒ›è¿›ã€‚çŽ°åœ¨ï¼Œæ˜¯æ—¶å€™æŠŠè¿™äº›é˜…è¯»å’Œäº¤æµå†ç»§ç»­æ²‰æ·€æˆæ–‡å­—ï¼Œç»™æ›´å¤šçš„äººåˆ†äº«ã€‚ Tweet #9 9/ People are often obsessed with needing to write original ideas. Forget it. Youâ€™re a journalist with a day job in the tech industry ä¸ç”¨æ‹˜æ³¥äºŽå¼€å¤©è¾Ÿåœ°ï¼ŒçŽ°åœ¨çš„ç§‘æŠ€é¢†åŸŸå·²ç»ä¸æ˜¯ä¸ªäººå•æ‰“ç‹¬æ–—çš„æ—¶ä»£äº†ã€‚å­¦ä¼šè¸©åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œä½ æ‰èƒ½çœ‹å¾—æ›´è¿œã€‚ Tweet #10 10/ An email subscriber is worth 100x twitter or LinkedIn followers or whatever other stuff is out there. An email = a real channel Email è®¢é˜…åœ¨å›½å¤–éžå¸¸æµè¡Œï¼Œå¯æ˜¯åœ¨ä¸­å›½ä¸€ç›´å‘å±•ä¸èµ·æ¥ï¼Œæˆ–è®¸å°±æ˜¯äººä»¬çš„ä½¿ç”¨ä¹ æƒ¯å¯¼è‡´ã€‚å¥½åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼Œå¾®ä¿¡å…¬ä¼—å·ä¹Ÿæ˜¯ä¸€ä¸ªçœŸæ­£çš„æŽ¨é€æ¸ é“ã€‚æˆ‘ä¹Ÿå¼€é€šäº†è‡ªå·±çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œæ–‡ç« å’Œä¸ªäººç½‘ç«™åŒæ­¥ï¼Œå¸Œæœ›å–œæ¬¢å¬æˆ‘çš„åˆ†äº«çš„æœ‹å‹å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°æœ€æ–°æ–‡ç« çš„æŽ¨é€ã€‚ Tweet #11 11/ I started writing while working at a VC. They asked, â€œWhy give away ideas? Thatâ€™s your edge.â€ Ironic that VCs blog/tweet all day now ;) è¿™ä¸ªä¹Ÿæ˜¯å¾ˆå¤šäººä¸æ„¿æ„å†™åšå®¢åˆ†äº«çš„åŽŸå› ï¼Œå®³æ€•è‡ªå·±çš„ideaè¢«åˆ«äººæŠ„è¢­ã€‚å…¶å®žå†™æ–‡ç« åˆ†äº«ideaï¼ŒèŽ·å¾—å·¨å¤§æå‡çš„è¿˜æ˜¯è‡ªå·±ã€‚ Tweet #12 12/ Publishing ideas, learnings, opinions, for years &amp; years is a great way to give. And youâ€™ll figure out how to capture value later å¹´å¤ä¸€å¹´åœ°å‘è¡¨ä½ çš„æƒ³æ³•ã€å­¦åˆ°çš„çŸ¥è¯†ã€è§‚ç‚¹ï¼Œä½ å¾ˆå¿«å°±èƒ½åœ¨åˆ†äº«ä¹‹åŽèŽ·å¾—å…¶ä¸­çš„ä»·å€¼ã€‚è™½ç„¶æˆ‘æ‰å¼€å§‹çœŸæ­£çš„å†™ä½œï¼Œæˆ‘å·²ç»æ„Ÿå—åˆ°äº†è‡ªå·±çš„æˆé•¿ï¼Œæˆ‘ä¼šä¸€ç›´æŠŠå®ƒæŒç»­ä¸‹åŽ»ã€‚ Tweet #13 13/ Today I learned that tweetstorms can be way less structured than writing an essay, which makes it much easier ;) This is my first one! Andrew Chenè®¤ä¸ºåœ¨twitterä¸Šå†™ä½œæ˜¯å¦å¤–ä¸€ç§è½»æ¾æ„‰å¿«çš„æ–¹å¼ï¼Œä»–æŠŠè¿™ç§æ–¹å¼å‘½åä¸ºâ€œæŽ¨ç‰¹é£Žæš´â€ Tweet #14 14/ OK thatâ€™s all for now! Thanks for reading :) :) Tweet #15 15/ Bonus: In order of value, Writing &gt; Reading books &gt; Reading reddit &gt; Twitter &gt; FB/Instagram ;) è¿™ä¸ªæ˜¯Andrewè®¤ä¸ºçš„ä»·å€¼æŽ’åºï¼šå†™ä½œ &gt; è¯»ä¹¦ &gt; è¯» reddit &gt; Twitter &gt; Facebook/Instagramã€‚å½“ç„¶è¿™æ˜¯ç«™åœ¨ä¸ªäººæå‡çš„ä»·å€¼ä¸Šçš„ï¼Œåˆ‡è®°ï¼Œæˆ‘ä»¬çš„å·¥ä½œä¸ç­‰äºŽæˆ‘ä»¬çš„ç”Ÿæ´»ã€‚ä¿æŒè‡ªå·±1ï½ž2ä¸ªçˆ±å¥½ï¼Œå¹¶æŒç»­æŠ•å…¥æˆä¸ºè¾¾äººï¼Œä½ çš„äººç”Ÿä¼šæ›´åŠ ç¾Žå¥½ã€‚]]></content>
      <categories>
        <category>æ„Ÿæ‚Ÿ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[numpyâ€œæ‰‹æ’•â€æ–‡æœ¬ä¸»é¢˜æ¨¡åž‹ä¹‹LSA]]></title>
    <url>%2Fposts%2Fnumpy-lsa%2F</url>
    <content type="text"><![CDATA[å‰è¨€åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ä¸ªtf-idfæ¥èŽ·å–æœ¬æ–‡çš„å…³é”®è¯ï¼ˆä¸»é¢˜ï¼‰ã€‚ç”±äºŽtf-idfç®—æ³•ä»…ä»…æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨¡åž‹ï¼Œç®€å•å¿«é€Ÿï¼Œé€‚åˆä½œä¸ºbaselineã€‚å®ƒæœ€å¤§çš„é—®é¢˜åœ¨äºŽå•å•è€ƒè™‘äº†è¯é¢‘ï¼Œè€Œæ²¡æœ‰è€ƒè™‘è¯­ä¹‰ï¼Œå¹¶ä¸”æˆ‘ä»¬å–topKçš„è¯ï¼Œè¿™ä¸ªKå€¼å¦‚ä½•é€‰å–ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ æœ¬æ–‡ä»‹ç»ä¸€ç§çœŸæ­£çš„ä¸»é¢˜æ¨¡åž‹ï¼Œä¹Ÿæ˜¯æœ€æ—©å‡ºçŽ°çš„ä¸»é¢˜æ¨¡åž‹LSAï¼ˆLatent Semantic Analysisï¼‰ï¼šæ½œåœ¨è¯­ä¹‰åˆ†æžï¼Œå®ƒä¸»è¦æ˜¯åˆ©ç”¨SVDé™ç»´çš„æ–¹å¼ï¼Œå°†è¯ä¸Žæœ¬æ–‡æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„ç©ºé—´ï¼Œè€Œè¿™ä¸ªç©ºé—´æ­£æ˜¯ä»¥ä¸»é¢˜ä½œä¸ºç»´åº¦ã€‚å®ƒçš„åŽŸç†éžå¸¸æ¼‚äº®ï¼Œä¸€æ¬¡å¥‡å¼‚å€¼åˆ†è§£å°±å¯ä»¥å¾—åˆ°ä¸»é¢˜æ¨¡åž‹ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†è¯ä¹‰çš„é—®é¢˜ã€‚ æœ¬æ–‡ç»§ç»­å‘æŒ¥hands-onçš„ä¼ ç»Ÿï¼Œä»¥ä¸€ä¸ªå®žä¾‹æ¥è¯´æ˜ŽLSAçš„ç”¨æ³•ã€‚åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨gensimç­‰æ¡†æž¶æ¥å¿«é€Ÿè¿›è¡Œå¼€å‘ï¼Œæœ¬æ–‡ä»Žscipyå’Œnumpyå…¥æ‰‹ï¼Œå¯ä»¥æ›´æ¸…æ¥šçš„äº†è§£å…¶ä¸­çš„åŽŸç†ã€‚ æ•°æ®é¢„å¤„ç†ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬ç›´æŽ¥é‡‡ç”¨äº†scikit-learnä¸­çš„Newsgroupsæ•°æ®é›†ã€‚è¿™æ˜¯ç”¨äºŽæ–‡æœ¬åˆ†ç±»ã€æ–‡æœ¬æŒ–æ®å’Œä¿¡æ¯æ£€ç´¢ç ”ç©¶çš„å›½é™…æ ‡å‡†æ•°æ®é›†ä¹‹ä¸€ã€‚æ•°æ®é›†æ”¶é›†äº†å¤§çº¦20,000å·¦å³çš„æ–°é—»ç»„æ–‡æ¡£ï¼Œå‡åŒ€åˆ†ä¸º20ä¸ªä¸åŒä¸»é¢˜çš„æ–°é—»ç»„é›†åˆã€‚ æˆ‘ä»¬æˆªå–äº†å…¶ä¸­4ä¸ªä¸»é¢˜çš„æ•°æ®ï¼Œå¹¶é‡‡ç”¨scikit-learnä¸­çš„APIæ¥è£…è½½ã€‚ 12345from sklearn.datasets import fetch_20newsgroupscategories = ['alt.atheism', 'talk.religion.misc','comp.graphics', 'sci.space']remove = ('headers', 'footers', 'quotes')newsgroups_train = fetch_20newsgroups(subset='train',categories=categories, remove=remove)newsgroups_test = fetch_20newsgroups(subset='test',categories=categories, remove=remove) æ•°æ®ä¸‹è½½å¥½åŽï¼Œæˆ‘ä»¬çœ‹çœ‹é‡Œé¢çš„æ–‡æœ¬é•¿å•¥æ · 12345678910111213141516171819newsgroups_train.data[:5]'''["Hi,\n\n I've noticed that if you only save a model (withall your mapping planes\n positioned carefully) to a .3DSfile that when you reload it after restarting\n 3DS, theyare given a default position and orientation. But if yousave\nto a .PRJ file their positions/orientation arepreserved. Does anyone\n know why this information is notstored in the .3DS file? Nothing is\nexplicitly said inthe manual about saving texture rules in the .PRJ file.\n I'd like to be able to read the texture rule information,does anyone have \n the format for the .PRJ file?\n\n Is the.CEL file format available from somewhere?\n\n Rych", '\n\n Seems to be, barring evidence to the contrary, that Koresh was simply\n another deranged fanatic who thought it neccessary to take a whole bunch of\n folks with him, children and all, to satisfy his delusional mania. Jim\n Jones, circa 1993.\n\n\n Nope - fruitcakes like Koresh have been demonstrating such evil corruption\n for centuries.']''' æ‹¿åˆ°æ–‡æœ¬åŽï¼Œç¬¬ä¸€ä»¶äº‹å½“ç„¶æ˜¯tokenizerï¼Œç„¶åŽé‡‡ç”¨bag-of-wordsè¯è¢‹æ¨¡åž‹å°†å…¶å‘é‡åŒ–ã€‚è¿™é‡Œä½¿ç”¨scikit-learnä¸­çš„CountVectorizerï¼Œä»¥è¯é¢‘è®¡æ•°æ¥ä½œä¸ºå‘é‡å€¼ï¼Œå½“ç„¶æ›´ç²¾ç»†åŒ–å¯ä»¥é‡‡ç”¨TfidfVectorizerã€‚ 12345import numpy as npfrom sklearn.feature_extraction.text import CountVectorizervectorizer = CountVectorizer(stop_words='english')vectors = vectorizer.fit_transform(newsgroups_train.data.todense()vocab = np.array(vectorizer.get_feature_names()) å¯ä»¥çœ‹çœ‹å‘é‡åŒ–åŽçš„çŸ©é˜µ 1234vectors.shape'''(2034, 26576)''' è¿™é‡Œè¡¨ç¤ºå…±æœ‰2034ç¯‡æ–‡æ¡£ï¼Œè¯çš„vocab_sizeä¸º26576ï¼Œå°†æ‰€æœ‰æ–‡æ¡£è½¬æˆäº†26576ç»´çš„å‘é‡ï¼Œæ¯ä¸ªå‘é‡çš„å€¼ä¸ºè¯¥ç»´è¡¨ç¤ºè¯çš„è¯é¢‘ã€‚ SVDåˆ†è§£å‘é‡åŒ–å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å¥‡å¼‚å€¼åˆ†è§£äº†ã€‚ 12import scipyU, s, Vh = scipy.linalg.svd(vectors, full_matrices=False) æ ¹æ®ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ†è§£å‡ºæ¥çš„çŸ©é˜µï¼š U: (2034, 2034) è¡¨ç¤º2034ä¸ªæ ·æœ¬ï¼Œå¯¹åº”2034ä¸ªtopic s: (2034, ) è¡¨ç¤º2034ä¸ªå¥‡å¼‚å€¼ï¼Œå³topicçš„é‡è¦æ€§åˆ†æ•° Vh: (2034, 26576) è¡¨ç¤º2034ä¸ªtopicï¼Œå¯¹åº”26576ä¸ªvocabï¼Œæ³¨æ„è¿™ä¸ªVhæ˜¯å…¬å¼ä¸­çš„VTï¼Œå³è½¬ç½®åŽçš„V SVDå¥‡å¼‚å€¼åˆ†è§£ï¼Œå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š å¥‡å¼‚å€¼åˆ†è§£ä¸ºç²¾ç¡®åˆ†è§£ï¼Œå³åˆ†è§£åŽçš„çŸ©é˜µå¯ä»¥å®Œå…¨è¿˜åŽŸåŽŸçŸ©é˜µï¼Œä¿¡æ¯ä¸ä¸¢å¤± Uå’ŒVhæ˜¯æ­£äº¤çŸ©é˜µ æˆ‘ä»¬å¯ä»¥åœ¨numpyä¸­éªŒè¯ä¸€ä¸‹ï¼š 1234# æ³¨æ„å°†sä»Žä¸€ç»´å‘é‡è½¬æ¢æˆå¯¹è§’çŸ©é˜µ(diagonal matrix)np.allclose(U.dot(np.diag(s)).dot(Vh), vectors)np.allclose(U.T.dot(U), np.eye(U.shape[0]))np.allclose(Vh.dot(Vh.T), np.eye(Vh.shape[0])) Topicè§£è¯»LSAçš„ä¼˜é›…ä¹‹å¤„ï¼Œå°±æ˜¯æŠŠä¹‹å‰çš„é«˜ç»´æ–‡æ¡£å‘é‡ï¼Œé™ç»´åˆ°ä½Žç»´ï¼Œä¸”è¿™ä¸ªç»´åº¦ä»£è¡¨äº†æ–‡æ¡£çš„éšå«è¯­ä¹‰ï¼Œå³è¿™ä¸ªæ–‡æ¡£çš„ä¸»é¢˜topicã€‚svdåˆ†è§£å‡ºæ¥çš„VhçŸ©é˜µï¼Œå³æ˜¯æ¯ä¸ªä¸»é¢˜çš„çŸ©é˜µï¼Œç»´åº¦æ˜¯æ¯ä¸ªå•è¯ï¼Œç»´åº¦å€¼å¯ä»¥çœ‹æˆæ˜¯è¿™ä¸ªä¸»é¢˜ä¸­æ¯ä¸ªå•è¯çš„çš„é‡è¦æ€§ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥é€‰å–é‡è¦æ€§æœ€é«˜çš„è¯ï¼Œæ¥è§£è¯»æŸä¸ªéšå«ä¸»é¢˜ã€‚ 123456789101112131415161718num_top_words = 8def show_topics(a): top_words = lambda t: [vocab[i] for i in np.argsort(t)[:-num_top_words-1:-1]] topic_words = ([top_words(t) for t in a])return [' '.join(t) for t in topic_words]show_topics(Vh[:10])'''['ditto critus propagandist surname galacticentrickindergarten surreal imaginative', 'jpeg gif file color quality image jfif format', 'graphics edu pub mail 128 3d ray ftp', 'jesus god matthew people atheists atheism does graphics', 'image data processing analysis software available tools display', 'god atheists atheism religious believe religion argument true', 'space nasa lunar mars probe moon missions probes', 'image probe surface lunar mars probes moon orbit', 'argument fallacy conclusion example true ad argumentum premises', 'space larson image theory universe physical nasa material']''' å¯ä»¥çœ‹å‡ºï¼Œæœ‰äº›ä¸»é¢˜æ˜¯å…³äºŽå›¾ç‰‡æ ¼å¼çš„ï¼Œæœ‰çš„æ˜¯å…³äºŽé‚®ä»¶åè®®çš„ï¼Œæœ‰çš„æ˜¯å…³äºŽå¤ªç©ºçš„ã€‚ è€Œsvdåˆ†è§£å‡ºæ¥çš„UçŸ©é˜µï¼Œå°±æ˜¯æ¯ä¸ªæ–‡æ¡£å¯¹åº”çš„ä¸»é¢˜çŸ©é˜µï¼Œç»´åº¦æ˜¯æ¯ä¸ªä¸»é¢˜ï¼Œç»´åº¦å€¼ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯æ¯ä¸ªä¸»é¢˜çš„é‡è¦æ€§ã€‚ Truncated SVDåœ¨ç”Ÿäº§å®žè·µä¸­ï¼Œæ™®é€šsvdç”±äºŽè¦exact decompositionï¼Œè®¡ç®—é‡ä¼šéžå¸¸å¤§ï¼Œä¸”æœ€åŽçš„åº”ç”¨å¾€å¾€ä¼šåªçœ‹å‰nä¸ªtopicï¼Œå› æ­¤Truncated SVDçš„ä¼˜åŠ¿åœ¨äºŽï¼Œé¢„å…ˆè®¾ç½®å¥½nçš„å€¼ï¼Œå¯ä»¥åœ¨ç‰ºç‰²ä¸€å®šç²¾åº¦çš„æ¡ä»¶ä¸‹ï¼Œå¤§å¤§å‡å°‘è®¡ç®—é‡ã€‚è¿™é‡Œæä¾›ä¸¤ç§å¸¸è§çš„svdå®žçŽ°ä»¥ä½œå‚è€ƒã€‚ sklearnå®žçŽ°12from sklearn import decompositionu, s, v = decomposition.randomized_svd(vectors, 10) Facebookå®žçŽ°12import fbpcau, s, v = fbpca.pca(vectors, 10) æ€»ç»“LSAä½œä¸ºæœ€æ—©å‡ºçŽ°çš„çœŸæ­£ä¸»é¢˜æ¨¡åž‹ï¼Œéžå¸¸ä¼˜é›…ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨å¾ˆå¤šä¸è¶³ï¼Œæ¯”å¦‚å®ƒå¾—åˆ°çš„ä¸æ˜¯ä¸€ä¸ªæ¦‚çŽ‡æ¨¡åž‹ï¼ŒåŒæ—¶å¾—åˆ°çš„å‘é‡ä¸­å«æœ‰è´Ÿå€¼ï¼Œéš¾ä»¥ç›´è§‚è§£é‡Šã€‚é’ˆå¯¹è¿™äº›é—®é¢˜ï¼ŒåŽç»­å°±æœ‰NMFï¼ˆéžè´ŸçŸ©é˜µåˆ†è§£ï¼‰ï¼ŒLDAï¼ˆéšå«ç‹„åˆ©å…‹é›·åˆ†å¸ƒï¼‰ç­‰æ¨¡åž‹å‡ºçŽ°ã€‚]]></content>
      <categories>
        <category>NLP</category>
      </categories>
      <tags>
        <tag>LSA</tag>
        <tag>SVD</tag>
        <tag>Topic Model</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‰‹æŠŠæ‰‹æ•™ä½ å¿«é€Ÿå…¥é—¨çŸ¥è¯†å›¾è°± - Neo4Jæ•™ç¨‹]]></title>
    <url>%2Fposts%2Fknowledge-graph-neo4j-toturial%2F</url>
    <content type="text"><![CDATA[å‰è¨€ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥èŠä¸€èŠçŸ¥è¯†å›¾è°±ä¸­çš„Neo4Jã€‚é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯çŸ¥è¯†å›¾è°±ï¼Ÿå…ˆæ‘˜ä¸€æ®µç™¾åº¦ç™¾ç§‘ï¼š çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰ï¼Œåœ¨å›¾ä¹¦æƒ…æŠ¥ç•Œç§°ä¸ºçŸ¥è¯†åŸŸå¯è§†åŒ–æˆ–çŸ¥è¯†é¢†åŸŸæ˜ å°„åœ°å›¾ï¼Œæ˜¯æ˜¾ç¤ºçŸ¥è¯†å‘å±•è¿›ç¨‹ä¸Žç»“æž„å…³ç³»çš„ä¸€ç³»åˆ—å„ç§ä¸åŒçš„å›¾å½¢ï¼Œç”¨ å¯è§†åŒ–æŠ€æœ¯æè¿°çŸ¥è¯†èµ„æºåŠå…¶è½½ä½“ï¼ŒæŒ–æŽ˜ã€åˆ†æžã€ æž„å»ºã€ç»˜åˆ¶å’Œæ˜¾ç¤ºçŸ¥è¯†åŠå®ƒä»¬ä¹‹é—´çš„ç›¸äº’è”ç³»ã€‚çŸ¥è¯†å›¾è°±æ˜¯é€šè¿‡å°†åº”ç”¨æ•°å­¦ã€ å›¾å½¢å­¦ã€ä¿¡æ¯å¯è§†åŒ–æŠ€æœ¯ã€ ä¿¡æ¯ç§‘å­¦ç­‰å­¦ç§‘çš„ç†è®ºä¸Žæ–¹æ³•ä¸Žè®¡é‡å­¦å¼•æ–‡åˆ†æžã€å…±çŽ°åˆ†æžç­‰æ–¹æ³•ç»“åˆï¼Œå¹¶åˆ©ç”¨å¯è§†åŒ–çš„å›¾è°±å½¢è±¡åœ°å±•ç¤ºå­¦ç§‘çš„æ ¸å¿ƒç»“æž„ã€å‘å±•åŽ†å²ã€ å‰æ²¿é¢†åŸŸä»¥åŠæ•´ä½“çŸ¥è¯†æž¶æž„è¾¾åˆ°å¤šå­¦ç§‘èžåˆç›®çš„çš„çŽ°ä»£ç†è®ºã€‚å®ƒèƒ½ä¸ºå­¦ç§‘ç ”ç©¶æä¾›åˆ‡å®žçš„ã€æœ‰ä»·å€¼çš„å‚è€ƒã€‚ ç®€å•è¯´æ¥ï¼ŒçŸ¥è¯†å›¾è°±å°±æ˜¯é€šè¿‡ä¸åŒçŸ¥è¯†çš„å…³è”æ€§å½¢æˆä¸€ä¸ªç½‘çŠ¶çš„çŸ¥è¯†ç»“æž„ï¼Œè€Œè¿™ä¸ªçŸ¥è¯†ç»“æž„ï¼Œæ°å¥½å°±æ˜¯äººå·¥æ™ºèƒ½AIçš„åŸºçŸ³ã€‚å½“å‰AIé¢†åŸŸçƒ­é—¨çš„è®¡ç®—æœºå›¾åƒã€è¯­éŸ³è¯†åˆ«ç”šè‡³æ˜¯NLPï¼Œå…¶å®žéƒ½æ˜¯AIçš„æ„ŸçŸ¥èƒ½åŠ›ï¼ŒçœŸæ­£AIçš„è®¤çŸ¥èƒ½åŠ›ï¼Œå°±è¦é çŸ¥è¯†å›¾è°±ã€‚ çŸ¥è¯†å›¾è°±ç›®å‰çš„åº”ç”¨ä¸»è¦åœ¨æœç´¢ã€æ™ºèƒ½é—®ç­”ã€æŽ¨èç³»ç»Ÿç­‰æ–¹é¢ã€‚çŸ¥è¯†å›¾è°±çš„å»ºè®¾ï¼Œä¸€èˆ¬åŒ…æ‹¬æ•°æ®èŽ·å–ã€å®žä½“è¯†åˆ«å’Œå…³ç³»æŠ½å–ã€æ•°æ®å­˜å‚¨ã€å›¾è°±åº”ç”¨éƒ½å‡ ä¸ªæ–¹é¢ã€‚æœ¬æ–‡ç€çœ¼äºŽæ•°æ®å­˜å‚¨è¿™å—ï¼Œç»™å¤§å®¶ä¸€ä¸ªNeo4Jçš„å¿«é€Ÿæ•™ç¨‹ã€‚ Neo4Jç®€ä»‹çŸ¥è¯†å›¾è°±ç”±äºŽå…¶æ•°æ®åŒ…å«å®žä½“ã€å±žæ€§ã€å…³ç³»ç­‰ï¼Œå¸¸è§çš„å…³ç³»åž‹æ•°æ®åº“è¯¸å¦‚MySQLä¹‹ç±»ä¸èƒ½å¾ˆå¥½çš„ä½“çŽ°æ•°æ®çš„è¿™äº›ç‰¹ç‚¹ï¼Œå› æ­¤çŸ¥è¯†å›¾è°±æ•°æ®çš„å­˜å‚¨ä¸€èˆ¬æ˜¯é‡‡ç”¨å›¾æ•°æ®åº“ï¼ˆGraph Databasesï¼‰ã€‚è€ŒNeo4jæ˜¯å…¶ä¸­æœ€ä¸ºå¸¸è§çš„å›¾æ•°æ®åº“ã€‚ Neo4Jå®‰è£…é¦–å…ˆåœ¨ https://neo4j.com/download/ ä¸‹è½½Neo4Jã€‚Neo4Jåˆ†ä¸ºç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆï¼Œä¼ä¸šç‰ˆåœ¨æ¨ªå‘æ‰©å±•ã€æƒé™æŽ§åˆ¶ã€è¿è¡Œæ€§èƒ½ã€HAç­‰æ–¹é¢éƒ½æ¯”ç¤¾åŒºç‰ˆå¥½ï¼Œé€‚åˆæ­£å¼çš„ç”Ÿäº§çŽ¯å¢ƒï¼Œæ™®é€šçš„å­¦ä¹ å’Œå¼€å‘é‡‡ç”¨å…è´¹ç¤¾åŒºç‰ˆå°±å¥½ã€‚ åœ¨Macæˆ–è€…Linuxä¸­ï¼Œå®‰è£…å¥½jdkåŽï¼Œç›´æŽ¥è§£åŽ‹ä¸‹è½½å¥½çš„Neo4JåŒ…ï¼Œè¿è¡Œbin/neo4j startå³å¯ Neo4Jä½¿ç”¨Neo4Jæä¾›äº†ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„webç•Œé¢ï¼Œå¯ä»¥è¿›è¡Œå„é¡¹é…ç½®ã€å†™å…¥ã€æŸ¥è¯¢ç­‰æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†å¯è§†åŒ–åŠŸèƒ½ã€‚ç±»ä¼¼ElasticSearchä¸€æ ·ï¼Œæˆ‘ä¸ªäººéžå¸¸å–œæ¬¢è¿™ç§å¼€ç®±å³ç”¨çš„è®¾è®¡ã€‚ æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥http://127.0.0.1:7474/browser/ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç•Œé¢æœ€ä¸Šæ–¹å°±æ˜¯äº¤äº’çš„è¾“å…¥æ¡†ã€‚ CypheræŸ¥è¯¢è¯­è¨€Cypheræ˜¯Neo4Jçš„å£°æ˜Žå¼å›¾å½¢æŸ¥è¯¢è¯­è¨€ï¼Œå…è®¸ç”¨æˆ·ä¸å¿…ç¼–å†™å›¾å½¢ç»“æž„çš„éåŽ†ä»£ç ï¼Œå°±å¯ä»¥å¯¹å›¾å½¢æ•°æ®è¿›è¡Œé«˜æ•ˆçš„æŸ¥è¯¢ã€‚Cypherçš„è®¾è®¡ç›®çš„ç±»ä¼¼SQLï¼Œé€‚åˆäºŽå¼€å‘è€…ä»¥åŠåœ¨æ•°æ®åº“ä¸Šåšç‚¹å¯¹ç‚¹æ¨¡å¼ï¼ˆad-hocï¼‰æŸ¥è¯¢çš„ä¸“ä¸šæ“ä½œäººå‘˜ã€‚å…¶å…·å¤‡çš„èƒ½åŠ›åŒ…æ‹¬ï¼š åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤èŠ‚ç‚¹å’Œå…³ç³» é€šè¿‡æ¨¡å¼åŒ¹é…æ¥æŸ¥è¯¢å’Œä¿®æ”¹èŠ‚ç‚¹å’Œå…³ç³» ç®¡ç†ç´¢å¼•å’Œçº¦æŸç­‰ Neo4Jå®žæˆ˜æ•™ç¨‹ç›´æŽ¥è®²è§£Cypherçš„è¯­æ³•ä¼šéžå¸¸æž¯ç‡¥ï¼Œæœ¬æ–‡é€šè¿‡ä¸€ä¸ªå®žé™…çš„æ¡ˆä¾‹æ¥ä¸€æ­¥ä¸€æ­¥æ•™ä½ ä½¿ç”¨Cypheræ¥æ“ä½œNeo4Jã€‚ è¿™ä¸ªæ¡ˆä¾‹çš„èŠ‚ç‚¹ä¸»è¦åŒ…æ‹¬äººç‰©å’ŒåŸŽå¸‚ä¸¤ç±»ï¼Œäººç‰©å’Œäººç‰©ä¹‹é—´æœ‰æœ‹å‹ã€å¤«å¦»ç­‰å…³ç³»ï¼Œäººç‰©å’ŒåŸŽå¸‚ä¹‹é—´æœ‰å‡ºç”Ÿåœ°çš„å…³ç³»ã€‚ 1. é¦–å…ˆï¼Œæˆ‘ä»¬åˆ é™¤æ•°æ®åº“ä¸­ä»¥å¾€çš„å›¾ï¼Œç¡®ä¿ä¸€ä¸ªç©ºç™½çš„çŽ¯å¢ƒè¿›è¡Œæ“ä½œï¼š 1MATCH (n) DETACH DELETE n è¿™é‡Œï¼ŒMATCHæ˜¯åŒ¹é…æ“ä½œï¼Œè€Œå°æ‹¬å·()ä»£è¡¨ä¸€ä¸ªèŠ‚ç‚¹nodeï¼ˆå¯ç†è§£ä¸ºæ‹¬å·ç±»ä¼¼ä¸€ä¸ªåœ†å½¢ï¼‰ï¼Œæ‹¬å·é‡Œé¢çš„nä¸ºæ ‡è¯†ç¬¦ã€‚ 2. æŽ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªäººç‰©èŠ‚ç‚¹ï¼š 1CREATE (n:Person &#123;name:&apos;John&apos;&#125;) RETURN n CREATEæ˜¯åˆ›å»ºæ“ä½œï¼ŒPersonæ˜¯æ ‡ç­¾ï¼Œä»£è¡¨èŠ‚ç‚¹çš„ç±»åž‹ã€‚èŠ±æ‹¬å·{}ä»£è¡¨èŠ‚ç‚¹çš„å±žæ€§ï¼Œå±žæ€§ç±»ä¼¼Pythonçš„å­—å…¸ã€‚è¿™æ¡è¯­å¥çš„å«ä¹‰å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ ‡ç­¾ä¸ºPersonçš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å…·æœ‰ä¸€ä¸ªnameå±žæ€§ï¼Œå±žæ€§å€¼æ˜¯Johnã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨Neo4Jçš„ç•Œé¢ä¸Šå¯ä»¥çœ‹åˆ°åˆ›å»ºæˆåŠŸçš„èŠ‚ç‚¹ã€‚3. æˆ‘ä»¬ç»§ç»­æ¥åˆ›å»ºæ›´å¤šçš„äººç‰©èŠ‚ç‚¹ï¼Œå¹¶åˆ†åˆ«å‘½åï¼š 12345CREATE (n:Person &#123;name:&apos;Sally&apos;&#125;) RETURN nCREATE (n:Person &#123;name:&apos;Steve&apos;&#125;) RETURN nCREATE (n:Person &#123;name:&apos;Mike&apos;&#125;) RETURN nCREATE (n:Person &#123;name:&apos;Liz&apos;&#125;) RETURN nCREATE (n:Person &#123;name:&apos;Shawn&apos;&#125;) RETURN n å¦‚å›¾æ‰€ç¤ºï¼Œ6ä¸ªäººç‰©èŠ‚ç‚¹åˆ›å»ºæˆåŠŸ4. æŽ¥ä¸‹æ¥åˆ›å»ºåœ°åŒºèŠ‚ç‚¹ 12345CREATE (n:Location &#123;city:&apos;Miami&apos;, state:&apos;FL&apos;&#125;)CREATE (n:Location &#123;city:&apos;Boston&apos;, state:&apos;MA&apos;&#125;)CREATE (n:Location &#123;city:&apos;Lynn&apos;, state:&apos;MA&apos;&#125;)CREATE (n:Location &#123;city:&apos;Portland&apos;, state:&apos;ME&apos;&#125;)CREATE (n:Location &#123;city:&apos;San Francisco&apos;, state:&apos;CA&apos;&#125;) å¯ä»¥çœ‹åˆ°ï¼ŒèŠ‚ç‚¹ç±»åž‹ä¸ºLocationï¼Œå±žæ€§åŒ…æ‹¬cityå’Œstateã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œå…±æœ‰6ä¸ªäººç‰©èŠ‚ç‚¹ã€5ä¸ªåœ°åŒºèŠ‚ç‚¹ï¼ŒNeo4Jè´´å¿ƒåœ°ä½¿ç”¨ä¸ç”¨çš„é¢œè‰²æ¥è¡¨ç¤ºä¸åŒç±»åž‹çš„èŠ‚ç‚¹ã€‚ 5. æŽ¥ä¸‹æ¥åˆ›å»ºå…³ç³» 123MATCH (a:Person &#123;name:&apos;Liz&apos;&#125;), (b:Person &#123;name:&apos;Mike&apos;&#125;) MERGE (a)-[:FRIENDS]-&gt;(b) è¿™é‡Œçš„æ–¹æ‹¬å·[]å³ä¸ºå…³ç³»ï¼ŒFRIENDSä¸ºå…³ç³»çš„ç±»åž‹ã€‚æ³¨æ„è¿™é‡Œçš„ç®­å¤´--&gt;æ˜¯æœ‰æ–¹å‘çš„ï¼Œè¡¨ç¤ºæ˜¯ä»Žaåˆ°bçš„å…³ç³»ã€‚ å¦‚å›¾ï¼ŒLizå’ŒMikeä¹‹é—´å»ºç«‹äº†FRIENDSå…³ç³»ï¼Œé€šè¿‡Neo4Jçš„å¯è§†åŒ–å¾ˆæ˜Žæ˜¾çš„å¯ä»¥çœ‹å‡ºï¼š 6. å…³ç³»ä¹Ÿå¯ä»¥å¢žåŠ å±žæ€§ 123MATCH (a:Person &#123;name:&apos;Shawn&apos;&#125;), (b:Person &#123;name:&apos;Sally&apos;&#125;) MERGE (a)-[:FRIENDS &#123;since:2001&#125;]-&gt;(b) åœ¨å…³ç³»ä¸­ï¼ŒåŒæ ·çš„ä½¿ç”¨èŠ±æ‹¬å·{}æ¥å¢žåŠ å…³ç³»çš„å±žæ€§ï¼Œä¹Ÿæ˜¯ç±»ä¼¼Pythonçš„å­—å…¸ï¼Œè¿™é‡Œç»™FRIENDSå…³ç³»å¢žåŠ äº†sinceå±žæ€§ï¼Œå±žæ€§å€¼ä¸º2001ï¼Œè¡¨ç¤ºä»–ä»¬å»ºç«‹æœ‹å‹å…³ç³»çš„æ—¶é—´ã€‚ 7. æŽ¥ä¸‹æ¥å¢žåŠ æ›´å¤šçš„å…³ç³» 1234MATCH (a:Person &#123;name:&apos;Shawn&apos;&#125;), (b:Person &#123;name:&apos;John&apos;&#125;) MERGE (a)-[:FRIENDS &#123;since:2012&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;), (b:Person &#123;name:&apos;Shawn&apos;&#125;) MERGE (a)-[:FRIENDS &#123;since:2006&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Sally&apos;&#125;), (b:Person &#123;name:&apos;Steve&apos;&#125;) MERGE (a)-[:FRIENDS &#123;since:2006&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Liz&apos;&#125;), (b:Person &#123;name:&apos;John&apos;&#125;) MERGE (a)-[:MARRIED &#123;since:1998&#125;]-&gt;(b) å¦‚å›¾ï¼Œäººç‰©å…³ç³»å›¾å·²å»ºç«‹å¥½ï¼Œæœ‰ç‚¹å›¾è°±çš„æ„æ€äº†å§ï¼Ÿ 8. ç„¶åŽï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸åŒç±»åž‹èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»-äººç‰©å’Œåœ°ç‚¹çš„å…³ç³» 1MATCH (a:Person &#123;name:&apos;John&apos;&#125;), (b:Location &#123;city:&apos;Boston&apos;&#125;) MERGE (a)-[:BORN_IN &#123;year:1978&#125;]-&gt;(b) è¿™é‡Œçš„å…³ç³»æ˜¯BORN_INï¼Œè¡¨ç¤ºå‡ºç”Ÿåœ°ï¼ŒåŒæ ·æœ‰ä¸€ä¸ªå±žæ€§ï¼Œè¡¨ç¤ºå‡ºç”Ÿå¹´ä»½ã€‚ å¦‚å›¾ï¼Œåœ¨äººç‰©èŠ‚ç‚¹å’Œåœ°åŒºèŠ‚ç‚¹ä¹‹é—´ï¼Œäººç‰©å‡ºç”Ÿåœ°å…³ç³»å·²å»ºç«‹å¥½ã€‚ 9. åŒæ ·å»ºç«‹æ›´å¤šäººçš„å‡ºç”Ÿåœ° 1234MATCH (a:Person &#123;name:&apos;Liz&apos;&#125;), (b:Location &#123;city:&apos;Boston&apos;&#125;) MERGE (a)-[:BORN_IN &#123;year:1981&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;), (b:Location &#123;city:&apos;San Francisco&apos;&#125;) MERGE (a)-[:BORN_IN &#123;year:1960&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Shawn&apos;&#125;), (b:Location &#123;city:&apos;Miami&apos;&#125;) MERGE (a)-[:BORN_IN &#123;year:1960&#125;]-&gt;(b)MATCH (a:Person &#123;name:&apos;Steve&apos;&#125;), (b:Location &#123;city:&apos;Lynn&apos;&#125;) MERGE (a)-[:BORN_IN &#123;year:1970&#125;]-&gt;(b) å»ºå¥½ä»¥åŽï¼Œæ•´ä¸ªå›¾å¦‚ä¸‹ 10. è‡³æ­¤ï¼ŒçŸ¥è¯†å›¾è°±çš„æ•°æ®å·²ç»æ’å…¥å®Œæ¯•ï¼Œå¯ä»¥å¼€å§‹åšæŸ¥è¯¢äº†ã€‚æˆ‘ä»¬æŸ¥è¯¢ä¸‹æ‰€æœ‰åœ¨Bostonå‡ºç”Ÿçš„äººç‰© 1MATCH (a:Person)-[:BORN_IN]-&gt;(b:Location &#123;city:&apos;Boston&apos;&#125;) RETURN a,b ç»“æžœå¦‚å›¾ 11. æŸ¥è¯¢æ‰€æœ‰å¯¹å¤–æœ‰å…³ç³»çš„èŠ‚ç‚¹ 1MATCH (a)--&gt;() RETURN a æ³¨æ„è¿™é‡Œç®­å¤´çš„æ–¹å‘ï¼Œè¿”å›žç»“æžœä¸å«ä»»ä½•åœ°åŒºèŠ‚ç‚¹ï¼Œå› ä¸ºåœ°åŒºå¹¶æ²¡æœ‰æŒ‡å‘å…¶ä»–èŠ‚ç‚¹ï¼ˆåªæ˜¯è¢«æŒ‡å‘ï¼‰ 12. æŸ¥è¯¢æ‰€æœ‰æœ‰å…³ç³»çš„èŠ‚ç‚¹ 1MATCH (a)--() RETURN a ç»“æžœå¦‚å›¾ 13. æŸ¥è¯¢æ‰€æœ‰å¯¹å¤–æœ‰å…³ç³»çš„èŠ‚ç‚¹ï¼Œä»¥åŠå…³ç³»ç±»åž‹ 1MATCH (a)-[r]-&gt;() RETURN a.name, type(r) ç»“æžœå¦‚å›¾ 14. æŸ¥è¯¢æ‰€æœ‰æœ‰ç»“å©šå…³ç³»çš„èŠ‚ç‚¹ 1MATCH (n)-[:MARRIED]-() RETURN n ç»“æžœå¦‚å›¾ 15. åˆ›å»ºèŠ‚ç‚¹çš„æ—¶å€™å°±å»ºå¥½å…³ç³» 1CREATE (a:Person &#123;name:&apos;Todd&apos;&#125;)-[r:FRIENDS]-&gt;(b:Person &#123;name:&apos;Carlos&apos;&#125;) ç»“æžœå¦‚å›¾ 16. æŸ¥æ‰¾æŸäººçš„æœ‹å‹çš„æœ‹å‹ 1MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;)-[r1:FRIENDS]-()-[r2:FRIENDS]-(friend_of_a_friend) RETURN friend_of_a_friend.name AS fofName è¿”å›žMikeçš„æœ‹å‹çš„æœ‹å‹ï¼šä»Žå›¾ä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒMikeçš„æœ‹å‹æ˜¯Shawnï¼ŒShawnçš„æœ‹å‹æ˜¯Johnå’ŒSally 17. å¢žåŠ /ä¿®æ”¹èŠ‚ç‚¹çš„å±žæ€§ 1234MATCH (a:Person &#123;name:&apos;Liz&apos;&#125;) SET a.age=34MATCH (a:Person &#123;name:&apos;Shawn&apos;&#125;) SET a.age=32MATCH (a:Person &#123;name:&apos;John&apos;&#125;) SET a.age=44MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;) SET a.age=25 è¿™é‡Œï¼ŒSETè¡¨ç¤ºä¿®æ”¹æ“ä½œ 18. åˆ é™¤èŠ‚ç‚¹çš„å±žæ€§ 12MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;) SET a.test=&apos;test&apos;MATCH (a:Person &#123;name:&apos;Mike&apos;&#125;) REMOVE a.test åˆ é™¤å±žæ€§æ“ä½œä¸»è¦é€šè¿‡REMOVE 19. åˆ é™¤èŠ‚ç‚¹ 1MATCH (a:Location &#123;city:&apos;Portland&apos;&#125;) DELETE a åˆ é™¤èŠ‚ç‚¹æ“ä½œæ˜¯DELETE 20. åˆ é™¤æœ‰å…³ç³»çš„èŠ‚ç‚¹ 1MATCH (a:Person &#123;name:&apos;Todd&apos;&#125;)-[rel]-(b:Person) DELETE a,b,rel æ€»ç»“æœ¬æ–‡é‡ç‚¹é’ˆå¯¹å¸¸è§çš„çŸ¥è¯†å›¾è°±å›¾æ•°æ®åº“Neo4Jè¿›è¡Œäº†ä»‹ç»ï¼Œå¹¶ä¸”é‡‡ç”¨ä¸€ä¸ªå®žé™…çš„æ¡ˆä¾‹æ¥è¯´æ˜ŽNeo4Jçš„æŸ¥è¯¢è¯­è¨€Cypherçš„ä½¿ç”¨æ–¹æ³•ã€‚ å½“ç„¶ï¼Œç±»ä¼¼MySQLä¸€æ ·ï¼Œåœ¨å®žé™…çš„ç”Ÿäº§åº”ç”¨ä¸­ï¼Œé™¤äº†ç®€å•çš„æŸ¥è¯¢æ“ä½œä¼šåœ¨Neo4Jçš„webé¡µé¢è¿›è¡Œå¤–ï¼Œä¸€èˆ¬è¿˜æ˜¯ä½¿ç”¨Pythonã€Javaç­‰çš„driveræ¥åœ¨ç¨‹åºä¸­å®žçŽ°ã€‚åŽç»­ä¼šç»§ç»­ä»‹ç»ç¼–ç¨‹è¯­è¨€å¦‚ä½•æ“ä½œNeo4Jã€‚]]></content>
      <categories>
        <category>Knowledge Graph</category>
      </categories>
      <tags>
        <tag>Neo4J</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çŽ°ä»£NLPçš„åŸºçŸ³ - Word2Vec]]></title>
    <url>%2Fposts%2Fnlp-word2vec%2F</url>
    <content type="text"><![CDATA[èµ·æºæœºå™¨å­¦ä¹ çš„å„é¡¹ç®—æ³•ï¼Œéƒ½å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šä¸€ä¸ªå‘é‡vectorï¼Œç»è¿‡ä¸€ä¸ªå‡½æ•°f(x)ï¼Œç»“æžœå¾—åˆ°å¦ä¸€ä¸ªå‘é‡vectoræˆ–è€…æ ‡é‡scalarã€‚è¾“å…¥çš„è¿™ä¸ªå‘é‡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ ·æœ¬sampleï¼Œå‘é‡ä¸­çš„æ¯ä¸€ä¸ªå€¼ï¼Œä»£è¡¨äº†æ ·æœ¬çš„æ¯ä¸€ç»´ç‰¹å¾featureã€‚è¿™ä¸ªå‘é‡ä¸€èˆ¬æ˜¯æµ®ç‚¹æ•°çš„ï¼Œå³dtype=np.float32ã€‚ åœ¨NLPçš„ç›¸å…³é¢†åŸŸä¸­ï¼Œæˆ‘ä»¬çš„æ ·æœ¬å¾€å¾€æ˜¯ä¸€æ®µæ–‡æœ¬å†…å®¹ï¼Œå¦‚ä¸€ä¸ªå¥å­ã€ä¸€ç¯‡æ–‡ç« ç­‰ç­‰ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠè¿™äº›æ–‡æœ¬ç›´æŽ¥å–‚ç»™æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œè€Œæ˜¯è¦å…ˆæŠŠæ–‡æœ¬è½¬æ¢æˆæµ®ç‚¹æ•°çš„å‘é‡ï¼Œå³æ–‡æœ¬çš„å‘é‡åŒ–è¡¨ç¤ºã€‚è¿™åœ¨NLPé¢†åŸŸä¸­æ˜¯éžå¸¸åŸºç¡€ä¸”é‡è¦çš„é˜¶æ®µï¼Œå…¶ç»“æžœå¯ä»¥ç”¨åœ¨æ–‡æ¡£æœç´¢ï¼Œç½‘é¡µæœç´¢ï¼Œåžƒåœ¾é‚®ä»¶è¿‡æ»¤ï¼Œæ–‡æœ¬ä¸»é¢˜å»ºæ¨¡ç­‰ç­‰æ–¹é¢ã€‚ BOWåœ¨æ–‡æœ¬çš„å‘é‡è¯è¡¨ç¤ºé¢†åŸŸä¸­ï¼Œæœ€æ—©å‡ºçŽ°çš„æ–¹æ³•æ˜¯BOWï¼ˆBag Of Wordsï¼‰ï¼Œå³è¯è¢‹æ¨¡åž‹ã€‚è¿™ä¸ªæ¨¡åž‹åˆ©ç”¨onehotç¼–ç çš„æ€æƒ³ï¼ŒæŠŠæ¯ä¸€ä¸ªè¯çœ‹ä½œæ˜¯ä¸€ä¸ªç»´åº¦ï¼Œç„¶åŽä¸€ä¸ªæ–‡æ¡£æˆ–å¥å­å°±å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªç»´åº¦ä¸ºNçš„å‘é‡ï¼ŒNä¸ºè¯­æ–™ä¸­è¯è¯­çš„ä¸ªæ•°ã€‚æ¯ä¸ªç»´åº¦å…·ä½“çš„å€¼ï¼Œå¯ä»¥é€šè¿‡ç®€å•è®¡æ•°æˆ–è€…è®¡ç®—TF-IDFå€¼æ¥å¾—å‡ºã€‚å®žé™…æ–¹æ¡ˆå¯å‚è€ƒScikit Learnçš„CountVectorizerå’ŒTfidfVectorizerã€‚ è¿™ç§æ–¹å¼ç®€å•ï¼Œä½†æ˜¯æ•ˆæžœä¸€èˆ¬ï¼Œå› ä¸ºå®ƒå¿½ç•¥äº†å¾ˆå¤šä¿¡æ¯ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªå¥å­ä¸­è¯è¯­çš„é¡ºåºã€‚å¦å¤–ï¼Œç”±äºŽæ¯ä¸ªè¯è¯­éƒ½æ˜¯ç‹¬ç«‹çš„ç»´åº¦ï¼Œè¯ä¸Žè¯ä¹‹é—´çš„è·ç¦»ï¼ˆç›¸å…³ï¼‰éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œè¿™ä¹Ÿæ˜Žæ˜¾ä¸åˆç†ã€‚ Word2VecWord2vec 1301.3781 Efficient Estimation of Word Representations in Vector Spaceæ˜¯è¿™ä¸ªé¢†åŸŸéžå¸¸é‡è¦çš„ç†å¿µã€‚æˆ‘è®¤ä¸ºï¼ŒWord2Vecæ˜¯NLPè¿ˆå‘æ·±åº¦å­¦ä¹ çš„åŸºçŸ³ï¼Œé€šè¿‡embeddingçš„æ–¹æ³•ï¼Œè®©æ¨¡åž‹èƒ½å¤Ÿç†è§£åˆ°æ¯ä¸ªè¯èƒŒåŽçš„éšè—å«ä¹‰ã€‚ Word2Vecè®¤ä¸ºï¼Œæ¯ä¸€ä¸ªè¯éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªå¯†é›†å¤šç»´å‘é‡ï¼ˆç›¸æ¯”BOWä¸­çš„ç¨€ç–å‘é‡ï¼‰ï¼Œä¸”è¿™ä¸ªå‘é‡å¯ä»¥æ•æ‰è¯ä¸Žè¯ä¹‹é—´çš„å…³è”ã€‚æ˜¾ç„¶ï¼Œå¯†é›†çš„æµ®ç‚¹å‘é‡ï¼Œå¯¹äºŽæœºå™¨å­¦ä¹ æ¨¡åž‹æ˜¯éžå¸¸å‹å¥½çš„ã€‚ Word2Vecé™¤äº†é‡‡ç”¨å¯†é›†æµ®ç‚¹å‘é‡æ¥è¡¨ç¤ºæ¯ä¸€ä¸ªå•è¯å¤–ï¼Œè¿˜èƒ½å®žçŽ°ä¸€ä¸ªç‰¹æ®Šçš„åŠŸèƒ½ï¼ŒæŠŠæ•°å­¦è¿ç®—å’Œæ–‡æœ¬ç»“åˆèµ·æ¥ï¼Œæ¯”å¦‚è‘—åçš„â€œking-man-queen-womanâ€å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š é‡‡ç”¨Word2Vecè¡¨ç¤ºä»¥åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çŸ©é˜µè¿ç®—ï¼Œå¾—å‡º king-man = queen-womançš„ç­‰å¼ï¼Œå³è¯è¯­çš„å‘é‡ä¸­ï¼ŒåŒ…å«äº†kingå’Œqueenä¸­å…³äºŽçŽ‹æƒçš„æ¦‚å¿µï¼ŒåŒæ—¶ä¹ŸåŒ…å«äº†manå’Œwomançš„ç”·å¥³ä¹‹åˆ«ã€‚ Word2VecæŒ‰ç…§å®žçŽ°ç®—æ³•ï¼Œå¯åˆ†ä¸ºä¸¤ç±»ï¼š CBOWCBOW(Continuous Bag Of Words)æ˜¯å®žçŽ°word2vecçš„ç®—æ³•ä¹‹ä¸€ã€‚å®ƒåœ¨æ¯ä¸ªè¯è¯­ä¸Šæž„é€ äº†ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œå³è¯è¯­çš„ä¸Šä¸‹æ–‡-è¯å‘¨å›´çš„é‚£äº›è¯ã€‚æ¯ä¸ªè¯éƒ½ç”¨ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡æ¥è¡¨ç¤ºï¼Œç„¶åŽå°±å¯ä»¥æ ¹æ®è¯å‘¨å›´çš„è¯æ¥é¢„æµ‹ä¸­é—´é‚£ä¸ªè¯ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ¯æ¬¡çš„é¢„æµ‹æƒ…å†µï¼Œä½¿ç”¨GradientDesentæ–¹æ³•ï¼Œä¸æ–­è°ƒæ•´å‘¨å›´è¯çš„å‘é‡ï¼Œå½“è®­ç»ƒå®Œæˆä»¥åŽï¼Œæ¯ä¸ªè¯éƒ½ä¼šä½œä¸ºä¸­å¿ƒè¯ï¼ŒæŠŠå‘¨å›´çš„è¯å‘é‡è¿›è¡Œäº†è°ƒæ•´ï¼Œè€Œè¿™ç§è°ƒæ•´æ˜¯ç»Ÿä¸€çš„ï¼Œå³æ±‚å‡ºçš„gradientå€¼ä¼šåŒæ ·ä½œç”¨åˆ°æ¯ä¸ªå‘¨å›´è¯çš„è¯å‘é‡ä¸­ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®žé™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œå‘¨å›´è¯çš„å‘é‡ä¼šé¦–å…ˆé€šè¿‡sumæˆ–è€…concatçš„æ–¹å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œç„¶åŽè¿›è¡Œé¢„æµ‹ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªepochè®¡ç®—çš„æ¬¡æ•°è·Ÿæ•´ä¸ªæ–‡æœ¬çš„è¯æ•°å‡ ä¹Žç›¸ç­‰ï¼Œå¤æ‚åº¦å¤§æ¦‚ä¸ºO(V)ã€‚ æ›´é€šä¿—ä¸€ç‚¹çš„ç†è§£ï¼Œç›¸å½“äºŽ1ä¸ªè€å¸ˆå¯¹åº”äº†Kä¸ªå­¦ç”Ÿï¼ŒKä¸ªå­¦ç”Ÿï¼ˆå‘¨å›´è¯ï¼‰éƒ½ä¼šä»Žè€å¸ˆï¼ˆä¸­å¿ƒè¯ï¼‰é‚£é‡Œå­¦ä¹ çŸ¥è¯†ï¼Œä½†æ˜¯è€å¸ˆï¼ˆä¸­å¿ƒè¯ï¼‰æ˜¯ä¸€è§†åŒä»çš„ï¼Œæ•™ç»™å¤§å®¶ä¸€æ ·çš„çŸ¥è¯†ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹å¼å¯¹äºŽå…·ä½“æŸä¸ªå­¦ç”Ÿï¼Œå­¦ä¹ çš„ç»“æžœä¸ä¸€å®šæ˜¯æœ€å¥½çš„ï¼Œä½†æ˜¯æ•´ä¸ªç­çº§çš„è®­ç»ƒè¿‡ç¨‹æ˜¯æ•ˆçŽ‡æœ€é«˜æœ€å¿«çš„ã€‚ Skip-gramSkip-gramæ˜¯word2vecçš„å¦ä¸€ç§å®žçŽ°ç®—æ³•ã€‚å®ƒè·Ÿcbowå®Œå…¨ç›¸åï¼Œå³ä½¿ç”¨ä¸€ä¸ªè¯æ¥é¢„æµ‹å®ƒå‘¨å›´çš„è¯ã€‚åœ¨skip-gramä¸­ï¼Œä¼šåˆ©ç”¨å¯¹å‘¨å›´è¯çš„é¢„æµ‹æƒ…å†µï¼Œä½¿ç”¨GradientDecentæ¥ä¸æ–­çš„è°ƒæ•´ä¸­å¿ƒè¯çš„è¯å‘é‡ï¼Œæœ€ç»ˆæ‰€æœ‰æ–‡æœ¬éåŽ†å®Œä»¥åŽï¼Œä¹Ÿå°±å¾—åˆ°äº†æ–‡æœ¬æ‰€æœ‰è¯çš„è¯å‘é‡ã€‚ å¯ä»¥çœ‹å‡ºï¼Œskip-gramçš„è®­ç»ƒæ¬¡æ•°æ˜¯è¦å¤šäºŽcbowçš„ï¼Œå› ä¸ºæ¯ä¸ªè¯åœ¨ä½œä¸ºä¸­å¿ƒè¯æ—¶ï¼Œéƒ½éœ€è¦æŠŠå®ƒå‘¨å›´çš„è¯å…¨éƒ¨é¢„æµ‹ä¸€æ¬¡ï¼Œè¿™æ ·ç›¸å½“äºŽæ¯”cbowçš„æ–¹æ³•å¤šè¿›è¡Œäº†K-1æ¬¡ï¼ˆå‡è®¾Kä¸ºçª—å£å¤§å°ï¼‰ï¼Œå› æ­¤å¤æ‚åº¦ä¸ºO(KV)ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œè¿™é‡Œçš„çª—å£å€¼ä¸º2ï¼Œè“è‰²çš„è¯æ˜¯è¾“å…¥ï¼Œçª—å£å†…çš„å…¶ä»–è¯ä¸ºè¾“å‡ºï¼Œè¿™æ ·å°†ä¸€ä¸ªå¥å­è½¬åŒ–ä¸ºè®­ç»ƒæ ·æœ¬ã€‚ åœ¨skip-gramå½“ä¸­ï¼Œæ¯ä¸ªè¯éƒ½è¦å—åˆ°å‘¨å›´è¯çš„å½±å“ï¼Œæ¯ä¸ªè¯åœ¨ä½œä¸ºä¸­å¿ƒè¯çš„æ—¶å€™ï¼Œéƒ½è¦è¿›è¡ŒKæ¬¡çš„é¢„æµ‹ã€è°ƒæ•´ï¼Œå› æ­¤ï¼Œå½“æ•°æ®é‡è¾ƒå°‘çš„æ—¶å€™ï¼Œæˆ–è€…è¯ä¸ºç”Ÿåƒ»è¯å‡ºçŽ°æ¬¡æ•°è¾ƒå°‘æ—¶ï¼Œè¿™ç§å¤šæ¬¡çš„è°ƒæ•´ä¼šä½¿å¾—è¯å‘é‡æ›´åŠ çš„å‡†ç¡®ã€‚ å¯¹æ¯”ä¸Šé¢çš„è€å¸ˆä¸Žå­¦ç”Ÿçš„æ¯”å–»ï¼Œåœ¨skip-gramä¸­ï¼Œæ¯ä¸ªè¯ä½œä¸ºä¸­å¿ƒè¯æ—¶ï¼Œå…¶å®žæ˜¯1ä¸ªå­¦ç”Ÿ å¯¹åº”äº†Kä¸ªè€å¸ˆï¼ŒKä¸ªè€å¸ˆï¼ˆå‘¨å›´è¯ï¼‰éƒ½ä¼šå¯¹å­¦ç”Ÿï¼ˆä¸­å¿ƒè¯ï¼‰è¿›è¡Œè®­ç»ƒï¼Œè¿™æ ·å•ä¸ªå­¦ç”Ÿçš„èƒ½åŠ›å°±ä¼šç›¸å¯¹æ‰Žå®žä¸€äº›ï¼Œä½†æ˜¯è¿™ç§è®­ç»ƒæ–¹å¼æ•´ä¸ªç­çº§çš„å­¦ä¹ æ—¶é—´è‚¯å®šæ›´é•¿ã€‚ Negative SampleæŒ‰ç…§æ­£å¸¸çš„è®­ç»ƒé€»è¾‘ï¼Œcbowå’Œskip-graméƒ½æ˜¯åˆ†ç±»æ¨¡åž‹ï¼Œåˆ†ç±»ç±»åˆ«æ•°ç­‰äºŽè¯­æ–™ä¸­è¯è¯­çš„ä¸ªæ•°ã€‚å› æ­¤æ¨¡åž‹åœ¨æœ€åŽçš„softmaxå±‚éžå¸¸å·¨å¤§ï¼Œä¼šå¯¼è‡´è®­ç»ƒçš„æ—¶é—´éžå¸¸é•¿ï¼Œä¸”éœ€è¦éžå¸¸å¤§çš„è®­ç»ƒæ•°æ®æ¥æ”¶æ•›æ¨¡åž‹å’Œé¿å…over-fittingã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œè‹¥æœ‰ä¸€ä¸ªåŒ…å«10000ä¸ªå•è¯çš„è¯æ±‡è¡¨ï¼Œè€Œå‘é‡ç‰¹å¾ä¸º300ç»´ï¼Œåˆ™åœ¨æœ€åŽä¸€å±‚Denseå±‚ä¼šæœ‰300x10000ä¸ªæƒé‡éœ€è¦æ›´æ–°ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œword2vecçš„ä½œè€…æå‡ºäº†2ä¸ªæ–¹æ¡ˆï¼š Subsampling frequent wordsï¼šä»¥ä¸€å®šçš„é˜ˆå€¼è¿‡æ»¤æŽ‰äº†ä¸€äº›é«˜é¢‘è¯ï¼Œæ¯”å¦‚â€œtheâ€ï¼Œè¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘è®­ç»ƒæ•°æ®çš„æ•°é‡ã€‚ Negative samplingï¼šæ”¹å˜ä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼Œä½¿å¾—æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬åªæ›´æ–°ç½‘ç»œçš„å°éƒ¨åˆ†æƒé‡ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨è®­ç»ƒæ ·æœ¬(â€foxâ€, â€œquickâ€)æ—¶ï¼Œæˆ‘ä»¬çš„è¾“å‡ºï¼ˆæ ‡ç­¾ï¼‰ä¸ºä¸€ä¸ªone-hotå‘é‡ï¼Œä¸”ä»£è¡¨â€quickâ€çš„ç¥žç»å…ƒè¾“å‡ºä¸º1ï¼Œä»£è¡¨å…¶ä»–æˆåƒä¸Šä¸‡çš„è¯çš„ç¥žç»å…ƒè¾“å‡ºä¸º0ã€‚é‡‡ç”¨äº†negative samplingåŽï¼Œæˆ‘ä»¬é¦–å…ˆéšæœºé€‰å–ä¸€å°éƒ¨åˆ†â€negativeâ€è¯è¯­ï¼ˆæ¯”å¦‚5ä¸ªï¼‰åŽ»æ›´æ–°ç½‘ç»œçš„æƒé‡ï¼Œè€Œâ€positiveâ€è¯è¯­ä¾ç„¶ä¹Ÿä¼šæ›´æ–°ç½‘ç»œæƒé‡ã€‚å¦‚æžœåœ¨ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œä»¥å‰æ˜¯300x10000çš„çŸ©é˜µï¼ŒçŽ°åœ¨åªéœ€è¦æ›´æ–°1+5=6ä¸ªå•è¯ï¼Œå³300x6ä¸ªæƒé‡ï¼Œæ˜¯ä»¥å‰çš„0.06%ã€‚åœ¨Tensorflowä¸­ï¼Œæœ‰çŽ°æˆçš„è¾…åŠ©å‡½æ•°tf.nn.nce_loss()å¯ä¾›ä½¿ç”¨ã€‚è€Œåœ¨å…·ä½“çš„negative samplesçš„é€‰å–ä¸Šï¼Œä½¿ç”¨äº†â€œunigram distributionâ€ï¼Œå³æ›´é¢‘ç¹ä½¿ç”¨çš„è¯è¯­æ›´å®¹æ˜“è¢«é€‰å–ã€‚ æ€»ç»“æœ¬æ–‡ä»‹ç»äº†Word2Vecçš„èµ·æºåŠç›¸åº”å®žçŽ°çš„2ç§ç®—æ³•cbowå’Œskip-gramï¼Œè¯¦ç»†å¯¹æ¯”äº†è¿™ä¸¤ç§ç®—æ³•çš„åŽŸç†ã€è®­ç»ƒæ–¹å¼åŠä¼˜ç¼ºç‚¹ï¼Œè¿˜ä»‹ç»äº†Word2Vecè®­ç»ƒæ—¶çš„é‡è¦trick: negative samplingã€‚Word2Vecè™½ç„¶ä¸ç®—æ·±åº¦å­¦ä¹ ï¼Œä½†æ˜¯å®ƒå¸¦æ¥çš„embeddingçš„æ¦‚å¿µå´æ˜¯çŽ°ä»£NLPä¹ƒè‡³æ·±åº¦å­¦ä¹ çš„åŸºçŸ³ï¼ŒåŽç»­æˆ‘ä»¬ä¼šç»§ç»­ä»‹ç»ç”±æ­¤å‘å±•çš„Doc2Vecã€Item2Vecã€Anything2Vecã€‚]]></content>
      <categories>
        <category>NLP</category>
      </categories>
      <tags>
        <tag>Word2Vec</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»»æ„ç½‘é¡µæ­£æ–‡å†…å®¹ä¸»é¢˜è¯æå–]]></title>
    <url>%2Fposts%2Fweb-topic-extractor%2F</url>
    <content type="text"><![CDATA[å‰è¨€ç½‘é¡µæ­£æ–‡å†…å®¹ä¸»é¢˜æå–ï¼Œå³ä»»æ„ç»™ä¸€ä¸ªç½‘é¡µurlï¼Œé€šè¿‡çˆ¬å–ç½‘é¡µå†…å®¹å’Œæ–‡æœ¬åˆ†æžï¼Œå¾—å‡ºè¯¥ç½‘é¡µå†…å®¹çš„å…³é”®è¯ï¼Œä½œä¸ºç½‘é¡µçš„æ ‡ç­¾ã€‚è¿™äº›å…³é”®è¯å’Œæ ‡ç­¾åœ¨åšæµé‡åˆ†æž_å†…å®¹æŽ¨èæ–¹é¢æœ‰éžå¸¸é‡è¦çš„æ„ä¹‰ã€‚æ¯”å¦‚è¯´æˆ‘ä»¬åšæ•°å­—è¥é”€ï¼Œç”¨è¿‡é¡µé¢æ¥åšç”¨æˆ·å¼•æµï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“å¸å¼•ç”¨æˆ·è¿‡æ¥çš„ç‚¹æ˜¯ä»€ä¹ˆï¼Œç”¨æˆ·çš„æ½œåœ¨éœ€æ±‚æ˜¯ä»€ä¹ˆï¼›å¦å¤–ï¼Œé’ˆå¯¹å†…å®¹ç¤¾åŒºçš„ç”¨æˆ·ç”»åƒ/æŽ¨èç³»ç»Ÿï¼Œå…³é”®ç‚¹ä¹Ÿæ˜¯æ–‡ç« /é¡µé¢çš„ä¸»é¢˜å’Œæ ‡ç­¾ã€‚ è¿™ä¸ªä»»åŠ¡æ¶‰åŠçš„æŠ€æœ¯ç‚¹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š ç½‘é¡µçˆ¬è™«ã€‚åšç½‘é¡µå†…å®¹åˆ†æžï¼Œé¦–å…ˆå¾—æ ¹æ®urlæŠŠç½‘é¡µå†…å®¹æ‰’ä¸‹æ¥å§ã€‚ æ­£æ–‡æå–ã€‚çŽ°åœ¨çš„webé¡µé¢æ˜¯éžå¸¸å¤æ‚çš„ï¼Œé™¤äº†æ­£æ–‡å¤–ï¼ŒåŒ…å«äº†å¤§é‡çš„å¹¿å‘Šã€å¯¼èˆªã€ä¿¡æ¯æµç­‰ï¼Œæˆ‘ä»¬éœ€è¦åŽ»é™¤å¹²æ‰°ï¼Œåªæå–ç½‘é¡µçš„æ­£æ–‡ä¿¡æ¯ã€‚ ä¸»é¢˜æ¨¡åž‹ ã€‚æ‹¿åˆ°æ­£æ–‡æ–‡æœ¬åŽï¼Œå°±éœ€è¦åšNLPæ¥æå–ä¸»é¢˜å…³é”®å­—äº†ã€‚ ç½‘é¡µçˆ¬è™«è¿™é‡Œçš„ç½‘é¡µçˆ¬è™«å’Œä¸€èˆ¬çš„çˆ¬è™«è¿˜ä¸å¤ªä¸€æ ·ï¼Œä¼šç®€å•è®¸å¤šï¼Œä¸»è¦æ˜¯æŠŠåŽŸå§‹ç½‘é¡µçš„HTMLæŠ“ä¸‹æ¥å³å¯ï¼Œä¸»è¦æ˜¯ä¸ºåŽç»­çš„åˆ†æžæŒ–æŽ˜æ‰“ä¸‹åŸºç¡€ï¼Œå±žäºŽæ•°æ®é‡‡é›†çš„é˜¶æ®µã€‚ è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†Pythonçš„requestsåŒ…ã€‚requestsç›¸å¯¹äºŽPythonè‡ªå¸¦çš„urllibæ¥è¯´ï¼ŒAPIæ›´ä¸ºäººæ€§åŒ–ï¼Œé²æ£’æ€§ä¹Ÿæ›´å¥½ã€‚ 1234import requestsr = request.get(url)r.encoding='utf-8'html = r.text æ­£æ–‡æå–é€šè¿‡ç ”ç©¶çˆ¬å–ä¸‹æ¥çš„åŽŸå§‹HTMLï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯éžå¸¸è´Ÿè´£è€Œä¸”æ‚ä¹±æ— ç« çš„ï¼Œå……æ–¥ç€å¤§é‡çš„jsä»£ç ç­‰ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦è§£æžHTMLï¼Œå°½é‡è¿‡æ»¤æŽ‰jsä»£ç ï¼Œç•™ä¸‹æ–‡æœ¬å†…å®¹ã€‚ è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†Pythonçš„BeautifulSoupåŒ…ã€‚è¿™ä¸ªåŒ…å ªç§°Pythonä¸€å¤§ç¥žå™¨ï¼Œè§£æžHTMLæ•ˆæžœéžå¸¸å¥½ 12345from bs4 import BeautifulSoupsoup = BeautifulSoup(html, features="html.parser")for script in soup(["script", "style"]): script.decompose()text = soup.get_text() æˆ‘ä»¬æƒ³è¦çš„æ˜¯ç½‘é¡µçš„æ­£æ–‡å†…å®¹ï¼Œå…¶ä»–çš„è¯¸å¦‚å¹¿å‘Šæˆ–è€…å¯¼èˆªæ ç­‰å¹²æ‰°å†…å®¹éœ€è¦å°½å¯èƒ½çš„è¿‡æ»¤æŽ‰ã€‚é€šè¿‡BeautifulSoupå¯ä»¥è§£æžå‡ºæ•´ä¸ªHTMLçš„DOMæ ‘ç»“æž„ï¼Œä½†æ˜¯æ¯ä¸ªç½‘é¡µHTMLçš„å†™æ³•å„ä¸ç›¸åŒï¼Œå•çº¯é HTMLè§£æžæ— æ³•åšåˆ°é€šç”¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è·³å‡ºHTMLçš„æ€ç»´ï¼Œä½¿ç”¨å…¶ä»–çš„æ–¹æ³•æ¥æå–ç½‘é¡µçš„æ­£æ–‡ã€‚è¿™é‡Œæœ‰ä¸ªå¾ˆä¼˜é›…çš„æ–¹å¼æ˜¯â€œåŸºäºŽè¡Œå—åˆ†å¸ƒå‡½æ•°â€çš„ç®—æ³•cx-extractorã€‚ åŸºäºŽè¡Œå—åˆ†å¸ƒå‡½æ•°çš„é€šç”¨ç½‘é¡µæ­£æ–‡æŠ½å–ï¼šçº¿æ€§æ—¶é—´ã€ä¸å»ºDOMæ ‘ã€ä¸ŽHTMLæ ‡ç­¾æ— å…³å¯¹äºŽWebä¿¡æ¯æ£€ç´¢æ¥è¯´ï¼Œç½‘é¡µæ­£æ–‡æŠ½å–æ˜¯åŽç»­å¤„ç†çš„å…³é”®ã€‚è™½ç„¶ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥å‡†ç¡®çš„æŠ½å–æŸä¸€å›ºå®šæ ¼å¼çš„é¡µé¢ï¼Œä½†é¢å¯¹å½¢å½¢è‰²è‰²çš„HTMLï¼Œä½¿ç”¨è§„åˆ™å¤„ç†éš¾å…æ‰è¥Ÿè§è‚˜ã€‚èƒ½ä¸èƒ½é«˜æ•ˆã€å‡†ç¡®çš„å°†ä¸€ä¸ªé¡µé¢çš„æ­£æ–‡æŠ½å–å‡ºæ¥ï¼Œå¹¶åšåˆ°åœ¨å¤§è§„æ¨¡ç½‘é¡µèŒƒå›´å†…é€šç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç›´æŽ¥å…³ç³»ä¸Šå±‚åº”ç”¨çš„éš¾é¢˜ã€‚ä½œè€… æå‡ºäº† ã€ŠåŸºäºŽè¡Œå—åˆ†å¸ƒå‡½æ•°çš„é€šç”¨ç½‘é¡µæ­£æ–‡æŠ½å–ç®—æ³•ã€‹ ï¼Œé¦–æ¬¡å°†ç½‘é¡µæ­£æ–‡æŠ½å–é—®é¢˜è½¬åŒ–ä¸ºæ±‚é¡µé¢çš„è¡Œå—åˆ†å¸ƒå‡½æ•°ï¼Œè¿™ç§æ–¹æ³•ä¸ç”¨å»ºç«‹Domæ ‘ï¼Œä¸è¢«ç—…æ€HTMLæ‰€ç´¯ï¼ˆäº‹å®žä¸Šä¸ŽHTMLæ ‡ç­¾å®Œå…¨æ— å…³ï¼‰ã€‚é€šè¿‡åœ¨çº¿æ€§æ—¶é—´å†…å»ºç«‹çš„è¡Œå—åˆ†å¸ƒå‡½æ•°å›¾ï¼Œç›´æŽ¥å‡†ç¡®å®šä½ç½‘é¡µæ­£æ–‡ã€‚åŒæ—¶é‡‡ç”¨äº†ç»Ÿè®¡ä¸Žè§„åˆ™ç›¸ç»“åˆçš„æ–¹æ³•æ¥å¤„ç†é€šç”¨æ€§é—®é¢˜ã€‚ä½œè€…ç›¸ä¿¡ç®€å•çš„äº‹æƒ…æ€»åº”è¯¥ç”¨æœ€ç®€å•çš„åŠžæ³•æ¥è§£å†³è¿™ä¸€äº˜å¤ä¸å˜çš„é“ç†ã€‚æ•´ä¸ªç®—æ³•å®žçŽ°ä»£ç ä¸è¶³ç™¾è¡Œã€‚ä½†é‡ä¸åœ¨å¤šï¼Œåœ¨æ³•ã€‚ ä¸Šå›¾å°±æ˜¯æŸä¸ªé¡µé¢æ±‚å‡ºçš„è¡Œå—åˆ†å¸ƒå‡½æ•°æ›²çº¿ã€‚è¯¥ç½‘é¡µçš„æ­£æ–‡åŒºåŸŸä¸º145è¡Œè‡³182è¡Œï¼Œå³åˆ†å¸ƒå‡½æ•°å›¾ä¸Šå«æœ‰æœ€å€¼ä¸”è¿žç»­çš„ä¸€ä¸ªåŒºåŸŸï¼Œè¿™ä¸ªåŒºåŸŸå¾€å¾€å«æœ‰ä¸€ä¸ªéª¤å‡ç‚¹å’Œä¸€ä¸ªéª¤é™ç‚¹ï¼Œå› æ­¤ï¼Œç½‘é¡µæ­£æ–‡æŠ½å–é—®é¢˜è½¬åŒ–ä¸ºäº†æ±‚è¡Œå—åˆ†å¸ƒå‡½æ•°ä¸Šçš„éª¤å‡ç‚¹å’Œéª¤é™ç‚¹ä¸¤ä¸ªè¾¹èŠ‚ç‚¹ã€‚ è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†è¿™ä¸ªç®—æ³•çš„Pythonå®žçŽ°GitHub - chrislinan/cx-extractor-pythonï¼š 1234from CxExtractor import CxExtractorcx = CxExtractor(threshold=40)text = cx.getText(text)texts = text.split('\n') ä¸»é¢˜æ¨¡åž‹æ‹¿åˆ°ç½‘é¡µæ­£æ–‡å†…å®¹æ–‡æœ¬åŽï¼Œå°±éœ€è¦æå–æ­£æ–‡ä¸»é¢˜å…³é”®è¯äº†ã€‚å¸¸è§åšæ³•æœ‰3ç§ï¼š TFIDF Text-Rank LSI/LDA è¿™é‡Œæˆ‘ä»¬å…ˆé‡‡ç”¨TFIDFçš„æ–¹å¼æ¥åšã€‚ TFIDF(Term Frequency Inverse Document Frequency)æ˜¯ä¸€ç§ç”¨äºŽä¿¡æ¯æ£€ç´¢ä¸Žæ•°æ®æŒ–æŽ˜çš„å¸¸ç”¨åŠ æƒæŠ€æœ¯ã€‚ è¯é¢‘ï¼ˆTFï¼‰=æŸä¸ªè¯åœ¨æ–‡æœ¬ä¸­å‡ºçŽ°çš„æ¬¡æ•°/è¯¥æ–‡æœ¬ä¸­æ€»è¯æ•° é€†å‘æ–‡æ¡£é¢‘ï¼ˆIDFï¼‰=log(è¯­æ–™åº“ä¸­æ‰€æœ‰æ–‡æ¡£æ€»æ•°/(åŒ…å«æŸè¯çš„æ–‡æ¡£æ•°+1)) æˆ‘ä»¬é€šè¿‡TFï¼Œä¹Ÿå°±æ˜¯æŸä¸ªè¯åœ¨æ–‡æœ¬ä¸­å‡ºçŽ°çš„é¢‘åº¦ï¼Œæ¥æå‡è¿™ä¸ªè¯åœ¨ä¸»é¢˜ä¸­çš„æƒé‡ï¼Œç„¶åŽæˆ‘ä»¬é€šè¿‡IDFå€¼ï¼Œå³é€†å‘æ–‡æ¡£é¢‘æ¥é™ä½Žå…¬å…±è¯çš„ä¸»é¢˜æƒé‡ã€‚TF*IDFä¹Ÿå°±å¾—åˆ°äº†æˆ‘ä»¬è¦çš„ä¸»é¢˜è¯æƒé‡ã€‚ åšTFIDFï¼Œé¦–å…ˆæ­¥éª¤æ˜¯åˆ†è¯ã€‚åˆ†è¯çš„æ•ˆæžœå–å†³äºŽè¯å…¸çš„æž„å»ºï¼Œä¸”å¯¹åŽç»­å…³é”®è¯æå–å½±å“å·¨å¤§ã€‚é¦–å…ˆè¦åŸºäºŽåˆ†æžçš„è¡Œä¸šä¸»é¢˜å»ºç«‹ä¸“ç”¨è¯å…¸ï¼Œç„¶åŽè¿˜éœ€è¦ç»´æŠ¤åœç”¨è¯çš„è¯å…¸ã€‚æœ‰äº†è¯å…¸åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨Pythonåˆ†è¯çš„ç¥žå™¨jiebaæ¥å¤„ç†åˆ†è¯ã€‚ 12345678import jiebajieba.load_userdict('./dict.txt') #è‡ªå®šä¹‰è¯å…¸stopwords = set([line.strip() for line in open('stopwords.txt', 'r', encoding='utf-8').readlines()]) #åœç”¨è¯å…¸ word_lists = []for text in texts: word_lists += (list(jieba.cut(text, cut_all=False)))word_lists = [w for w in word_lists if not is_stop_word(w)] åˆ†è¯å®Œæ¯•åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—TFIDFäº†ã€‚å¯ä»¥é€šè¿‡gensimï¼Œscikit-learnç­‰æœºå™¨å­¦ä¹ ä¸“ç”¨åŒ…æ¥åšï¼Œjiebaæœ¬èº«ä¹Ÿæä¾›è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æŽ¥ç”¨jiebaã€‚ 12import jieba.analysekeywords = jieba.analyse.extract_tags(' '.join(word_lists), topK=20, withWeight=True, allowPOS=['n', 'ns', 'nr', 'nt', 'nz']) æ³¨æ„è¿™é‡Œæœ‰ä¸ªå‚æ•°æ˜¯allowPOSï¼ŒæŒ‰ç…§è¯æ€§è¿‡æ»¤ã€‚è¿™ä¸ªéœ€è¦æ ¹æ®å®žé™…çš„ä¸šåŠ¡éœ€æ±‚æ¥è®¾ç½®ã€‚ è¯æ€§æ ‡æ³¨(Part-Of-Speech Tagging, POS tagging)ï¼Œæ˜¯è¯­æ–™åº“è¯­è¨€å­¦ä¸­å°†è¯­æ–™åº“å†…å•è¯çš„è¯æ€§æŒ‰ç…§å…¶å«ä¹‰å’Œä¸Šä¸‹æ–‡å†…å®¹è¿›è¡Œæ ‡è®°çš„æ–‡æœ¬æ•°æ®å¤„ç†æŠ€æœ¯ã€‚å¸¸è§æ ‡æ³¨ç¤ºä¾‹ï¼šn åè¯nr äººåns åœ°ånt æœºæž„å›¢ä½“nz å…¶ä»–ä¸“åa å½¢å®¹è¯v åŠ¨è¯ æœåŠ¡åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å…³é”®è¯æå–å°±ç»“æŸäº†ï¼Œä¸ºäº†æ–¹ä¾¿å…¶ä»–åŒå­¦æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Flaskåšä¸€ä¸ªrestful apiï¼Œè¾“å…¥ä¸ºç½‘å€urlï¼Œè¾“å‡ºä¸ºæå–å‡ºçš„å…³é”®è¯å¹¶æŽ’åºã€‚ æ€»ç»“åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å®Œæˆäº†ä»Žä»»æ„ç½‘é¡µurlæå–æ­£æ–‡ä¸»é¢˜å…³é”®è¯çš„åŠŸèƒ½ã€‚åœ¨ä¸»é¢˜æ¨¡åž‹è¿™å—é‡‡ç”¨äº†å¸¸è§çš„TFIDFçš„ç®—æ³•æ¥è§£å†³ï¼Œå¯ä»¥å¿«é€Ÿå‡ºä¸€ä¸ªåŽŸåž‹æä¾›ç»™ä¸šåŠ¡æ–¹ä½¿ç”¨ã€‚åŽç»­æˆ‘ä»¬ä¼šç»§ç»­ä¼˜åŒ–ï¼Œé‡‡ç”¨æ›´å¤šçš„ç®—æ³•æ¥è¿›ä¸€æ­¥æå‡æ•ˆæžœã€‚]]></content>
      <categories>
        <category>NLP</category>
      </categories>
      <tags>
        <tag>Topic Model</tag>
        <tag>TFIDF</tag>
      </tags>
  </entry>
</search>
